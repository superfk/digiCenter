/*
Stimulsoft.Reports.JS ES5
Version: 2020.4.1
Build date: 2020.08.07
License: https://www.stimulsoft.com/en/licensing/reports
*/
var __extends=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),__values=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft;!function(t){var e;!function(e){var r;!function(r){var i=t.Report.Export.StiExportService,n=t.System.IO.StreamWriter,o=t.Base.Localization.StiLocalization,a=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.multipleFiles=!1,e}return __extends(i,t),i.prototype.implements=function(){return[r.IStiCsvExportService]},Object.defineProperty(i.prototype,"defaultExtension",{get:function(){return"csv"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Csv},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"groupCategory",{get:function(){return"Data"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return r.StiExportPosition.Data},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"exportNameInMenu",{get:function(){return o.get("Export","ExportTypeCsvFile")},enumerable:!1,configurable:!0}),i.prototype.exportTo=function(t,e,i){this.exportCsv(t,e,i.stimulsoft.as(r.StiDataExportSettings))},i.prototype.exportToAsync=function(t,e,r,i){var n=this;setTimeout((function(){n.exportTo(e,r,i),t()}))},Object.defineProperty(i.prototype,"getFilter",{get:function(){return o.get("FileFilters","CsvFiles")},enumerable:!1,configurable:!0}),i.prototype.exportCsv=function(t,i,o){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Csv format"),null==o)throw new Error("The 'settings' argument cannot be equal in null.");var a=o.pageRange,s=o.separator,l=o.encoding,m=o.skipColumnHeaders,c=o.dataExportMode;"\\t"==s&&(s="\t");var p=a.getSelectedPages(t.renderedPages);this.currentPassNumber=0,this.maximumPassNumber=3;var g=new r.StiMatrix(p,!1,this,null,c);if(g.scanComponentsPlacement(!1),this.isStopped)return;if(g.prepareDocument(this,c),this.writer=new n(i,l),!m){for(var h=0;h<g.fields.length;h++){var w;-1==(w=g.fields[h].name.stimulsoft.replaceAll('"','""')).indexOf(s)&&-1==w.indexOf('"')&&-1==w.indexOf("\n")||(w='"'+w+'"'),this.writer.write(w),h<g.fields.length-1&&this.writer.write(s)}this.writer.writeLine("")}this.currentPassNumber=2;for(var u=0;u<g.dataArrayLength;u++){if(this.invokeExporting2(u,g.dataArrayLength-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;for(var h=0;h<g.fields.length;h++){var w;null==(w=g.fields[h].dataArray[u])&&(w=""),""!=w&&(-1==w.indexOf(s)&&-1==w.indexOf('"')&&-1==w.indexOf("\n")||(w='"'+(w=w.stimulsoft.replaceAll('"','""'))+'"'),this.writer.write(w)),h<g.fields.length-1&&this.writer.write(s)}this.writer.writeLine("")}this.writer.flush(),null!=g&&(g.clear(),g=null)},i}(i);r.StiCsvExportService=a}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.Base.Localization.StiLocalization,n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.implements=function(){return[r.IStiDataExportService]},Object.defineProperty(n.prototype,"defaultExtension",{get:function(){if(this.exportSettings.stimulsoft.is(r.StiDataExportSettings)){var t=this.exportSettings.dataType;if(t==r.StiDataType.Dbf)return"dbf";if(t==r.StiDataType.Dif)return"dif";if(t==r.StiDataType.Sylk)return"slk";if(t==r.StiDataType.Xml)return"xml";if(t==r.StiDataType.Json)return"json"}return"csv"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exportFormat",{get:function(){if(this.exportSettings.stimulsoft.is(r.StiCsvExportSettings))return e.StiExportFormat.Csv;if(this.exportSettings.stimulsoft.is(r.StiDataExportSettings)){var t=this.exportSettings.dataType;if(t==r.StiDataType.Csv)return e.StiExportFormat.Csv;if(t==r.StiDataType.Dbf)return e.StiExportFormat.Dbf;if(t==r.StiDataType.Dif)return e.StiExportFormat.Dif;if(t==r.StiDataType.Sylk)return e.StiExportFormat.Sylk;if(t==r.StiDataType.Xml)return e.StiExportFormat.Xml;if(t==r.StiDataType.Json)return e.StiExportFormat.Json}return e.StiExportFormat.Data},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"groupCategory",{get:function(){return"Data"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return r.StiExportPosition.Data},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exportNameInMenu",{get:function(){return i.get("Export","ExportTypeDataFile")},enumerable:!1,configurable:!0}),n.prototype.exportTo=function(t,e,r){this.exportData(t,e,r)},n.prototype.exportToAsync=function(t,e,r,i){var n=this;setTimeout((function(){n.exportTo(e,r,i),t()}))},Object.defineProperty(n.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.getFilter=function(){return i.get("FileFilters","CsvFiles")},n.prototype.exportData=function(t,e,i){this.exportSettings=i;var n=null!=i?i.dataType:r.StiDataType.Csv,o;(new r.StiCsvExportService).exportCsv(t,e,i)},n}(r.StiExportService);r.StiDataExportService=n}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.System.StiString,n=t.System.Drawing.ColorTranslator,o=t.System.Drawing.Color,a=t.Base.Localization.StiLocalization,s=function(s){function l(){var t=s.call(this)||this;return t.renderAsDocument=!0,t.fileName="",t.htmlWriter=null,t.imageQuality=.75,t.imageResolution=96,t.compressToArchive=!1,t}return __extends(l,s),l.prototype.implements=function(){return[r.IStiHtml5ExportService]},Object.defineProperty(l.prototype,"defaultExtension",{get:function(){if(this.compressToArchive)return"zip";return"html"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Html5},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"groupCategory",{get:function(){return"Web"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"position",{get:function(){return r.StiExportPosition.Html5},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"exportNameInMenu",{get:function(){return a.get("Export","ExportTypeHtml5File")},enumerable:!1,configurable:!0}),l.prototype.exportTo=function(t,e,r){this.exportHtml(t,e,r)},l.prototype.exportToAsync=function(t,e,r,i){var n=this;setTimeout((function(){n.exportTo(e,r,i),t()}))},Object.defineProperty(l.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),l.prototype.getFilter=function(){if(this.compressToArchive)return a.get("FileFilters","ZipArchives");return a.get("FileFilters","HtmlFiles")},l.prototype.renderPage=function(t,e,i){var n=r.StiSvgHelper.saveToString(t,e,!1,!1,i,this.imageFormat,this.imageQuality,this.imageResolution);this.htmlWriter.write(n),this.htmlWriter.flush()},l.prototype.renderStartDoc=function(t,e){this.htmlWriter.write("<!DOCTYPE html>"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("title"),this.htmlWriter.write(this.report.reportAlias),this.htmlWriter.writeEndTag("title"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("meta"),this.htmlWriter.writeAttribute("charset",e.webName),this.htmlWriter.writeEndTag("meta"),this.htmlWriter.writeLine(),this.htmlWriter.indent--,this.htmlWriter.writeEndTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("body"),this.htmlWriter.writeAttribute("bgcolor",n.toHtml(o.lightBlue)),this.htmlWriter.writeAttribute("style","text-align:center;"),this.htmlWriter.write(">"),this.htmlWriter.indent++,this.htmlWriter.writeLine()},l.prototype.renderEndDoc=function(){this.htmlWriter.indent--,this.htmlWriter.writeEndTag("body"),this.htmlWriter.indent--,this.htmlWriter.writeLine(),this.htmlWriter.writeEndTag("html")},l.prototype.exportHtml=function(r,n,o){var a,s;if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Html format"),null==o)throw new Error("The 'settings' argument cannot be equal in null.");var l=o.pageRange;this.imageFormat=o.imageFormat,this.imageResolution=o.imageResolution,this.imageQuality=o.imageQuality,this.compressToArchive=o.compressToArchive;var m=o.continuousPages;this.htmlWriter=n;var c=o.pageRange.getSelectedPages(r.renderedPages);try{if(this.report=r,1==this.renderAsDocument&&this.renderStartDoc(c,o.encoding),!(t.Base.izjrG.dVOOk.TvUDM()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW())&&t.System.NodeJs.isStandaloneVersion)){var p=i.format("{3}{0}{2}{4}{1}",String.fromCharCode(114),String.fromCharCode(108),String.fromCharCode(105),String.fromCharCode(84),String.fromCharCode(97));n.write('<div style="FONT-SIZE: 10px; COLOR: red; FONT-FAMILY: Arial"'+">"+"Stimulsoft Reports - "+p+" Version</div>")}this.htmlWriter.indent=0;var g=1;try{for(var h=__values(c.list),w=h.next();!w.done;w=h.next()){var u=w.value;this.invokeExporting(u,c,0,1);var d={ref:g};this.renderPage(r,u,d),g=d.ref,m&&this.htmlWriter.write("<br/>"),this.htmlWriter.writeLine()}}catch(t){a={error:t}}finally{try{w&&!w.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}1==this.renderAsDocument&&this.renderEndDoc(),this.htmlWriter.flush()}finally{r=null}},l}(r.StiExportService);r.StiHtml5ExportService=s}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.System.StiArray,n=t.System.StiString,o=t.Report.Dashboard.StiDashboardExport,a=t.Report.Dashboard.IStiDashboard,s=t.System.Collections.Hashtable,l=t.System.Drawing.Color,m=t.System.Char,c=t.Report.Components.StiPagesCollection,p=t.System.Drawing.Size,g=t.Base.Drawing.StiTextHorAlignment,h=t.Base.Drawing.StiPenStyle,w=t.Base.Drawing.StiVertAlignment,u=t.Report.Components.StiText,d=t.Base.Drawing.StiBrush,S=t.System.Text.StringBuilder,f=t.Report.Components.IStiExportImageExtended,v=t.System.Text.Encoding,E=t.Base.Drawing.StiTextRenderer,b=t.Report.Components.StiRichText,y=t.System.IO.MemoryStream,x=t.System.Xml.XmlTextWriter,A=t.System.DateTime,T=t.Report.Components.StiCheckBox,P=t.Base.Zip.StiZipWriter20,L=t.System.Globalization.CultureInfo,C=t.Report.Components.StiPageOrientation,F=t.Base.Drawing.StiHtmlState,B=t.Base.Drawing.StiHtmlTagsState,k=function(k){function W(){var t=null!==k&&k.apply(this,arguments)||this;return t.matrix=null,t.fontList=null,t.fillList=null,t.borderList=null,t.xfList=null,t.sstList=null,t.sstHash=null,t.sstHashIsTags=null,t.imageList=null,t.formatList=null,t.sstCount=0,t.sheetNameList=null,t.imageListOffset=0,t.printAreasList=null,t.matrixList=null,t.firstPageIndexList=null,t.hyperlinkList=null,t.minRowList=null,t.maxRowList=null,t.useOnePageHeaderAndFooter=!1,t.exportDataOnly=!1,t.exportObjectFormatting=!0,t.exportEachPageToSheet=!1,t.exportHorizontalPageBreaks=!1,t.imageResolution=1,t.imageQuality=.75,t.imageCache=null,t.restrictEditing=r.StiExcel2007RestrictEditing.No,t.reportCulture=null,t.docCompanyString=null,t.docLastModifiedString=null,t.xmlIndentation=1,t.wrongUrlSymbols=" \"#'*,;<>[^`{|}",t.refChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t.HiToTwips=14.4/20*1.01,t.TwipsToColinfo=2.438*.976*.075,t}return __extends(W,k),W.prototype.implements=function(){return[r.IStiExcel2007ExportService]},W.prototype.getDefaultExtension=function(){return"xlsx"},W.prototype.exportTo=function(t,e,r){this.exportExcel(t,e,r)},W.prototype.exportToAsync=function(e,r,i,n){var s=this;t.Report.Export.StiExportImageHelper.convertAllImages(r,t.System.Drawing.Imaging.ImageFormat.Jpeg).try((function(){if(!r.isDocument&&r.getCurrentPage().stimulsoft.is(a))return void o.exportAsync(r,i,n).try((function(){return e()}));s.exportTo(r,i,n),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null),e()}))},W.prototype.getLineStyle=function(t){var e=h.None,r=0,i=1.5,n=3;switch(null!=t&&(e=t.style,r=t.size),e){case h.Solid:if(r>n)return"thick";if(r>i)return"medium";return"thin";case h.Dot:if(r>i)return"dotted";return"hair";case h.Dash:if(r>i)return"mediumDashed";return"dashed";case h.DashDot:if(r>i)return"mediumDashDot";return"dashDot";case h.DashDotDot:if(r>i)return"mediumDashDotDot";return"dashDotDot";case h.Double:return"double";default:return null}},W.prototype.getRefString=function(t,e){var r=Math.trunc(t/26),i=Math.trunc(t%26),n=new S;return r>0&&n.append(this.refChars.charAt(r-1)),n.append(this.refChars.charAt(i)),n.append((e+1).toString()),n.toString()},W.prototype.getRefAbsoluteString=function(t,e){var r=Math.trunc(t/26),i=Math.trunc(t%26),n=new S;return n.append("$"),r>0&&n.append(this.refChars.charAt(r-1)),n.append(this.refChars.charAt(i)),n.append("$"),n.append((e+1).toString()),n.toString()},W.prototype.floatToString=function(t){var e;return t.toString().stimulsoft.replaceAll(",",".")},W.prototype.stringToUrl=function(t){for(var e=new S,r=0;r<t.length;r++){var i=t.charAt(r);if("'"==i)continue;i.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(i)?e.append(n.format("%{0:x2}",i.charCodeAt(0))):e.append(i)}return e.toString()},W.prototype.getFontNumber=function(t){if(this.fontList.length>0)for(var e=0;e<this.fontList.length;e++)if(this.fontList[e].stimulsoft.equals(t))return e;var r;return this.fontList.push(t),this.fontList.length-1},W.prototype.getFillNumber=function(t){if(this.fillList.length>0)for(var e=0;e<this.fillList.length;e++)if(this.fillList[e].stimulsoft.equals(t))return e;var r;return this.fillList.push(t),this.fillList.length-1},W.prototype.getBorderNumber=function(t){if(this.borderList.length>0)for(var e=0;e<this.borderList.length;e++)if(this.borderList[e].stimulsoft.equals(t))return e;var r;return this.borderList.push(t),this.borderList.length-1},W.prototype.getXFNumber=function(t){if(this.xfList.length>0)for(var e=0;e<this.xfList.length;e++)if(this.xfList[e].equalDataXF(t))return e;var r;return this.xfList.push(t),this.xfList.length-1},W.prototype.getSSTNumber=function(t){if(this.sstCount++,this.sstList.length>0&&this.sstHash.containsKey(t))return this.sstHash.get(t);this.sstList.push(t);var e=this.sstList.length-1;return this.sstHash.add(t,e),e},W.prototype.getFormatNumber=function(t){if(this.formatList.length>0)for(var e=0;e<this.formatList.length;e++)if(this.formatList[e]==t)return e+164;var r;return this.formatList.push(t),this.formatList.length-1+164},W.prototype.convert=function(t){return t*this.HiToTwips},W.prototype.compareExcellSheetNames=function(t,e){var r=t;null!=r&&0!=r.length||(r="");var i=e;return null!=i&&0!=i.length||(i=""),r==i},W.prototype.prepareData=function(){this.fontList=new Array,this.fillList=new Array,this.borderList=new Array,this.xfList=new Array,this.sstList=[],this.sstHash=new s,this.sstHashIsTags=new s,this.imageList=[],this.formatList=[],this.sheetNameList=[],this.sstCount=0,this.printAreasList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.imageCache=new e.StiImageCache(t["StiOptions"].Export.Excel.AllowImageComparer,!0,e.ImageFormat.Jpeg,this.imageQuality,!1);var r=new R("Arial",!1,!1,!1,!1,10,l.black,1,0);this.getFontNumber(r);var i=new I("none",l.transparent,l.black);this.getFillNumber(i),i=new I("gray125",l.transparent,l.black),this.getFillNumber(i);var n=new D(null,null,null,null);this.getBorderNumber(n);var o=new N(0,0,0,0,0,g.Left,w.Bottom,0,!1,!1,!1);this.getXFNumber(o)},W.prototype.writeContentTypes=function(){var t=new y,e=new x(v.UTF8,t);e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","vml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.vmlDrawing"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/workbook.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),e.writeEndElement();for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("Override"),e.writeAttributeString("PartName",n.format("/xl/worksheets/sheet{0}.xml",r+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),e.writeEndElement();for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("Override"),e.writeAttributeString("PartName",n.format("/xl/drawings/drawing{0}.xml",r+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"),e.writeEndElement();return this.sstList.length>0&&(e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/sharedStrings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeMainRels=function(){var t=new y,e=new x(v.UTF8,t);return e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","xl/workbook.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeDocPropsApp=function(){var t=new y,e=new x(v.UTF8,t);e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Excel"),e.writeElementString("DocSecurity","0"),e.writeElementString("ScaleCrop","false"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("LinksUpToDate","false"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeStartElement("HeadingPairs"),e.writeStartElement("vt:vector"),e.writeAttributeString("size","4"),e.writeAttributeString("baseType","variant"),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Worksheets"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",n.format("{0}",this.sheetNameList.length)),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Named Ranges"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",n.format("{0}",this.sheetNameList.length)),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("TitlesOfParts"),e.writeStartElement("vt:vector"),e.writeAttributeString("size",n.format("{0}",2*this.sheetNameList.length)),e.writeAttributeString("baseType","lpstr");for(var r=0;r<this.sheetNameList.length;r++)e.writeElementString("vt:lpstr",this.sheetNameList[r]);for(var r=0;r<this.sheetNameList.length;r++)e.writeElementString("vt:lpstr",n.format("'{0}'!Print_Area",this.sheetNameList[r]));return e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeDocPropsCore=function(){var e=new y,r=new x(v.UTF8,e);r.writeStartDocument(),r.writeStartElement("cp:coreProperties"),r.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),r.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),r.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var i=n.format("{0}{1}",A.now.toString("yyyy-MM-dd"),A.now.toString("THH:mm:ssZ"));return r.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),r.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),r.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),r.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),r.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),r.writeStartElement("dcterms:created"),r.writeAttributeString("xsi:type","dcterms:W3CDTF"),r.writeString(i),r.writeEndElement(),r.writeStartElement("dcterms:modified"),r.writeAttributeString("xsi:type","dcterms:W3CDTF"),r.writeString(i),r.writeEndElement(),r.writeElementString("cp:contentStatus",t.StiVersion.platform()),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},W.prototype.writeWorkbookRels=function(){var t=new y,e=new x(v.UTF8,t);e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",r+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),e.writeAttributeString("Target",n.format("worksheets/sheet{0}.xml",r+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",this.sheetNameList.length+2)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),this.sstCount>0&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",this.sheetNameList.length+3)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"),e.writeAttributeString("Target","sharedStrings.xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeWorkbook=function(){var t=new y,e=new x(v.UTF8,t);e.writeStartDocument(),e.writeStartElement("workbook"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeStartElement("fileVersion"),e.writeAttributeString("appName","xl"),e.writeAttributeString("lastEdited","4"),e.writeAttributeString("lowestEdited","4"),e.writeAttributeString("rupBuild","4505"),e.writeEndElement(),e.writeStartElement("workbookPr"),e.writeAttributeString("defaultThemeVersion","124226"),e.writeEndElement(),e.writeStartElement("bookViews"),e.writeStartElement("workbookView"),e.writeAttributeString("xWindow","120"),e.writeAttributeString("yWindow","15"),e.writeAttributeString("windowWidth","18975"),e.writeAttributeString("windowHeight","11955"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("sheets");for(var r=0;r<this.sheetNameList.length;r++)e.writeStartElement("sheet"),e.writeAttributeString("name",this.sheetNameList[r]),e.writeAttributeString("sheetId",n.format("{0}",r+1)),e.writeAttributeString("r:id",n.format("rId{0}",r+1)),e.writeEndElement();e.writeEndElement(),e.writeStartElement("definedNames");for(var r=0;r<this.sheetNameList.length;r++){var i=this.printAreasList[r];i.height>1048575&&(i.height=1048575),i.width>16383&&(i.width=16383);var o=this.getRefAbsoluteString(i.width,i.height);e.writeStartElement("definedName"),e.writeAttributeString("name","_xlnm.Print_Area"),e.writeAttributeString("localSheetId",n.format("{0}",r)),e.writeString(n.format("'{0}'!$A$1:{1}",this.sheetNameList[r],o)),e.writeEndElement()}return e.writeEndElement(),e.writeStartElement("calcPr"),e.writeAttributeString("calcId","124519"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeSheetRels=function(e){var r=new y,i=new x(v.UTF8,r);if(i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),this.imageList.length-this.imageListOffset>0&&(i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),i.writeAttributeString("Target",n.format("../drawings/drawing{0}.xml",e+1)),i.writeEndElement()),this.hyperlinkList.length>0)for(var o=0;o<this.hyperlinkList.length;o++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",2+o)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",this.hyperlinkList[o]),i.writeAttributeString("TargetMode","External"),i.writeEndElement();return t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(i.writeStartElement("Relationship"),i.writeAttributeString("Id","dId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing"),i.writeAttributeString("Target","../drawings/vmlDrawingAdditional.vml"),i.writeEndElement()),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},W.prototype.writeSheet=function(o,a){var s=new y,c=new x(v.UTF8,s);c.writeStartDocument(),c.writeStartElement("worksheet"),c.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),c.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),t["StiOptions"].Export.Excel.FitToOnePageWide&&(c.writeStartElement("sheetPr"),c.writeStartElement("pageSetUpPr"),c.writeAttributeString("fitToPage","1"),c.writeEndElement(),c.writeEndElement()),this.matrix=this.matrixList[o];var g=this.minRowList[o],h=this.maxRowList[o],w=new p(this.matrix.coordX.countItems-2,h-g-1);w.width<0&&(w.width=0),w.height<0&&(w.height=0),this.printAreasList.push(w);var d=[];c.writeStartElement("dimension"),c.writeAttributeString("ref",n.format("{0}:{1}",this.getRefString(0,0),this.getRefString(w.width,w.height))),c.writeEndElement();var E=0,A=0;if(t["StiOptions"].Export.Excel.AllowFreezePanes)for(var P=g;P<h;P++)for(var L=0;L<this.matrix.coordX.countItems-1;L++){var F;if(null!=(F=this.matrix.cells[P][L])&&null!=F.component&&(F.component.locked||null!=F.component.tagValue&&F.component.tagValue.toString().contains("excelfreezepanes"))){var B=F.component.componentPlacement;if(null!=B&&B.length>0&&(B.stimulsoft.startsWith("rt")||B.stimulsoft.startsWith("ph")||B.stimulsoft.startsWith("h"))){E=F.left,A=F.top+F.height+1;break}}}c.writeStartElement("sheetViews"),c.writeStartElement("sheetView"),t["StiOptions"].Export.Excel.ColumnsRightToLeft&&c.writeAttributeString("rightToLeft","1"),t["StiOptions"].Export.Excel.ShowGridLines||c.writeAttributeString("showGridLines","0"),c.writeAttributeString("tabSelected","1"),c.writeAttributeString("workbookViewId","0"),0==E&&0==A?(c.writeStartElement("selection"),c.writeAttributeString("activeCell","A1"),c.writeAttributeString("sqref","A1"),c.writeEndElement()):0==E?(c.writeStartElement("pane"),c.writeAttributeString("ySplit",A.toString()),c.writeAttributeString("topLeftCell",this.getRefString(E,A)),c.writeAttributeString("activePane","bottomLeft"),c.writeAttributeString("state","frozen"),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","bottomLeft"),c.writeAttributeString("activeCell",this.getRefString(0,A)),c.writeAttributeString("sqref",this.getRefString(0,A)),c.writeEndElement()):(c.writeStartElement("pane"),c.writeAttributeString("xSplit",E.toString()),c.writeAttributeString("ySplit",A.toString()),c.writeAttributeString("topLeftCell",this.getRefString(E,A)),c.writeAttributeString("activePane","bottomRight"),c.writeAttributeString("state","frozen"),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","topRight"),c.writeAttributeString("activeCell",this.getRefString(E,0)),c.writeAttributeString("sqref",this.getRefString(E,0)),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","bottomLeft"),c.writeAttributeString("activeCell",this.getRefString(0,A)),c.writeAttributeString("sqref",this.getRefString(0,A)),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","bottomRight"),c.writeAttributeString("activeCell",this.getRefString(E,A)),c.writeAttributeString("sqref",this.getRefString(E,A)),c.writeEndElement()),c.writeEndElement(),c.writeEndElement(),c.writeStartElement("sheetFormatPr"),c.writeAttributeString("defaultRowHeight",n.format("{0}",15)),c.writeEndElement();var k=this.matrix.coordX.getKeys(),W=this.matrix.coordY.getKeys();if(this.exportObjectFormatting){c.writeStartElement("cols");for(var U=0;U<this.matrix.coordX.countItems-1;U++){var X=this.matrix.coordX.getByIndex(U+1,k),z=this.matrix.coordX.getByIndex(U,k),V=this.convert(X-z)*this.TwipsToColinfo;c.writeStartElement("col"),c.writeAttributeString("min",n.format("{0}",U+1)),c.writeAttributeString("max",n.format("{0}",U+1)),c.writeAttributeString("width",n.format("{0}",V)),c.writeAttributeString("customWidth","1"),c.writeEndElement()}c.writeEndElement()}var G=null,Y=i.create2(Boolean,h+1,this.matrix.coordX.countItems),j=i.create2(Number,h+1,this.matrix.coordX.countItems),_=[],q=[];c.writeStartElement("sheetData");for(var P=g;P<h;P++){var K=this.matrix.coordY.getByIndex(P+1,W)-this.matrix.coordY.getByIndex(P,W);c.writeStartElement("row"),c.writeAttributeString("r",n.format("{0}",P+1-g)),c.writeAttributeString("spans",n.format("{0}:{1}",1,this.matrix.coordX.countItems-1)),this.exportObjectFormatting&&(c.writeAttributeString("ht",n.format("{0}",this.convert(K))),c.writeAttributeString("customHeight","1"));for(var L=0;L<this.matrix.coordX.countItems-1;L++){var F=this.matrix.cells[P][L];if(Y[P]&&0==Y[P][L]&&null!=F){Y[P][L]=!0;var Q=F.component.stimulsoft.as(b),J=F.component.stimulsoft.as(u),Z=F.text,$=F.component.stimulsoft.as(T),tt=!1;null!=$&&null!=$.excelDataValue&&$.excelDataValue.length>0&&(tt=!0,Z=$.excelDataValue);var et=null;if(null!=F.component.hyperlinkValue&&(et=F.component.hyperlinkValue.toString().trim()).length>0&&!et.stimulsoft.startsWith("javascript:")){var rt=Z;null!=rt&&0!=rt.length||(rt=et);var it=new H(P-g,P-g+F.height,L,L+F.width),nt=new M(it,rt,et);q.push(nt)}var ot=!1,at=F.component.stimulsoft.as(f);if(null!=at){var st=this.imageResolution,lt=null;if(F.component.isExportAsImage(e.StiExportFormat.Excel2007)){var mt={ref:this.imageResolution};lt=at.getImage(mt,e.StiExportFormat.Excel)}if(null!=lt){var ct=this.matrix.getRealImageData(F,lt);null!=ct&&(lt=ct);var pt=this.imageCache.addImageIntRaw(lt,lt.imageFormat),gt=new O(P-g,0,L,0,P-g+1+F.height,0,L+1+F.width,0,pt,et);this.imageList.push(gt),ot=!0}}var ht=!1,wt;if(null!=F.component&&null!=F.component.tagValue)-1!=F.component.tagValue.toString().toLowerCase().indexOf("exceltext")&&(ht=!0,d.push(this.getRefString(L,P)));var ut="";null!=J&&(ut=J.format);var dt=!1,St=!1,ft=!1,vt=!1,Et=!1,bt=!1,yt=!1,xt="",At=2,Tt=0,Pt=this.reportCulture.numberFormat.currencySymbol,Lt=0==this.reportCulture.numberFormat.currencyPositivePattern||2==this.reportCulture.numberFormat.currencyPositivePattern,Ct=!1,Ft=null!=J&&J.hideZeros,Bt=null,kt=null,Rt=ut.indexOf("|");if(-1!=Rt&&(Bt=r.StiExportUtils.getPositivePattern(ut.charCodeAt(Rt+1)-65),kt=r.StiExportUtils.getNegativePattern(ut.charCodeAt(Rt+2)-65),ut=ut.substr(0,Rt)),null!=ut&&ut.length>0)if("C"==ut[0]?dt=!0:"N"==ut[0]?St=!0:"P"==ut[0]?ft=!0:"D"==ut[0]?vt=!0:"T"==ut[0]?Et=!0:"U"==ut[0]&&(bt=!0),1==ut.length)yt=!0;else if(dt||St||ft){var It=1;if(m.isDigit(ut[It])){var Dt=new S;while(It<ut.length&&m.isDigit(ut[It]))Dt.append(ut[It]),It++;At=parseInt(Dt.toString())}It<ut.length&&"G"==ut[It]&&(It++,Tt=3),It<ut.length&&"("==ut[It]&&(It++,Ct=!0),It<ut.length&&("."==ut[It]||","==ut[It])&&It++,It<ut.length&&("+"==ut[It]||"-"==ut[It])&&("+"==ut[It]&&(Lt=!0),Pt=++It<ut.length?ut.substring(It):"")}if(dt||St||ft||(yt=!0),dt&&yt&&(yt=!1),Ft&&!n.isNullOrEmpty(ut)&&(yt=!1),ht&&(yt=!0),!yt)if(-1!=Rt){var Nt=new S;Tt>1&&(Nt.append("#,"),Nt.appendCount("#",Tt-1)),Nt.append("0"),At>0&&(Nt.append("."),Nt.appendCount("0",At));var Ot=Nt.toString(),Ht,Mt;xt=Bt.stimulsoft.replaceAll("n",Ot).stimulsoft.replaceAll("$",'"'+Pt+'"')+";"+(Mt=kt.stimulsoft.replaceAll("n",Ot).stimulsoft.replaceAll("$",'"'+Pt+'"'))+(Ft?";":"")}else{var Nt=new S;dt&&1==Lt&&(Nt.append('"'),Nt.append(Pt),Nt.append('"')),Tt>1&&(Nt.append("#,"),Nt.appendCount("#",Tt-1)),Nt.append("0"),At>0&&(Nt.append("."),Nt.appendCount("0",At)),dt&&0==Lt&&(Nt.append('"'),Nt.append(Pt),Nt.append('"')),ft&&Nt.append("%");var Mt=(Ct?"(":"-")+(xt=Nt.toString())+(Ct?")":"");Ft?xt=xt+";"+Mt+";":Ct&&(xt=xt+";"+Mt)}var Wt=0;yt?(St&&(Wt=4),ft&&(Wt=10),vt&&(Wt=14),Et&&(Wt=21),ht&&(Wt=49)):Wt=this.getFormatNumber(xt);var Ut=0;if(this.exportObjectFormatting){var Xt=F.cellStyle,zt=new R(Xt.font.name,Xt.font.bold,Xt.font.italic,Xt.font.underline,Xt.font.strikeout,Math.round(Xt.font.sizeInPoints),Xt.textColor,1,0);tt&&(zt=new R(t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.strikeout,Math.round(t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints),Xt.textColor,1,0));var Vt=new I("solid",Xt.color,Xt.color);ot&&(Vt=new I("solid",l.transparent,l.transparent));for(var Gt=!0,Yt=!0,jt=0;jt<F.height+1;jt++)null==this.matrix.bordersY[F.top+jt][F.left]&&(Gt=!1),null==this.matrix.bordersY[F.top+jt][F.left+F.width+1]&&(Yt=!1);for(var _t=!0,qt=!0,jt=0;jt<F.width+1;jt++)null==this.matrix.bordersX[F.top][F.left+jt]&&(_t=!1),null==this.matrix.bordersX[F.top+F.height+1][F.left+jt]&&(qt=!1);var Kt=new D(Gt?this.matrix.bordersY[F.top][F.left]:null,Yt?this.matrix.bordersY[F.top][F.left+F.width+1]:null,_t?this.matrix.bordersX[F.top][F.left]:null,qt?this.matrix.bordersX[F.top+F.height+1][F.left]:null),Qt=!1;null!=Xt.textOptions&&(Qt=Xt.textOptions.rightToLeft);var Jt=!1;null!=Xt.textOptions&&(Jt=Xt.textOptions.wordWrap),n.isNullOrEmpty(Z)||(-1==Z.indexOf("\r")&&-1==Z.indexOf("\n")||(Jt=!0),null==J||!J.checkAllowHtmlTags()||-1==Z.indexOf("<br")&&-1==Z.indexOf("<ul")&&-1==Z.indexOf("<ol")&&-1==Z.indexOf("<p")||(Jt=!0));var Zt=0;if(null!=Xt.textOptions){var $t=Math.ceil(Xt.textOptions.angle);$t>=0&&$t<=90&&(Zt=$t),$t>=270&&$t<360&&(Zt=360-$t+90)}var te=this.restrictEditing==r.StiExcel2007RestrictEditing.ExceptEditableFields&&null!=F.component&&F.component.stimulsoft.is(u)&&F.component.stimulsoft.as(u).Editable,ee=new N(Wt,this.getFontNumber(zt),this.getFillNumber(Vt),this.getBorderNumber(Kt),0,tt?t["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment:Xt.horAlignment,tt?t["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment:Xt.vertAlignment,Zt,Jt,Qt,te);Ut=this.getXFNumber(ee)}if(c.writeStartElement("c"),c.writeAttributeString("r",this.getRefString(L,P-g)),c.writeAttributeString("s",Ut.toString()),this.exportObjectFormatting){for(var re=0;re<=F.width;re++)for(var ie=0;ie<=F.height;ie++)Y[P+ie][L+re]=!0,j[P+ie][L+re]=Ut;if(F.width>0||F.height>0){var ne=new H(P-g,P-g+F.height,L,L+F.width);_.push(ne)}}else Y[P][L]=!0,j[P][L]=Ut;if(!F.component.isExportAsImage(e.StiExportFormat.Excel2007)&&(null!=Z&&Z.length>0||null!=J&&null!=J.excelDataValue)){var oe=!1,ae=!1,se=0;if(null!=J&&null!=J.excelDataValue&&"-"!=J.excelDataValue){var le=J.excelDataValue,me=le.trim().stimulsoft.replaceAll(",",".");if(null!=me&&me.length>0&&this.checkForNumber(me)){ae=!0;try{vt||Et?ae=!1:(se=parseFloat(me),isNaN(se)&&(ae=!1,se=0))}catch(e){t.System.StiError.showError(e,!1),ae=!1}}bt&&(ae=!1),le!=Z&&le.stimulsoft.startsWith("=")&&(oe=!0),ae||null!=Z||(Z=le)}if(oe){var ce=J.excelDataValue.stimulsoft.replaceAll("\r","").stimulsoft.replaceAll("\t"," ").substring(1);t["StiOptions"].Export.Excel.TrimTrailingSpaces&&(ce=r.StiExportUtils.trimEndWhiteSpace(ce)),c.writeElementString("f",ce)}else if(1==ae)c.writeElementString("v",se.toString().stimulsoft.replaceAll(",","."));else{var ce=Z.stimulsoft.replaceAll("\r","").stimulsoft.replaceAll("\t"," ");t["StiOptions"].Export.Excel.TrimTrailingSpaces&&(ce=r.StiExportUtils.trimEndWhiteSpace(ce));var pe=0;null!=J&&J.checkAllowHtmlTags()?(ce=this.convertAllowHtmlTagsToExcelString(J,ce),pe=this.getSSTNumber(ce),this.sstHashIsTags.add(pe,null)):pe=this.getSSTNumber(ce),c.writeAttributeString("t","s"),c.writeElementString("v",pe.toString())}}c.writeEndElement()}else{var Ut=0;Y[P][L]&&(Ut=j[P][L]);var Gt=null!=this.matrix.bordersY[P+0][L+0],Yt=null!=this.matrix.bordersY[P+0][L+1],_t=null!=this.matrix.bordersX[P+0][L+0],qt=void 0;try{qt=null!=this.matrix.bordersX[P+1][L+0]}catch(e){t.System.StiError.showError(e,!1)}if(Gt||Yt||_t||qt||0!=Ut){var Kt=new D(Gt?this.matrix.bordersY[P+0][L+0]:null,Yt?this.matrix.bordersY[P+0][L+1]:null,_t?this.matrix.bordersX[P+0][L+0]:null,qt?this.matrix.bordersX[P+1][L+0]:null),ge=this.xfList[Ut],ee=new N(ge.FormatIndex,ge.FontIndex,ge.FillIndex,this.getBorderNumber(Kt),ge.XFId,ge.HorAlign,ge.VertAlign,ge.TextRotationAngle,ge.TextWrapped,ge.RightToLeft,ge.Editable),he=this.getXFNumber(ee);this.exportObjectFormatting||(he=0),c.writeStartElement("c"),c.writeAttributeString("r",this.getRefString(L,P-g)),c.writeAttributeString("s",he.toString()),c.writeEndElement()}}}c.writeEndElement()}if(c.writeEndElement(),this.restrictEditing!=r.StiExcel2007RestrictEditing.No&&(c.writeStartElement("sheetProtection"),c.writeAttributeString("password","F05F"),c.writeAttributeString("sheet","1"),c.writeAttributeString("objects","1"),c.writeAttributeString("scenarios","1"),c.writeEndElement()),_.length>0&&(!this.exportDataOnly||this.exportObjectFormatting)){c.writeStartElement("mergeCells"),c.writeAttributeString("count",n.format("{0}",_.length));for(var jt=0;jt<_.length;jt++){var ne=_[jt];c.writeStartElement("mergeCell"),c.writeAttributeString("ref",n.format("{0}:{1}",this.getRefString(ne.FirstColumn,ne.FirstRow),this.getRefString(ne.LastColumn,ne.LastRow))),c.writeEndElement()}c.writeEndElement()}if(q.length>0){for(var we=!1,ue=0;ue<q.length;ue++){var nt,et;if((et=(nt=q[ue]).Bookmark).stimulsoft.startsWith("#")){et=et.substring(1);for(var de=!1,Se=0;Se<this.matrixList.length;Se++){var fe,ve;if(null!=(fe=this.matrixList[Se].bookmarksTable))if(null!=(ve=fe.get(et))){var Ee=this.minRowList[Se],be=this.maxRowList[Se],ye;if((ye=ve.stimulsoft.as(p)).height>=Ee&&ye.height<be){we=!0;break}}}}else we=!0;if(we)break}if(we){c.writeStartElement("hyperlinks");for(var ue=0;ue<q.length;ue++){var nt,et;if((et=(nt=q[ue]).Bookmark).stimulsoft.startsWith("#")){et=et.substring(1);for(var de=!1,Se=0;Se<this.matrixList.length;Se++){var fe,ve;if(null!=(fe=this.matrixList[Se].bookmarksTable))if(null!=(ve=fe.get(et))){var Ee=this.minRowList[Se],be=this.maxRowList[Se],ye;if((ye=ve.stimulsoft.as(p)).height>=Ee&&ye.height<be){et=n.format("'{0}'!{1}",this.sheetNameList[Se],this.getRefString(ye.width,ye.height-Ee)),de=!0;break}}}de&&(c.writeStartElement("hyperlink"),c.writeAttributeString("ref",this.getRefString(nt.Range.FirstColumn,nt.Range.FirstRow)),c.writeAttributeString("location",et),c.writeAttributeString("display",nt.Description),c.writeEndElement())}else{var xe=et;et.stimulsoft.startsWith("file:\\\\\\")&&(xe=et.substring(8),et="file:///"+xe),et.stimulsoft.startsWith("http:")&&(et=et.stimulsoft.replaceAll(" ","")),c.writeStartElement("hyperlink"),c.writeAttributeString("ref",this.getRefString(nt.Range.FirstColumn,nt.Range.FirstRow)),c.writeAttributeString("r:id",n.format("rId{0}",2+this.hyperlinkList.length)),c.writeAttributeString("display",xe),c.writeEndElement(),this.hyperlinkList.push(this.stringToUrl(et))}}c.writeEndElement()}}c.writeStartElement("pageMargins"),c.writeAttributeString("left",this.floatToString(a.convertToHInches(a.unit,a.margins.left)/100)),c.writeAttributeString("right",this.floatToString(a.convertToHInches(a.unit,a.margins.right)/100)),c.writeAttributeString("top",this.floatToString(a.convertToHInches(a.unit,a.margins.top)/100)),c.writeAttributeString("bottom",this.floatToString(a.convertToHInches(a.unit,a.margins.bottom)/100)),c.writeAttributeString("header",this.floatToString(0)),c.writeAttributeString("footer",this.floatToString(0)),c.writeEndElement(),c.writeStartElement("pageSetup"),c.writeAttributeString("paperSize",n.format("{0}",a.paperSize)),c.writeAttributeString("orientation",a.orientation==C.Portrait?"portrait":"landscape"),t["StiOptions"].Export.Excel.FitToOnePageWide&&c.writeAttributeString("fitToHeight","0"),c.writeEndElement();var Ae=this.matrix.horizontalPageBreaks.length;if(this.exportHorizontalPageBreaks&&Ae>0){c.writeStartElement("rowBreaks"),c.writeAttributeString("count",Ae.toString()),c.writeAttributeString("manualBreakCount",Ae.toString());for(var Te=0;Te<Ae;Te++)c.writeStartElement("brk"),c.writeAttributeString("id",n.format("{0}",this.matrix.horizontalPageBreaks[Te])),c.writeAttributeString("max",0==Te?"16383":"8"),c.writeAttributeString("man","1"),c.writeEndElement();c.writeEndElement()}if(t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(c.writeStartElement("headerFooter"),c.writeStartElement("oddHeader"),c.writeRaw("&amp;C\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n&amp;G"),c.writeEndElement(),c.writeEndElement()),this.imageList.length>this.imageListOffset&&(c.writeStartElement("drawing"),c.writeAttributeString("r:id",n.format("rId{0}",1)),c.writeEndElement()),t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(c.writeStartElement("legacyDrawingHF"),c.writeAttributeString("r:id","dId1"),c.writeEndElement()),d.length>0){for(var Pe in c.writeStartElement("ignoredErrors"),d)c.writeStartElement("ignoredError"),c.writeAttributeString("sqref",d[Pe]),c.writeAttributeString("numberStoredAsText","1"),c.writeEndElement();c.writeEndElement()}return c.writeFullEndElement(),c.writeEndDocument(),c.flush(),s},W.prototype.checkForNumber=function(t){var e=t.match(W.regexCheckInteger1);if(null!=e)return!0;if(null!=(e=t.match(W.regexCheckFloat1)))return!0;return!1},W.prototype.prepareMatrix=function(e){var i=r.StiDataExportMode.AllBands;if(this.exportDataOnly&&(i=r.StiDataExportMode.Data|r.StiDataExportMode.Headers,t["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode&&(i|=r.StiDataExportMode.Footers)),this.matrix=new r.StiMatrix(e,t["StiOptions"].Export.Excel.DivideBigCells,this,null,i),this.useOnePageHeaderAndFooter){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);var n=0,o;while(this.matrix.linePlacement[n]!=r.StiTableLineInfo.PageHeader&&n<this.matrix.coordY.countItems-1)n++;if(this.matrix.linePlacement[n]==r.StiTableLineInfo.PageHeader){while(this.matrix.linePlacement[n]==r.StiTableLineInfo.PageHeader&&n<this.matrix.coordY.countItems-1)n++;while(n<this.matrix.coordY.countItems-1)this.matrix.linePlacement[n]==r.StiTableLineInfo.PageHeader&&(this.matrix.linePlacement[n]=r.StiTableLineInfo.Trash),n++}n=this.matrix.coordY.countItems-1;while(this.matrix.linePlacement[n]!=r.StiTableLineInfo.PageFooter&&n>0)n--;if(this.matrix.linePlacement[n]==r.StiTableLineInfo.PageFooter){while(this.matrix.linePlacement[n]==r.StiTableLineInfo.PageFooter&&n>0)n--;while(n>0)this.matrix.linePlacement[n]==r.StiTableLineInfo.PageFooter&&(this.matrix.linePlacement[n]=r.StiTableLineInfo.Trash),n--}for(var a=0,l=0;l<this.matrix.coordY.countItems-1;l++)if(this.matrix.linePlacement[l]!=r.StiTableLineInfo.Trash){for(var m=0;m<this.matrix.coordX.countItems-1;m++){var c;if(this.matrix.cells[a][m]=this.matrix.cells[l][m],null!=(c=this.matrix.cells[a][m])&&(c.top=a,null!=c.exportImage))var p=c.component;this.matrix.bordersX[a][m]=this.matrix.bordersX[l][m],this.matrix.bordersY[a][m]=this.matrix.bordersY[l][m],this.matrix.bookmarks[a][m]=this.matrix.bookmarks[l][m]}this.matrix.bordersY[a][this.matrix.coordX.countItems-1]=this.matrix.bordersY[l][this.matrix.coordX.countItems-1];var g=this.matrix.coordY.getKeys(),h=this.matrix.coordY.getByIndex(l+1,g)-this.matrix.coordY.getByIndex(l,g);this.matrix.coordY.setByIndex(a+1,this.matrix.coordY.getByIndex(a,g)+h),a++}for(var m=0;m<this.matrix.coordX.countItems-1;m++)this.matrix.bordersX[a][m]=this.matrix.bordersX[this.matrix.coordY.countItems-1][m];if((o=this.matrix.coordY.countItems-1-a)>0)for(var w=0;w<o;w++)this.matrix.coordY.removeByIndex(a+1)}if(this.exportDataOnly){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);for(var a=0,u=new s,d=null,S=t["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode,l=0;l<this.matrix.coordY.countItems-1;l++){var f=!1;if(this.matrix.linePlacement[l]==r.StiTableLineInfo.HeaderD||this.matrix.linePlacement[l]==r.StiTableLineInfo.HeaderAP){var v=this.matrix.parentBandName[l],E=v.indexOf("");if(-1!=E){var b=v.substring(0,E);b!=d&&(d=b,u.clear())}u.containsKey(v)||(f=!0,u.add(v,v))}if(this.matrix.linePlacement[l]==r.StiTableLineInfo.Data||S&&this.matrix.linePlacement[l]==r.StiTableLineInfo.FooterD||f){for(var m=0;m<this.matrix.coordX.countItems-1;m++){var c;if(this.matrix.cells[a][m]=this.matrix.cells[l][m],null!=(c=this.matrix.cells[a][m])&&(c.top=a,null!=c.exportImage))var p=c.component;0!=a&&null==this.matrix.bordersX[l][m]||(this.matrix.bordersX[a][m]=this.matrix.bordersX[l][m]),this.matrix.bordersX[a+1][m]=this.matrix.bordersX[l+1][m],this.matrix.bordersY[a][m]=this.matrix.bordersY[l][m],this.matrix.bookmarks[a][m]=this.matrix.bookmarks[l][m]}this.matrix.bordersY[a][this.matrix.coordX.countItems-1]=this.matrix.bordersY[l][this.matrix.coordX.countItems-1];var g=this.matrix.coordY.getKeys(),h=this.matrix.coordY.getByIndex(l+1,g)-this.matrix.coordY.getByIndex(l,g);this.matrix.coordY.setByIndex(a+1,this.matrix.coordY.getByIndex(a,g)+h),a++}}var o;if((o=this.matrix.coordY.countItems-1-a)>0)for(var w=0;w<o;w++)this.matrix.coordY.removeByIndex(a+1)}},W.prototype.convertAllowHtmlTagsToExcelString=function(t,e){for(var r=new x(v.UTF8),i=new B(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,d.toColor(t.textBrush),d.toColor(t.brush),!1,!1,0,0,1,t.horAlignment),o=new F(i,0),a=E.parseHtmlToStates(t.text,o),s=0;s<a.length;s++){var l=a[s];r.writeStartElement("r"),r.writeStartElement("rPr"),l.ts.bold&&r.writeElementString("b",null),l.ts.italic&&r.writeElementString("i",null),l.ts.underline&&r.writeElementString("u",null),l.ts.strikeout&&r.writeElementString("strike",null),l.ts.superscript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","superscript"),r.writeEndElement()),l.ts.subsript&&(r.writeStartElement("vertAlign"),r.writeAttributeString("val","subscript"),r.writeEndElement()),r.writeStartElement("sz"),r.writeAttributeString("val",l.ts.fontSize.toString()),r.writeEndElement(),r.writeStartElement("color"),r.writeAttributeString("rgb",n.format("{0:X8}",l.ts.fontColor.toArgb())),r.writeEndElement(),r.writeStartElement("rFont"),r.writeAttributeString("val",l.ts.fontName),r.writeEndElement(),r.writeEndElement(),this.convertTextToExcelString(r,E.prepareStateText(l.text).toString()),r.writeEndElement()}return r.flush(),r.close(),r.textWriter.getStringBuilder().toString()},W.prototype.convertTextToExcelString=function(t,e){t.writeStartElement("t"),e.length>0&&(m.isWhitespace(e,e.length-1)||-1!=e.indexOf("\n"))&&t.writeAttributeString("xml:space","preserve"),t.writeString(e),t.writeFullEndElement()},W.prototype.writeDrawingRels=function(t){var e=new y,r=new x(v.UTF8,e);r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var i=this.imageListOffset;i<this.imageList.length;i++){var o=this.imageList[i];r.writeStartElement("Relationship"),r.writeAttributeString("Id",n.format("rId{0}",i-this.imageListOffset+1)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),r.writeAttributeString("Target",n.format("../media/image{0:D5}.jpeg",o.ImageIndex+1)),r.writeEndElement(),n.isNullOrWhiteSpace(o.Hyperlink)||(r.writeStartElement("Relationship"),r.writeAttributeString("Id",n.format("hId{0}",i-this.imageListOffset+1)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",o.Hyperlink),r.writeAttributeString("TargetMode","External"),r.writeEndElement())}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},W.prototype.writeDrawing=function(t){var e=new y,r=new x(v.UTF8,e);r.writeStartDocument(),r.writeStartElement("xdr:wsDr"),r.writeAttributeString("xmlns:xdr","http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main");for(var i=this.imageListOffset;i<this.imageList.length;i++){var o=this.imageList[i];r.writeStartElement("xdr:twoCellAnchor"),r.writeAttributeString("editAs","oneCell"),r.writeStartElement("xdr:from"),r.writeElementString("xdr:col",n.format("{0}",o.FirstColumnIndex)),r.writeElementString("xdr:colOff",n.format("{0}",o.FirstColumnOffset)),r.writeElementString("xdr:row",n.format("{0}",o.FirstRowIndex)),r.writeElementString("xdr:rowOff",n.format("{0}",o.FirstRowOffset)),r.writeEndElement(),r.writeStartElement("xdr:to"),r.writeElementString("xdr:col",n.format("{0}",o.LastColumnIndex)),r.writeElementString("xdr:colOff",n.format("{0}",o.LastColumnOffset)),r.writeElementString("xdr:row",n.format("{0}",o.LastRowIndex)),r.writeElementString("xdr:rowOff",n.format("{0}",o.LastRowOffset)),r.writeEndElement(),r.writeStartElement("xdr:pic"),r.writeStartElement("xdr:nvPicPr"),r.writeStartElement("xdr:cNvPr"),r.writeAttributeString("id",n.format("{0}",i-this.imageListOffset+2)),r.writeAttributeString("name",n.format("Picture {0}",i-this.imageListOffset+1)),r.writeAttributeString("descr",n.format("image{0:D5}",i+1)),n.isNullOrWhiteSpace(o.Hyperlink)||(r.writeStartElement("a:hlinkClick"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("r:id",n.format("hId{0}",i-this.imageListOffset+1)),r.writeEndElement()),r.writeEndElement(),r.writeStartElement("xdr:cNvPicPr"),r.writeStartElement("a:picLocks"),r.writeAttributeString("noChangeAspect","1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:blipFill"),r.writeStartElement("a:blip"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("r:embed",n.format("rId{0}",i-this.imageListOffset+1)),r.writeEndElement(),r.writeStartElement("a:stretch"),r.writeStartElement("a:fillRect"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:spPr"),r.writeStartElement("a:xfrm"),r.writeStartElement("a:off"),r.writeAttributeString("x","1"),r.writeAttributeString("y","1"),r.writeEndElement(),r.writeStartElement("a:ext"),r.writeAttributeString("cx","2"),r.writeAttributeString("cy","2"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:prstGeom"),r.writeAttributeString("prst","rect"),r.writeStartElement("a:avLst"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("xdr:clientData"),r.writeEndElement(),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},W.prototype.writeStyles=function(){var t=new y,e=new x(v.UTF8,t);if(e.writeStartDocument(),e.writeStartElement("styleSheet"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),this.formatList.length>0){e.writeStartElement("numFmts"),e.writeAttributeString("count",n.format("{0}",this.formatList.length));for(var r=0;r<this.formatList.length;r++)e.writeStartElement("numFmt"),e.writeAttributeString("numFmtId",n.format("{0}",164+r)),e.writeAttributeString("formatCode",this.formatList[r]),e.writeEndElement();e.writeEndElement()}e.writeStartElement("fonts"),e.writeAttributeString("count",n.format("{0}",this.fontList.length));for(var r=0;r<this.fontList.length;r++){var i=this.fontList[r];e.writeStartElement("font"),i.Bold&&e.writeElementString("b",""),i.Italic&&e.writeElementString("i",""),i.Underlined&&e.writeElementString("u",""),i.Strikeout&&e.writeElementString("strike",""),e.writeStartElement("sz"),e.writeAttributeString("val",n.format("{0}",i.Height)),e.writeEndElement(),e.writeStartElement("color"),e.writeAttributeString("rgb",n.format("{0:X8}",i.Color.toArgb())),e.writeEndElement(),e.writeStartElement("name"),e.writeAttributeString("val",i.Name),e.writeEndElement(),e.writeStartElement("charset"),e.writeAttributeString("val",n.format("{0}",i.Charset)),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("fills"),e.writeAttributeString("count",n.format("{0}",this.fillList.length));for(var r=0;r<this.fillList.length;r++){var o=this.fillList[r];e.writeStartElement("fill"),e.writeStartElement("patternFill"),e.writeAttributeString("patternType",o.Type),"solid"==o.Type&&(e.writeStartElement("fgColor"),e.writeAttributeString("rgb",n.format("{0:X8}",o.FgColor.toArgb())),e.writeEndElement(),e.writeStartElement("bgColor"),e.writeAttributeString("indexed",n.format("{0}",64)),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("borders"),e.writeAttributeString("count",n.format("{0}",this.borderList.length));for(var r=0;r<this.borderList.length;r++){var a=this.borderList[r];e.writeStartElement("border"),this.writeBorderData(e,"left",a.BorderLeft),this.writeBorderData(e,"right",a.BorderRight),this.writeBorderData(e,"top",a.BorderTop),this.writeBorderData(e,"bottom",a.BorderBottom),this.writeBorderData(e,"diagonal",null),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("cellStyleXfs"),e.writeAttributeString("count",n.format("{0}",1)),e.writeStartElement("xf"),e.writeAttributeString("numFmtId",n.format("{0}",0)),e.writeAttributeString("fontId",n.format("{0}",0)),e.writeAttributeString("fillId",n.format("{0}",0)),e.writeAttributeString("borderId",n.format("{0}",0)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cellXfs"),e.writeAttributeString("count",n.format("{0}",this.xfList.length));for(var r=0;r<this.xfList.length;r++){var s=this.xfList[r],o=this.fillList[s.FillIndex],l=s.FillIndex;0==o.FgColor.a&&(l=0),e.writeStartElement("xf"),e.writeAttributeString("numFmtId",n.format("{0}",s.FormatIndex)),e.writeAttributeString("fontId",n.format("{0}",s.FontIndex)),e.writeAttributeString("fillId",n.format("{0}",l)),e.writeAttributeString("borderId",n.format("{0}",s.BorderIndex)),e.writeAttributeString("xfId",n.format("{0}",s.XFId)),0!=s.FormatIndex&&e.writeAttributeString("applyNumberFormat","1"),0!=s.FontIndex&&e.writeAttributeString("applyFont","1"),0!=s.FillIndex&&e.writeAttributeString("applyFill","1"),0!=s.BorderIndex&&e.writeAttributeString("applyBorder","1"),e.writeAttributeString("applyAlignment","1"),s.Editable&&e.writeAttributeString("applyProtection","1"),e.writeStartElement("alignment");var m="left";switch(s.HorAlign){case g.Right:m="right";break;case g.Center:m="center";break;case g.Width:m="justify";break}if(e.writeAttributeString("horizontal",m),s.VertAlign!=w.Bottom){var c="";switch(s.VertAlign){case w.Top:c="top";break;case w.Center:c="center";break}e.writeAttributeString("vertical",c)}0!=s.TextRotationAngle&&e.writeAttributeString("textRotation",s.TextRotationAngle.toString()),s.TextWrapped&&e.writeAttributeString("wrapText","1"),s.RightToLeft&&e.writeAttributeString("readingOrder","2"),e.writeEndElement(),s.Editable&&(e.writeStartElement("protection"),e.writeAttributeString("locked","0"),e.writeEndElement()),e.writeEndElement()}return e.writeEndElement(),e.writeStartElement("cellStyles"),e.writeAttributeString("count",n.format("{0}",1)),e.writeStartElement("cellStyle"),e.writeAttributeString("name","Normal"),e.writeAttributeString("xfId",n.format("{0}",0)),e.writeAttributeString("builtinId",n.format("{0}",0)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("dxfs"),e.writeAttributeString("count",n.format("{0}",0)),e.writeEndElement(),e.writeStartElement("tableStyles"),e.writeAttributeString("count",n.format("{0}",0)),e.writeAttributeString("defaultTableStyle","TableStyleMedium9"),e.writeAttributeString("defaultPivotStyle","PivotStyleLight16"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeBorderData=function(t,e,r){if(t.writeStartElement(e),null!=r){var i=this.getLineStyle(r),o=r.color;""!=i&&(t.writeAttributeString("style",i),t.writeStartElement("color"),t.writeAttributeString("rgb",n.format("{0:X8}",o.toArgb())),t.writeEndElement())}t.writeEndElement()},W.prototype.writeSST=function(){var t=new y,e=new x(v.UTF8,t);e.writeStartDocument(),e.writeStartElement("sst"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),e.writeAttributeString("count",n.format("{0}",this.sstCount)),e.writeAttributeString("uniqueCount",n.format("{0}",this.sstList.length));for(var r=0;r<this.sstList.length;r++){e.writeStartElement("si");for(var i=this.sstList[r],o=new S,a=0;a<i.length;a++)(i.charCodeAt(a)>=32||"\n"==i.charAt(a))&&o.append(i.charAt(a));i=o.toString(),this.sstHashIsTags.containsKey(r)?e.writeRaw(i):this.convertTextToExcelString(e,i),e.writeEndElement()}return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},W.prototype.writeAdditionalData=function(e,r){var i=new y,n=null;return n=r?t.System.Convert.fromBase64String(e):v.ASCII.getBytes(e),i.write(n,0,n.length),i},W.prototype.writeImage=function(t){var e=new y,r=this.imageList[t],i=this.imageCache.imagePackedStore[t];return null!=i&&e.write(i,0,i.length),e},W.prototype.exportExcel=function(i,o,a){e.StiLogService.write(this.stimulsoft.getType(),"Export report to Excel 2007 format");var l=a.pageRange;this.useOnePageHeaderAndFooter=a.useOnePageHeaderAndFooter,this.exportDataOnly=a.exportDataOnly,this.exportObjectFormatting=a.exportObjectFormatting,this.exportEachPageToSheet=a.exportEachPageToSheet,this.exportHorizontalPageBreaks=a.exportPageBreaks,this.imageResolution=a.imageResolution,this.imageQuality=a.imageQuality,this.docCompanyString=a.companyString,this.docLastModifiedString=a.lastModifiedString,this.restrictEditing=a.restrictEditing,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.exportDataOnly?this.useOnePageHeaderAndFooter=!1:this.exportObjectFormatting=!0,t["StiOptions"].Export.Excel.RestrictEditing>this.restrictEditing&&(this.restrictEditing=t["StiOptions"].Export.Excel.RestrictEditing),this.report=i;try{this.reportCulture=L.currentCulture;var m=l.getSelectedPages(i.renderedPages);this.currentPassNumber=0,this.maximumPassNumber=3,this.prepareData();var p=0;while(p<m.length){var g=new c(i,i.renderedPages);g.cacheMode=i.renderedPages.cacheMode,g.addV2Internal(m.getPageWithoutCache(p));var h=p;if(!this.exportEachPageToSheet){var w=m.getPageWithoutCache(p).excelSheetValue;while(p<m.length-1&&this.compareExcellSheetNames(m.getPageWithoutCache(p+1).excelSheetValue,w))p++,g.addV2Internal(m.getPageWithoutCache(p))}var u=g.getByIndex(0).excelSheetValue;null!=u&&""!=u||(u=n.format("Page {0}",this.sheetNameList.length+1));var d="",S=1;this.prepareMatrix(g);var f=0;do{this.firstPageIndexList.push(h),this.matrixList.push(this.matrix);var v=this.matrix.coordY.countItems-1;v-f>t["StiOptions"].Export.Excel.MaximumSheetHeight?v=f+t["StiOptions"].Export.Excel.MaximumSheetHeight:this.matrix=null,this.minRowList.push(f),this.maxRowList.push(v),f=v,null!=this.matrix||d.length>0?(d=n.format(" part{0}",S++),u.length>24&&(u=u.substr(0,24))):u.length>30&&(u=u.substr(0,30)),this.sheetNameList.push(u+d)}while(null!=this.matrix);p++}for(var E=new s,b=0;b<this.sheetNameList.length;b++){var y=this.sheetNameList[b];if(y=y.stimulsoft.replaceAll("*","_").stimulsoft.replaceAll("\\","_").stimulsoft.replaceAll("/","_").stimulsoft.replaceAll("[","_").stimulsoft.replaceAll("]","_").stimulsoft.replaceAll(":","_").stimulsoft.replaceAll("?","_"),E.contains(y)){var x=1;while(E.contains(y+"-"+x.toString()))x++;y=y+"-"+x.toString()}E.add(y,y),this.sheetNameList[b]=y}var A=new P;A.begin(o,!0),this.currentPassNumber=2,this.imageListOffset=0;for(var T=0;T<this.matrixList.length;T++)this.hyperlinkList=[],A.addFile(n.format("xl/worksheets/sheet{0}.xml",T+1),this.writeSheet(T,m.getByIndex(this.firstPageIndexList[T]))),A.addFile(n.format("xl/worksheets/_rels/sheet{0}.xml.rels",T+1),this.writeSheetRels(T)),this.imageList.length-this.imageListOffset>0&&(A.addFile(n.format("xl/drawings/_rels/drawing{0}.xml.rels",T+1),this.writeDrawingRels(T)),A.addFile(n.format("xl/drawings/drawing{0}.xml",T+1),this.writeDrawing(T))),this.imageListOffset=this.imageList.length;if(A.addFile("[Content_Types].xml",this.writeContentTypes()),A.addFile("_rels/.rels",this.writeMainRels()),A.addFile("docProps/app.xml",this.writeDocPropsApp()),A.addFile("docProps/core.xml",this.writeDocPropsCore()),A.addFile("xl/_rels/workbook.xml.rels",this.writeWorkbookRels()),A.addFile("xl/workbook.xml",this.writeWorkbook()),A.addFile("xl/styles.xml",this.writeStyles()),this.sstList.length>0&&A.addFile("xl/sharedStrings.xml",this.writeSST()),this.imageCache.imagePackedStore.length>0)for(var b=0;b<this.imageCache.imagePackedStore.length;b++)A.addFile(n.format("xl/media/image{0:D5}.jpeg",b+1),this.writeImage(b));t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(A.addFile("xl/media/imageAdditional.png",this.writeAdditionalData(r.StiExportUtils.additionalData,!0)),A.addFile("xl/drawings/_rels/vmlDrawingAdditional.vml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="dId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/imageAdditional.png"/></Relationships>',!1)),A.addFile("xl/drawings/vmlDrawingAdditional.vml",this.writeAdditionalData('<xml xmlns:v="urn:schemas-microsoft-com:vml"\r\n xmlns:o="urn:schemas-microsoft-com:office:office"\r\n xmlns:x="urn:schemas-microsoft-com:office:excel">\r\n <o:shapelayout v:ext="edit">\r\n  <o:idmap v:ext="edit" data="1"/>\r\n'+' </o:shapelayout><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"\r\n  o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">\r\n  <v:stroke joinstyle="miter"/>\r\n  <v:formulas>'+'\r\n   <v:f eqn="if lineDrawn pixelLineWidth 0"/>\r\n   <v:f eqn="sum @0 1 0"/>\r\n   <v:f eqn="sum 0 0 @1"/>\r\n   <v:f eqn="prod @2 1 2"/>\r\n   <v:f eqn="prod @3 21600 pixelWidth"/>\r\n   <v:f eqn="prod @3 21600 pixelHeight"/>\r\n   <v:f eqn="sum @0 0 1"/>'+'\r\n   <v:f eqn="prod @6 1 2"/>\r\n   <v:f eqn="prod @7 21600 pixelWidth"/>\r\n   <v:f eqn="sum @8 21600 0"/>\r\n   <v:f eqn="prod @7 21600 pixelHeight"/>\r\n   <v:f eqn="sum @10 21600 0"/>\r\n  </v:formulas>\r\n  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'\r\n  <o:lock v:ext="edit" aspectratio="t"/>\r\n </v:shapetype><v:shape id="CH" o:spid="_x0000_s1027" type="#_x0000_t75"\r\n  style=\'position:absolute;margin-left:0;margin-top:0;width:365pt;height:298pt;\r\n  z-index:1\'>'+'\r\n  <v:imagedata o:relid="dId1" o:title="additional"/>\r\n  <o:lock v:ext="edit" rotation="t"/>\r\n </v:shape></xml>',!1))),A.end()}catch(e){t.System.StiError.showError(e,!1)}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.formatList=null,this.sheetNameList=null,this.imageList.stimulsoft.clear(),this.imageList=null,this.imageCache.clear(),this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null}},W.regexCheckInteger1=new RegExp("^[+-]?d+$"),W.regexCheckFloat1=new RegExp("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$"),W}(r.StiExportService);r.StiExcel2007ExportService=k;var R=function(){function t(t,e,r,i,n,o,a,s,l){this.Name=t,this.Bold=e,this.Italic=r,this.Underlined=i,this.Strikeout=n,this.Height=o,this.Color=a,this.Charset=s,this.Family=l}return t.prototype.equals=function(t){return this.Name==t.Name&&this.Bold==t.Bold&&this.Italic==t.Italic&&this.Underlined==t.Underlined&&this.Strikeout==t.Strikeout&&this.Height==t.Height&&this.Color.stimulsoft.equals(t.Color)&&this.Charset==t.Charset&&this.Family==t.Family},t}();r.DataFont=R;var I=function(){function t(t,e,r){this.Type=t,this.FgColor=e,this.BgColor=r}return t.prototype.equals=function(t){return this.Type==t.Type&&this.FgColor.stimulsoft.equals(t.FgColor)&&this.BgColor.stimulsoft.equals(t.BgColor)},t}();r.DataFill=I;var D=function(){function t(t,e,r,i){this.BorderLeft=t,this.BorderRight=e,this.BorderTop=r,this.BorderBottom=i}return t.prototype.equals=function(t){return this.eq(this.BorderLeft,t.BorderLeft)&&this.eq(this.BorderRight,t.BorderRight)&&this.eq(this.BorderTop,t.BorderTop)&&this.eq(this.BorderBottom,t.BorderBottom)},t.prototype.eq=function(t,e){return null==t&&null==e||null!=t&&null!=e&&t.stimulsoft.equals(e)},t}();r.DataBorder=D;var N=function(){function t(t,e,r,i,n,o,a,s,l,m,c){this.FormatIndex=t,this.FontIndex=e,this.FillIndex=r,this.BorderIndex=i,this.XFId=n,this.HorAlign=o,this.VertAlign=a,this.TextRotationAngle=s,this.TextWrapped=l,this.RightToLeft=m,this.Editable=c}return t.prototype.equalDataXF=function(t){if(this.FormatIndex!=t.FormatIndex||this.FontIndex!=t.FontIndex||this.FillIndex!=t.FillIndex||this.BorderIndex!=t.BorderIndex||this.XFId!=t.XFId||this.HorAlign!=t.HorAlign||this.VertAlign!=t.VertAlign||this.TextRotationAngle!=t.TextRotationAngle||this.TextWrapped!=t.TextWrapped||this.RightToLeft!=t.RightToLeft||this.Editable!=t.Editable)return!1;return!0},t}();r.DataXF=N;var O=function(){function t(t,e,r,i,n,o,a,s,l,m){this.FirstRowIndex=t,this.FirstRowOffset=e,this.FirstColumnIndex=r,this.FirstColumnOffset=i,this.LastRowIndex=n,this.LastRowOffset=o,this.LastColumnIndex=a,this.LastColumnOffset=s,this.ImageIndex=l,this.Hyperlink=m}return t}();r.ExcelImageData=O;var H=function(){function t(t,e,r,i){this.FirstRow=t,this.LastRow=e,this.FirstColumn=r,this.LastColumn=i}return t}();r.CellRangeAddress=H;var M=function(){function t(t,e,r){this.Range=t,this.Description=e,this.Bookmark=r}return t}();r.HlinkData=M}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(t){var e;!function(t){var e=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.implements=function(){return[t.IStiExcelXmlExportService]},r}(t.StiExportService);t.StiExcelXmlExportService=e}(e=t.Export||(t.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.Base.Drawing.StiPenStyle,n=t.Base.Zip.StiZipWriter20,o=t.Report.Components.StiImage,a=t.Base.Drawing.StiHorAlignment,s=t.Base.Drawing.StiCapStyle,l=t.Report.Components.StiVerticalLinePrimitive,m=t.Report.Components.StiHorizontalLinePrimitive,c=t.Base.Drawing.StiAdvancedBorder,p=t.Base.Drawing.StiBorderSides,g=t.Report.Components.IStiBorder,h=t.Report.Components.StiShape,w=t.Report.Components.IStiBrush,u=t.Report.Components.IStiTextOptions,d=t.Report.Components.StiLinePrimitive,S=t.Report.Components.IStiExportImageExtended,f=t.Base.Drawing.StiTextRenderer,v=t.Report.Components.StiTextQuality,E=t.Base.Drawing.StiBrush,b=t.Report.Components.StiContainer,y=t.Report.Components.StiText,x=t.System.DateTime,A=t.System.StiString,T=t.System.Text.StringBuilder,P=t.System.Globalization.CultureInfo,L=t.System.Xml.Formatting,C=t.System.Text.Encoding,F=t.System.Xml.XmlTextWriter,B=t.Report.Dashboard.StiDashboardExport,k=t.Report.Dashboard.IStiDashboard,R=t.System.IO.MemoryStream,I=function(I){function D(){var t=null!==I&&I.apply(this,arguments)||this;return t.imageListOffset=0,t.imageResolution=1,t.imageQuality=.75,t.imageCache=null,t.idCounter=2,t.hyperlinkList=null,t.xmlIndentation=1,t.currentCulture=null,t.newCulture=null,t.wrongUrlSymbols=" \"#'*,;<>[^`{|}",t.HiToTwips=14.4*.995,t}return __extends(D,I),D.prototype.implements=function(){return[r.IStiPpt2007ExportService]},D.prototype.getDefaultExtension=function(){return"pptx"},D.prototype.exportTo=function(t,e,r){this.exportPowerPoint(t,e,r)},D.prototype.exportToAsync=function(e,r,i,n){var o=this;t.Report.Export.StiExportImageHelper.convertAllImages(r,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?t.System.Drawing.Imaging.ImageFormat.Png:t.System.Drawing.Imaging.ImageFormat.Jpeg).try((function(){if(!r.isDocument&&r.getCurrentPage().stimulsoft.is(k))return void B.exportAsync(r,i,n).try((function(){return e()}));o.exportTo(r,i,n),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null),e()}))},D.prototype.getLineStyle=function(t){switch(t){case i.Solid:return"solid";case i.Dot:return"sysDot";case i.Dash:return"sysDash";case i.DashDot:return"sysDashDot";case i.DashDotDot:return"sysDashDotDot";case i.Double:return"solid";default:return"solid"}},D.prototype.stringToUrl=function(t){var e,r,i=C.UTF8.getBytes(t),n=new T;try{for(var o=__values(i),a=o.next();!a.done;a=o.next()){var s=a.value,l=String.fromCharCode(s);s<32||s>127||-1!=this.wrongUrlSymbols.indexOf(l)?n.append(A.format("%{0:x2}",s)):n.append(l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n.toString()},D.prototype.convert=function(t){return 0|Math.round(t*this.HiToTwips)},D.prototype.convertTwipsToEmu=function(t){return 0|Math.round(t/this.HiToTwips/100*914400)},D.prototype.convertToEmu=function(t){return 0|Math.round(t/100*914400)},D.prototype.writeColor=function(t,e){if(t.writeStartElement("a:srgbClr"),t.writeAttributeString("val",A.format("{0:X6}",16777215&e.toArgb())),255!=e.a){var r=e.a/256*1e5|0;t.writeStartElement("a:alpha"),t.writeAttributeString("val",A.format("{0}",r)),t.writeEndElement()}t.writeEndElement()},D.prototype.writeContentTypes=function(t){var e=new R,r=new F(C.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?L.None:L.Indented,r.writeStartDocument(),r.writeStartElement("Types"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types");for(var i=0;i<11;i++)r.writeStartElement("Override"),r.writeAttributeString("PartName",A.format("/ppt/slideLayouts/slideLayout{0}.xml",i+1)),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"),r.writeEndElement();r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/slideMasters/slideMaster1.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/presProps.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presProps+xml"),r.writeEndElement();for(var i=0;i<t;i++)r.writeStartElement("Override"),r.writeAttributeString("PartName",A.format("/ppt/slides/slide{0}.xml",i+1)),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slide+xml"),r.writeEndElement();return r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/theme/theme1.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.theme+xml"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","jpeg"),r.writeAttributeString("ContentType","image/jpeg"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","png"),r.writeAttributeString("ContentType","image/png"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","rels"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","xml"),r.writeAttributeString("ContentType","application/xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/presentation.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/docProps/app.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/tableStyles.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/ppt/viewProps.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/docProps/core.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writeMainRels=function(){var t=new R,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","ppt/presentation.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeDocPropsApp=function(t){var e=new R,r=new F(C.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?L.None:L.Indented,r.writeStartDocument(),r.writeStartElement("Properties"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),r.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),r.writeElementString("Application","Microsoft Office PowerPoint"),r.writeElementString("Slides",A.format("{0}",t)),r.writeElementString("PresentationFormat","On-screen Show (4:3)"),r.writeElementString("TotalTime","0"),r.writeElementString("Words","0"),r.writeElementString("Paragraphs","0"),r.writeElementString("Notes","0"),r.writeElementString("HiddenSlides","0"),r.writeElementString("MMClips","0"),r.writeElementString("ScaleCrop","false"),r.writeStartElement("HeadingPairs"),r.writeStartElement("vt:vector"),r.writeAttributeString("size","4"),r.writeAttributeString("baseType","variant"),r.writeStartElement("vt:variant"),r.writeElementString("vt:lpstr","Theme"),r.writeEndElement(),r.writeStartElement("vt:variant"),r.writeElementString("vt:i4",A.format("{0}",t)),r.writeEndElement(),r.writeStartElement("vt:variant"),r.writeElementString("vt:lpstr","Slide Titles"),r.writeEndElement(),r.writeStartElement("vt:variant"),r.writeElementString("vt:i4",A.format("{0}",t)),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("TitlesOfParts"),r.writeStartElement("vt:vector"),r.writeAttributeString("size",A.format("{0}",1+t)),r.writeAttributeString("baseType","lpstr"),r.writeElementString("vt:lpstr","Office Theme");for(var i=0;i<t;i++)r.writeElementString("vt:lpstr",A.format("Slide {0}",i+1));return r.writeEndElement(),r.writeEndElement(),r.writeElementString("Company","Stimulsoft"),r.writeElementString("LinksUpToDate","false"),r.writeElementString("SharedDoc","false"),r.writeElementString("HyperlinksChanged","false"),r.writeElementString("AppVersion","12.0000"),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writeDocPropsCore=function(){var t=new R,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var r=A.format("{0}",x.now.toString("yyyy-MM-ddTHH:mm:ssZ"));return e.writeElementString("dc:title",""),e.writeElementString("dc:subject",""),e.writeElementString("dc:creator","Stimulsoft Reports"),e.writeElementString("cp:keywords",""),e.writeElementString("dc:description",""),e.writeElementString("cp:lastModifiedBy","Stimulsoft Reports"),e.writeElementString("cp:revision","1"),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(r),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeTableStyles=function(){var t=new R,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("a:tblStyleLst"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("def","{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"),e.writeEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writePresProps=function(){var t=new R,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("p:presentationPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeViewProps=function(){var t=new R,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("p:viewPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeStartElement("p:normalViewPr"),e.writeAttributeString("showOutlineIcons","0"),e.writeStartElement("p:restoredLeft"),e.writeAttributeString("sz","15591"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeStartElement("p:restoredTop"),e.writeAttributeString("sz","94675"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:slideViewPr"),e.writeStartElement("p:cSldViewPr"),e.writeStartElement("p:cViewPr"),e.writeAttributeString("varScale","1"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","-1098"),e.writeAttributeString("y","-84"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:guideLst"),e.writeStartElement("p:guide"),e.writeAttributeString("orient","horz"),e.writeAttributeString("pos","2160"),e.writeEndElement(),e.writeStartElement("p:guide"),e.writeAttributeString("pos","2880"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:notesTextViewPr"),e.writeStartElement("p:cViewPr"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","0"),e.writeAttributeString("y","0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:gridSpacing"),e.writeAttributeString("cx","73736200"),e.writeAttributeString("cy","73736200"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeTheme=function(){var t=new R,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument();var r='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="1F497D" /></a:dk2><a:lt2><a:srgbClr val="EEECE1" /></a:lt2><a:accent1><a:srgbClr val="4F81BD" /></a:accent1><a:accent2><a:srgbClr val="C0504D" /></a:accent2><a:accent3><a:srgbClr val="9BBB59" /></a:accent3><a:accent4>'+'<a:srgbClr val="8064A2" /></a:accent4><a:accent5><a:srgbClr val="4BACC6" /></a:accent5><a:accent6><a:srgbClr val="F79646" /></a:accent6><a:hlink><a:srgbClr val="0000FF" /></a:hlink><a:folHlink><a:srgbClr val="800080" /></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" />'+'<a:font script="Arab" typeface="Times New Roman" /><a:font script="Hebr" typeface="Times New Roman" /><a:font script="Thai" typeface="Angsana New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" /><a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="MoolBoran" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" />'+'<a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" /><a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Times New Roman" />'+'<a:font script="Uigh" typeface="Microsoft Uighur" /></a:majorFont><a:minorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" /><a:font script="Arab" typeface="Arial" /><a:font script="Hebr" typeface="Arial" /><a:font script="Thai" typeface="Cordia New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" />'+'<a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="DaunPenh" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" /><a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" />'+'<a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Arial" /><a:font script="Uigh" typeface="Microsoft Uighur" /></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0">'+'<a:schemeClr val="phClr"><a:tint val="50000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000" /><a:satMod val="350000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr">'+'<a:shade val="93000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000" /><a:satMod val="135000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000" /><a:satMod val="105000" /></a:schemeClr></a:solidFill><a:prstDash val="solid" /></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill>'+'<a:prstDash val="solid" /></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst>'+'</a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0" /></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000" /></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400" /></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1">'+'<a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000" /><a:shade val="99000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000" /><a:satMod val="255000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000" /></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000" /><a:satMod val="300000" /></a:schemeClr>'+'</a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000" /><a:satMod val="200000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000" /></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults /><a:extraClrSchemeLst /></a:theme>';return e.writeRaw(r),e.writeEndDocument(),e.flush(),t},D.prototype.writeSlideMasterRels=function(){var t=new R,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var r=0;r<11;r++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",A.format("rId{0}",r+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),e.writeAttributeString("Target",A.format("../slideLayouts/slideLayout{0}.xml",r+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId12"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),e.writeAttributeString("Target","../theme/theme1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeSlideMaster=function(){var t=new R,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument();var r='<p:sldMaster xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main"><p:cSld><p:bg><p:bgRef idx="1001"><a:schemeClr val="bg1" /></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" />'+'<a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title Placeholder 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="8229600" cy="1143000" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr">'+'<a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="8229600" cy="4525963" /></a:xfrm><a:prstGeom prst="rect">'+'<a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"><a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm>'+'<a:off x="457200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p>'+'<a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3124200" y="6356350" /><a:ext cx="2895600" cy="365125" /></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="ctr"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6553200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="r"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1">'+'<a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1="lt1" tx1="dk1" bg2="lt2" tx2="dk2" accent1="accent1" accent2="accent2" accent3="accent3" accent4="accent4" accent5="accent5" accent6="accent6" hlink="hlink" folHlink="folHlink" />'+'<p:sldLayoutIdLst><p:sldLayoutId id="2147483649" r:id="rId1" /><p:sldLayoutId id="2147483650" r:id="rId2" /><p:sldLayoutId id="2147483651" r:id="rId3" /><p:sldLayoutId id="2147483652" r:id="rId4" /><p:sldLayoutId id="2147483653" r:id="rId5" /><p:sldLayoutId id="2147483654" r:id="rId6" /><p:sldLayoutId id="2147483655" r:id="rId7" /><p:sldLayoutId id="2147483656" r:id="rId8" /><p:sldLayoutId id="2147483657" r:id="rId9" /><p:sldLayoutId id="2147483658" r:id="rId10" />'+'<p:sldLayoutId id="2147483659" r:id="rId11" /></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn="ctr" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="0" /></a:spcBef><a:buNone /><a:defRPr sz="4400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mj-lt" /><a:ea typeface="+mj-ea" /><a:cs typeface="+mj-cs" /></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle>'+'<a:lvl1pPr marL="342900" indent="-342900" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="3200" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr>'+'<a:lvl2pPr marL="742950" indent="-285750" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr>'+'<a:lvl3pPr marL="1143000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1600200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr>'+'<a:lvl5pPr marL="2057400" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="»" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2514600" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2971800" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr>'+'<a:lvl8pPr marL="3429000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr>'+'<a:lvl9pPr marL="3886200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr>'+'</p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang="ru-RU" /></a:defPPr><a:lvl1pPr marL="0" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">'+'<a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>';return e.writeRaw(r),e.writeEndDocument(),e.flush(),t},D.prototype.writeSlideLayoutRels=function(){var t=new R,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),e.writeAttributeString("Target","../slideMasters/slideMaster1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeSlideLayout=function(e,r){var i=new R,n=new F(C.UTF8,i);if(n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?L.None:L.Indented,n.writeStartDocument(),n.writeStartElement("p:sldLayout"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),1==e){n.writeAttributeString("type","title"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Title Slide"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ctrTitle" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="685800" y="2130425" /><a:ext cx="7772400" cy="1470025" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Subtitle 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="subTitle" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1371600" y="3886200" /><a:ext cx="6400800" cy="1752600" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(2==e){n.writeAttributeString("type","obj"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Title and Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r>'+'<a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(3==e){n.writeAttributeString("type","secHead"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Section Header"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="4406900" /><a:ext cx="7772400" cy="1362075" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="t" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="4000" b="1" cap="all" /></a:lvl1pPr></a:lstStyle><a:p><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="2906713" /><a:ext cx="7772400" cy="1500187" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2000"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone />'+'<a:defRPr sz="1800"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1600"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>'+'<a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr>'+'<p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(4==e){n.writeAttributeString("type","twoObj"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Two Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph sz="half" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4648200" y="1600200" />'+'<a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(5==e){n.writeAttributeString("type","twoTxTwoObj"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Comparison"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1535113" /><a:ext cx="4040188" cy="639762" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="2174875" />'+'<a:ext cx="4040188" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Text Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="1535113" /><a:ext cx="4041775" cy="639762" /></a:xfrm></p:spPr>'+'<p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0">'+'<a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Content Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="2174875" /><a:ext cx="4041775" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr>'+'<a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Date Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="8" name="Footer Placeholder 7" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="9" name="Slide Number Placeholder 8" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(6==e){n.writeAttributeString("type","titleOnly"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Title Only"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Date Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Footer Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Slide Number Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(7==e){if(n.writeAttributeString("type","blank"),n.writeAttributeString("preserve","1"),n.writeStartElement("p:cSld"),n.writeAttributeString("name","Blank"),n.writeStartElement("p:spTree"),n.writeStartElement("p:nvGrpSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","1"),n.writeAttributeString("name",""),n.writeEndElement(),n.writeStartElement("p:cNvGrpSpPr"),n.writeEndElement(),n.writeStartElement("p:nvPr"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:grpSpPr"),n.writeStartElement("a:xfrm"),n.writeStartElement("a:off"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:ext"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeStartElement("a:chOff"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:chExt"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","2"),n.writeAttributeString("name","Date Placeholder 1"),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeStartElement("a:spLocks"),n.writeAttributeString("noGrp","1"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:nvPr"),n.writeStartElement("p:ph"),n.writeAttributeString("type","dt"),n.writeAttributeString("sz","half"),n.writeAttributeString("idx","10"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:spPr"),n.writeEndElement(),n.writeStartElement("p:txBody"),n.writeStartElement("a:bodyPr"),n.writeEndElement(),n.writeStartElement("a:lstStyle"),n.writeEndElement(),n.writeStartElement("a:p"),n.writeStartElement("a:fld"),n.writeAttributeString("id","{BBCD0B08-7874-4091-A11F-B0CCB138CA98}"),n.writeAttributeString("type","datetimeFigureOut"),n.writeStartElement("a:rPr"),n.writeAttributeString("lang","ru-RU"),n.writeAttributeString("smtClean","0"),n.writeEndElement(),n.writeStartElement("a:t"),n.writeString("15.04.2009"),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("a:endParaRPr"),n.writeAttributeString("lang","ru-RU"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","3"),n.writeAttributeString("name","Footer Placeholder 2"),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeStartElement("a:spLocks"),n.writeAttributeString("noGrp","1"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:nvPr"),n.writeStartElement("p:ph"),n.writeAttributeString("type","ftr"),n.writeAttributeString("sz","quarter"),n.writeAttributeString("idx","11"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:spPr"),n.writeEndElement(),n.writeStartElement("p:txBody"),n.writeStartElement("a:bodyPr"),n.writeEndElement(),n.writeStartElement("a:lstStyle"),n.writeEndElement(),n.writeStartElement("a:p"),n.writeStartElement("a:endParaRPr"),n.writeAttributeString("lang","ru-RU"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","4"),n.writeAttributeString("name","Slide Number Placeholder 3"),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeStartElement("a:spLocks"),n.writeAttributeString("noGrp","1"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:nvPr"),n.writeStartElement("p:ph"),n.writeAttributeString("type","sldNum"),n.writeAttributeString("sz","quarter"),n.writeAttributeString("idx","12"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:spPr"),n.writeEndElement(),n.writeStartElement("p:txBody"),n.writeStartElement("a:bodyPr"),n.writeEndElement(),n.writeStartElement("a:lstStyle"),n.writeEndElement(),n.writeStartElement("a:p"),n.writeStartElement("a:fld"),n.writeAttributeString("id","{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}"),n.writeAttributeString("type","slidenum"),n.writeStartElement("a:rPr"),n.writeAttributeString("lang","ru-RU"),n.writeAttributeString("smtClean","0"),n.writeEndElement(),n.writeStartElement("a:t"),n.writeString("‹#›"),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("a:endParaRPr"),n.writeAttributeString("lang","ru-RU"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),!(t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion)){var a=r.unit.convertToHInches(r.pageWidth-r.margins.left-r.margins.right),s=r.unit.convertToHInches(r.pageHeight-r.margins.top-r.margins.bottom),l=r.unit.convertToHInches(r.margins.left),m=r.unit.convertToHInches(r.margins.top);n.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(l)+'" y="'+this.convertToEmu(m+.45*s)+'"/><a:ext cx="'+this.convertToEmu(a)+'" cy="'+this.convertToEmu(.1*s)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")}n.writeFullEndElement(),n.writeFullEndElement()}if(8==e){n.writeAttributeString("type","objTx"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Content with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="273050" /><a:ext cx="3008313" cy="1162050" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3575050" y="273050" /><a:ext cx="5111750" cy="5853113" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2400" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr>'+'<a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp>'+'<p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1435100" /><a:ext cx="3008313" cy="4691063" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0">'+'<a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(9==e){n.writeAttributeString("type","picTx"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Picture with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="4800600" /><a:ext cx="5486400" cy="566738" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Picture Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="pic" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="612775" /><a:ext cx="5486400" cy="4114800" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="2400" /></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="5367338" /><a:ext cx="5486400" cy="804862" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut">'+'<a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(10==e){n.writeAttributeString("type","vertTx"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Title and Vertical Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'+'<p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" />'+'<a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr>'+'<a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}if(11==e){n.writeAttributeString("type","vertTitleAndTx"),n.writeAttributeString("preserve","1");var o='<p:cSld name="Vertical Title and Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Vertical Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" orient="vert" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6629400" y="274638" /><a:ext cx="2057400" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="6019800" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p>'+'<a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(o)}return n.writeStartElement("p:clrMapOvr"),n.writeStartElement("a:masterClrMapping"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i},D.prototype.writePresentationRels=function(t){var e=new R,r=new F(C.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?L.None:L.Indented,r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles"),r.writeAttributeString("Target","tableStyles.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId2"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps"),r.writeAttributeString("Target","viewProps.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId3"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps"),r.writeAttributeString("Target","presProps.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId4"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),r.writeAttributeString("Target","theme/theme1.xml"),r.writeEndElement(),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId5"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),r.writeAttributeString("Target","slideMasters/slideMaster1.xml"),r.writeEndElement();for(var i=0;i<t.count;i++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",A.format("rId{0}",6+i)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),r.writeAttributeString("Target",A.format("slides/slide{0}.xml",i+1)),r.writeEndElement();return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writePresentation=function(t){var e=new R,r=new F(C.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?L.None:L.Indented,r.writeStartDocument(),r.writeStartElement("p:presentation"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),r.writeAttributeString("saveSubsetFonts","1"),r.writeStartElement("p:sldMasterIdLst"),r.writeStartElement("p:sldMasterId"),r.writeAttributeString("id","2147483648"),r.writeAttributeString("r:id","rId5"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("p:sldIdLst");for(var i=0;i<t.count;i++)r.writeStartElement("p:sldId"),r.writeAttributeString("id",A.format("{0}",256+i)),r.writeAttributeString("r:id",A.format("rId{0}",6+i)),r.writeEndElement();r.writeEndElement();var n=t.getByIndex(0);return r.writeStartElement("p:sldSz"),r.writeAttributeString("cx",this.convertToEmu(n.unit.convertToHInches(n.width+n.margins.left+n.margins.right)).toString()),r.writeAttributeString("cy",this.convertToEmu(n.unit.convertToHInches(n.height+n.margins.top+n.margins.bottom)).toString()),r.writeEndElement(),r.writeStartElement("p:notesSz"),r.writeAttributeString("cx","6858000"),r.writeAttributeString("cy","9144000"),r.writeEndElement(),r.writeStartElement("p:defaultTextStyle"),r.writeStartElement("a:defPPr"),r.writeStartElement("a:defRPr"),r.writeAttributeString("lang","ru-RU"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl1pPr"),r.writeAttributeString("marL","0"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl2pPr"),r.writeAttributeString("marL","457200"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl3pPr"),r.writeAttributeString("marL","914400"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl4pPr"),r.writeAttributeString("marL","1371600"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl5pPr"),r.writeAttributeString("marL","1828800"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl6pPr"),r.writeAttributeString("marL","2286000"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl7pPr"),r.writeAttributeString("marL","2743200"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl8pPr"),r.writeAttributeString("marL","3200400"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeStartElement("a:lvl9pPr"),r.writeAttributeString("marL","3657600"),r.writeAttributeString("algn","l"),r.writeAttributeString("defTabSz","914400"),r.writeAttributeString("rtl","0"),r.writeAttributeString("eaLnBrk","1"),r.writeAttributeString("latinLnBrk","0"),r.writeAttributeString("hangingPunct","1"),r.writeStartElement("a:defRPr"),r.writeAttributeString("sz","1800"),r.writeAttributeString("kern","1200"),r.writeStartElement("a:solidFill"),r.writeStartElement("a:schemeClr"),r.writeAttributeString("val","tx1"),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("a:latin"),r.writeAttributeString("typeface","+mn-lt"),r.writeEndElement(),r.writeStartElement("a:ea"),r.writeAttributeString("typeface","+mn-ea"),r.writeEndElement(),r.writeStartElement("a:cs"),r.writeAttributeString("typeface","+mn-cs"),r.writeEndElement(),r.writeFullEndElement(),r.writeFullEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writeSlideRels=function(e){var r=new R,i=new F(C.UTF8,r);if(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?L.None:L.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),i.writeAttributeString("Target","../slideLayouts/slideLayout7.xml"),i.writeEndElement(),this.imageCache.imageIndex.stimulsoft.countItems>this.imageListOffset)for(var n=0;n<this.imageCache.imageIndex.stimulsoft.countItems-this.imageListOffset;n++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",A.format("rId{0}",2+n)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",A.format("../media/image{0:D5}.{1}",this.imageCache.imageIndex[this.imageListOffset+n]+1,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg")),i.writeEndElement();if(this.hyperlinkList.stimulsoft.countItems>0)for(var n=0;n<this.hyperlinkList.stimulsoft.countItems;n++){i.writeStartElement("Relationship"),i.writeAttributeString("Id",A.format("hId{0}",n+1));var o=this.hyperlinkList.stimulsoft.getByIndex(n);o.stimulsoft.is(String)&&(i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",o),i.writeAttributeString("TargetMode","External")),o.stimulsoft.is(Number)&&(i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),i.writeAttributeString("Target",A.format("slide{0}.xml",o))),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},D.prototype.writeSlide=function(e,r){var i,n,o=new R,a=new F(C.UTF8,o);a.indentation=this.xmlIndentation<0?0:this.xmlIndentation,a.formatting=this.xmlIndentation<0?L.None:L.Indented,a.writeStartDocument(),a.writeStartElement("p:sld"),a.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),a.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),a.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),a.writeStartElement("p:cSld"),a.writeStartElement("p:spTree"),a.writeStartElement("p:nvGrpSpPr"),a.writeStartElement("p:cNvPr"),a.writeAttributeString("id","1"),a.writeAttributeString("name",""),a.writeEndElement(),a.writeStartElement("p:cNvGrpSpPr"),a.writeEndElement(),a.writeStartElement("p:nvPr"),a.writeEndElement(),a.writeEndElement(),a.writeStartElement("p:grpSpPr"),a.writeStartElement("a:xfrm"),a.writeStartElement("a:off"),a.writeAttributeString("x","0"),a.writeAttributeString("y","0"),a.writeEndElement(),a.writeStartElement("a:ext"),a.writeAttributeString("cx","0"),a.writeAttributeString("cy","0"),a.writeEndElement(),a.writeStartElement("a:chOff"),a.writeAttributeString("x","0"),a.writeAttributeString("y","0"),a.writeEndElement(),a.writeStartElement("a:chExt"),a.writeAttributeString("cx","0"),a.writeAttributeString("cy","0"),a.writeEndElement(),a.writeEndElement(),a.writeEndElement(),this.idCounter=2;var s=r.getByIndex(e);r.getPage(s),this.writeWatermark(a,s,!0);try{for(var l=__values(s.components.list),m=l.next();!m.done;m=l.next()){var c=m.value;if(c.enabled&&c.width>0&&c.height>0){var p=c.stimulsoft.as(y);if(null==p||p.checkAllowHtmlTags())if(c.stimulsoft.is(b)){var g=new y(c.clientRectangle);g.page=c.page,g.border=c.stimulsoft.as(b).border,g.brush=c.stimulsoft.as(b).brush,g.hyperlinkValue=c.hyperlinkValue,this.writeStiTextbox(a,g)}else this.writeStiImage(a,c);else{var h=p.angle%360;if(h<0&&(h=360+h),0==h||90==h||270==h)this.writeStiTextbox(a,c);else{var w=p.clone(!0);w.text=null,w.angle=0,this.writeStiTextbox(a,w),(w=p.clone(!0)).border=null,w.brush=null,w.horAlignment=StiTextHorAlignment.Center,w.vertAlignment=StiVertAlignment.Center,this.writeStiTextbox(a,w)}}this.idCounter++}}}catch(t){i={error:t}}finally{try{m&&!m.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}if(this.writeWatermark(a,s,!1),!(t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion)){var u=s.unit.convertToHInches(s.pageWidth-s.margins.left-s.margins.right),d=s.unit.convertToHInches(s.pageHeight-s.margins.top-s.margins.bottom),S=s.unit.convertToHInches(s.margins.left),f=s.unit.convertToHInches(s.margins.top);a.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(S)+'" y="'+this.convertToEmu(f+.45*d)+'"/><a:ext cx="'+this.convertToEmu(u)+'" cy="'+this.convertToEmu(.1*d)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")}return a.writeFullEndElement(),a.writeEndElement(),a.writeStartElement("p:clrMapOvr"),a.writeStartElement("a:masterClrMapping"),a.writeEndElement(),a.writeFullEndElement(),a.writeFullEndElement(),a.writeEndDocument(),a.flush(),o},D.prototype.writeStiTextbox=function(t,e){var r=e;t.writeStartElement("p:sp"),t.writeStartElement("p:nvSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",A.format("{0}",this.idCounter)),t.writeAttributeString("name",A.format("TextBox {0}",this.idCounter)),this.writeHyperlinkInfo(t,e),t.writeEndElement(),t.writeStartElement("p:cNvSpPr"),t.writeAttributeString("txBox","1"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();var i=this.writeSpPr(t,e);t.writeStartElement("p:txBody"),t.writeStartElement("a:bodyPr");var n=!1,o="";if(null!=r.textOptions){n=r.textOptions.wordWrap;var a=r.textOptions.angle%360;a<0&&(a=360+a),90==a&&(o="vert270"),270==a&&(o="vert")}o.length>0&&t.writeAttributeString("vert",o),t.writeAttributeString("horzOverflow","clip"),t.writeAttributeString("vertOverflow","clip");var s=this.convertToEmu(r.margins.left),l=this.convertToEmu(r.margins.right),m=this.convertToEmu(r.margins.top),c=this.convertToEmu(r.margins.bottom);t.writeAttributeString("lIns",A.format("{0}",s)),t.writeAttributeString("tIns",A.format("{0}",m)),t.writeAttributeString("rIns",A.format("{0}",l)),t.writeAttributeString("bIns",A.format("{0}",c)),t.writeAttributeString("wrap",n?"square":"none"),t.writeAttributeString("rtlCol","0");var p="t";r.vertAlignment==StiVertAlignment.Center&&(p="ctr"),r.vertAlignment==StiVertAlignment.Bottom&&(p="b"),t.writeAttributeString("anchor",p),t.writeAttributeString("anchorCtr","0"),t.writeStartElement("a:noAutofit"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:lstStyle"),t.writeEndElement(),t.writeStartElement("a:p");var g=!1;null!=r.textOptions&&(g=r.textOptions.rightToLeft),t.writeStartElement("a:pPr");var h="";r.horAlignment==StiTextHorAlignment.Center&&(h="ctr"),(r.horAlignment==StiTextHorAlignment.Right&&!g||r.horAlignment==StiTextHorAlignment.Left&&g)&&(h="r"),r.horAlignment==StiTextHorAlignment.Width&&(h="just"),h.length>0&&t.writeAttributeString("algn",h),g&&t.writeAttributeString("rtl","1"),t.writeStartElement("a:lnSpc"),t.writeStartElement("a:spcPct"),t.writeAttributeString("val",Math.round(.94*r.lineSpacing*1e5).toString()),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:r"),t.writeStartElement("a:rPr"),t.writeAttributeString("lang","en-US"),t.writeAttributeString("sz",(100*r.font.sizeInPoints*.984|0).toString()),r.font.bold&&t.writeAttributeString("b","1"),r.font.italic&&t.writeAttributeString("i","1"),r.font.underline&&t.writeAttributeString("u","sng"),r.font.strikeout&&t.writeAttributeString("strike","sngStrike"),t.writeAttributeString("dirty","0"),t.writeAttributeString("smtClean","0"),t.writeStartElement("a:solidFill"),this.writeColor(t,E.toColor(r.textBrush)),t.writeFullEndElement();var w="";null!=r.text&&(w=r.text.toString()),r.textQuality!=v.Wysiwyg&&r.horAlignment!=StiTextHorAlignment.Width||A.isNullOrEmpty(w)||!w.stimulsoft.endsWith(f.StiForceWidthAlignTag)||(w=w.substr(0,w.length-f.StiForceWidthAlignTag.length)),t.writeStartElement("a:latin"),t.writeAttributeString("typeface",r.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeStartElement("a:cs"),t.writeAttributeString("typeface",r.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeEndElement(),t.writeElementString("a:t",w),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),i&&this.writeBorder(t,e)},D.prototype.writeStiImage=function(t,r){var i=!1,n=r.stimulsoft.as(S);if(null!=n){var o=null;if(r.isExportAsImage(e.StiExportFormat.Ppt2007))try{P.currentCulture=this.currentCulture;var a={ref:this.imageResolution};o=n.getImage(a,e.StiExportFormat.ImagePng)}finally{P.currentCulture=this.newCulture}if(null!=o){var s=this.imageCache.addImageInt(o);o.dispose(),t.writeStartElement("p:pic"),t.writeStartElement("p:nvPicPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",A.format("{0}",this.idCounter)),t.writeAttributeString("name",A.format("Picture {0}",this.idCounter+1)),t.writeAttributeString("descr",A.format("Picture {0} description",this.idCounter+1)),this.writeHyperlinkInfo(t,r),t.writeEndElement(),t.writeStartElement("p:cNvPicPr"),t.writeStartElement("a:picLocks"),t.writeAttributeString("noChangeAspect","1"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:blipFill"),t.writeStartElement("a:blip"),t.writeAttributeString("r:embed",A.format("rId{0}",1+this.imageCache.imageIndex.stimulsoft.countItems-this.imageListOffset)),t.writeEndElement(),t.writeStartElement("a:stretch"),t.writeStartElement("a:fillRect"),t.writeEndElement(),t.writeFullEndElement(),t.writeFullEndElement(),i=this.writeSpPr(t,r),t.writeFullEndElement()}}(i||r.stimulsoft.is(d))&&this.writeBorder(t,r)},D.prototype.writeSpPr=function(t,e){var r=this.convertToEmu(e.report.unit.convertToHInches(e.left+e.page.margins.left)),n=this.convertToEmu(e.report.unit.convertToHInches(e.top+e.page.margins.top)),a=this.convertToEmu(e.report.unit.convertToHInches(e.right+e.page.margins.left)),s=this.convertToEmu(e.report.unit.convertToHInches(e.bottom+e.page.margins.top)),l=0,m=e.stimulsoft.as(u);null!=m&&null!=m.textOptions&&(90!=(l=m.textOptions.angle%360)&&270!=l&&-90!=l&&-270!=l||(l=0)),t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),0!=l&&t.writeAttributeString("rot",A.format("{0}",0|Math.round(6e4*-l))),t.writeStartElement("a:off"),t.writeAttributeString("x",A.format("{0}",r)),t.writeAttributeString("y",A.format("{0}",n)),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",A.format("{0}",a-r)),t.writeAttributeString("cy",A.format("{0}",s-n)),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement();var d=e.stimulsoft.is(h)||e.stimulsoft.is(o),S=Color.transparent;e.stimulsoft.is(w)&&(S=E.toColor(e.stimulsoft.as(w).brush)),0==S.a||d?(t.writeStartElement("a:noFill"),t.writeEndElement()):(t.writeStartElement("a:solidFill"),this.writeColor(t,S),t.writeFullEndElement());var f=!1,v=null;return e.stimulsoft.is(g)&&(v=e.stimulsoft.as(g).border),null!=v&&v.side!=p.None&&v.style!=i.None&&(v.side!=p.All||v.stimulsoft.is(c)?f=!0:(t.writeStartElement("a:ln"),t.writeAttributeString("w",A.format("{0}",this.convertToEmu(v.size))),t.writeStartElement("a:solidFill"),this.writeColor(t,v.color),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(v.style)),t.writeEndElement(),t.writeStartElement("a:miter"),t.writeAttributeString("lim","800000"),t.writeEndElement(),t.writeFullEndElement())),t.writeEndElement(),f},D.prototype.writeBorder=function(t,e){var r=e.stimulsoft.as(g).border;if(r.stimulsoft.is(c)){var i=r.stimulsoft.as(c);i.isLeftBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,0,e.height),i.leftSide.size,i.leftSide.style,i.leftSide.color),i.isRightBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.right,e.top,0,e.height),i.rightSide.size,i.rightSide.style,i.rightSide.color),i.isTopBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,e.width,0),i.topSide.size,i.topSide.style,i.topSide.color),i.isBottomBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.bottom,e.width,0),i.bottomSide.size,i.bottomSide.style,i.bottomSide.color)}else r.isLeftBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,0,e.height),r.size,r.style,r.color),r.isRightBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.right,e.top,0,e.height),r.size,r.style,r.color),r.isTopBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,e.width,0),r.size,r.style,r.color),r.isBottomBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.bottom,e.width,0),r.size,r.style,r.color)},D.prototype.writeLine=function(t,e,r,n,o,a){if(o==i.None||0==a.a)return;t.writeStartElement("p:cxnSp"),t.writeStartElement("p:nvCxnSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",A.format("{0}",this.idCounter)),t.writeAttributeString("name",A.format("Line {0}",this.idCounter)),t.writeEndElement(),t.writeStartElement("p:cNvCxnSpPr"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();var s=this.convertToEmu(e.report.unit.convertToHInches(r.left+e.page.margins.left)),c=this.convertToEmu(e.report.unit.convertToHInches(r.top+e.page.margins.top)),p=this.convertToEmu(e.report.unit.convertToHInches(r.right+e.page.margins.left)),g=this.convertToEmu(e.report.unit.convertToHInches(r.bottom+e.page.margins.top));t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),t.writeStartElement("a:off"),t.writeAttributeString("x",A.format("{0}",s)),t.writeAttributeString("y",A.format("{0}",c)),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",A.format("{0}",p-s)),t.writeAttributeString("cy",A.format("{0}",g-c)),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","line"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:ln"),t.writeAttributeString("w",A.format("{0}",this.convertToEmu(n))),t.writeStartElement("a:solidFill"),this.writeColor(t,a),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(o)),t.writeEndElement();var h=e.stimulsoft.as(d);if(null!=h){var w=null,u=null;if(h.stimulsoft.is(m)&&(w=h.stimulsoft.as(m).startCap,u=h.stimulsoft.as(m).endCap),h.stimulsoft.is(l)&&(w=h.stimulsoft.as(l).startCap,u=h.stimulsoft.as(l).endCap),null!=w){var S=this.capStyleToPptStyle(w.style);A.isNullOrEmpty(S)||(t.writeStartElement("a:headEnd"),t.writeAttributeString("type",S),t.writeEndElement())}if(null!=u){var S=this.capStyleToPptStyle(u.style);A.isNullOrEmpty(S)||(t.writeStartElement("a:tailEnd"),t.writeAttributeString("type",S),t.writeEndElement())}}t.writeFullEndElement(),t.writeEndElement(),t.writeEndElement()},D.prototype.capStyleToPptStyle=function(t){switch(t){case s.Arrow:return"triangle";case s.Diamond:return"diamond";case s.Square:return"diamond";case s.Open:return"arrow";case s.Oval:return"oval";case s.Stealth:return"stealth"}return null},D.prototype.writeWatermark=function(t,e,r){if(null!=e.watermark&&(null!=e.watermark.image||!A.isNullOrWhiteSpace(e.watermark.imageHyperlink))&&e.watermark.showImageBehind==r){var i=new o;i.page=e,i.image=e.watermark.image,i.left=-e.margins.left,i.top=-e.margins.top,i.width=e.pageWidth,i.height=e.pageHeight,e.watermark.imageStretch&&(i.stretch=!0),i.vertAlignment=StiVertAlignment.Center,i.horAlignment=a.Center,this.writeStiImage(t,i)}},D.prototype.writeHyperlinkInfo=function(t,e){if(null!=e.hyperlinkValue){var r=e.hyperlinkValue.toString().trim(),i=void 0;if(r.length>0&&!r.stimulsoft.startsWith("javascript:"))if(r.stimulsoft.startsWith("#"));else{var n=this.stringToUrl(r);-1==(i=this.hyperlinkList.indexOf(n))&&(this.hyperlinkList.push(n),i=this.hyperlinkList.stimulsoft.countItems),t.writeStartElement("a:hlinkClick"),t.writeAttributeString("r:id",A.format("hId{0}",i)),t.writeEndElement()}}},D.prototype.writeImage=function(t){var e=new R,r=this.imageCache.imagePackedStore.stimulsoft.getByIndex(t);return e.write(r,0,r.length),e},D.prototype.exportPowerPoint=function(r,i,o){e.StiLogService.write(this.stimulsoft.getType(),"Export report to PowerPoint 2007 format");var a=o.pageRange;this.imageResolution=o.imageResolution,this.imageQuality=o.imageQuality,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=P.currentCulture,this.newCulture=P.cultures["en-US"];try{P.currentCulture=this.newCulture;var s=a.getSelectedPages(r.renderedPages);if(this.isStopped)return;this.imageCache=new e.StiImageCache(t["StiOptions"].Export.PowerPoint.AllowImageComparer,!0,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?e.ImageFormat.Png:e.ImageFormat.Jpeg,this.imageQuality);var l=new n;l.begin(i,!0),l.addFile("[Content_Types].xml",this.writeContentTypes(s.count)),l.addFile("_rels/.rels",this.writeMainRels()),l.addFile("docProps/app.xml",this.writeDocPropsApp(s.count)),l.addFile("docProps/core.xml",this.writeDocPropsCore()),l.addFile("ppt/tableStyles.xml",this.writeTableStyles()),l.addFile("ppt/presProps.xml",this.writePresProps()),l.addFile("ppt/viewProps.xml",this.writeViewProps()),l.addFile("ppt/theme/theme1.xml",this.writeTheme()),l.addFile("ppt/slideMasters/slideMaster1.xml",this.writeSlideMaster()),l.addFile("ppt/slideMasters/_rels/slideMaster1.xml.rels",this.writeSlideMasterRels());for(var m=0;m<11;m++)l.addFile(A.format("ppt/slideLayouts/slideLayout{0}.xml",m+1),this.writeSlideLayout(m+1,s.getByIndex(0))),l.addFile(A.format("ppt/slideLayouts/_rels/slideLayout{0}.xml.rels",m+1),this.writeSlideLayoutRels());l.addFile("ppt/presentation.xml",this.writePresentation(s)),l.addFile("ppt/_rels/presentation.xml.rels",this.writePresentationRels(s)),this.imageListOffset=0,this.hyperlinkList=[];for(var c=0;c<s.count;c++){if(this.invokeExporting2(c,s.count,0,1),this.isStopped)return;var p=s.getByIndex(c);s.getPage(p),l.addFile(A.format("ppt/slides/slide{0}.xml",c+1),this.writeSlide(c,s)),l.addFile(A.format("ppt/slides/_rels/slide{0}.xml.rels",c+1),this.writeSlideRels(c)),this.imageListOffset=this.imageCache.imageIndex.stimulsoft.countItems,this.hyperlinkList.stimulsoft.clear()}if(this.imageCache.imagePackedStore.stimulsoft.countItems>0)for(var m=0;m<this.imageCache.imagePackedStore.stimulsoft.countItems;m++)l.addFile(A.format("ppt/media/image{0:D5}.{1}",m+1,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg"),this.writeImage(m));l.end()}finally{P.currentCulture=this.currentCulture,this.imageCache.clear(),this.hyperlinkList=null}},D}(r.StiExportService);r.StiPpt2007ExportService=I}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.System.StiArray,n=t.System.StiString,o=t.System.Xml.Formatting,a=t.System.Text.Encoding,s=t.System.DateTime,l=t.Base.Zip.StiZipWriter20,m=t.System.IO.MemoryStream,c=t.Report.Components.StiPageOrientation,p=t.Report.Components.StiPagesCollection,g=t.Base.Drawing.StiBorderSides,h=t.Base.Drawing.StiVertAlignment,w=t.Report.Components.StiRichText,u=t.Report.Components.StiText,d=t.System.Xml.XmlTextWriter,S=t.System.Char,f=t.System.Text.StringBuilder,v=t.Base.Drawing.StiBrush,E=t.Report.Components.IStiFont,b=t.Report.Components.IStiTextBrush,y=t.Report.Components.IStiTextHorAlignment,x=t.Report.Components.IStiTextOptions,A=t.Base.Drawing.StiPenStyle,T=t.System.Collections.Hashtable,P=t.Base.Drawing.StiTextHorAlignment,L=t.Base.Localization.StiLocalization,C=t.Report.Components.IStiHorAlignment,F=t.Base.Drawing.StiHtmlTagsState,B=t.Base.Drawing.StiHtmlState,k=t.Report.Components.IStiExportImageExtended,R=function(){function t(){}return t}(),I=function(I){function D(){var e=null!==I&&I.apply(this,arguments)||this;return e._matrix=null,e._removeEmptySpaceAtBottom=t["StiOptions"].Export.Word.removeEmptySpaceAtBottom,e.fontList=null,e.styleList=null,e.imageCache=null,e.bookmarkList=null,e.hyperlinkList=null,e.embedsList=null,e.xmlIndentation=1,e.imageQuality=.75,e.imageResolution=96,e.lineSpace=null,e.lineSpace2=null,e.usePageHeadersAndFooters=!1,e.restrictEditing=r.StiWord2007RestrictEditing.No,e.headersData=null,e.headersRels=null,e.footersData=null,e.footersRels=null,e.docCompanyString=null,e.docLastModifiedString=null,e.wrongUrlSymbols=" \"#'*,;<>[^`{|}",e}return __extends(D,I),D.prototype.implements=function(){return[r.IStiWord2007ExportService]},Object.defineProperty(D.prototype,"defaultExtension",{get:function(){return"docx"},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Word2007},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"position",{get:function(){return r.StiExportPosition.Word2007},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"exportNameInMenu",{get:function(){return L.get("Export","ExportTypeWord2007File")},enumerable:!1,configurable:!0}),D.prototype.exportTo=function(t,e,r){this.exportWord(t,e,r)},D.prototype.exportToAsync=function(e,r,i,n){var o=this;t.Report.Export.StiExportImageHelper.convertAllImages(r,t.System.Drawing.Imaging.ImageFormat.Jpeg).try((function(){o.exportTo(r,i,n),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null),e()}))},Object.defineProperty(D.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),D.prototype.getFilter=function(){return L.get("FileFilters","Word2007Files")},Object.defineProperty(D.prototype,"matrix",{get:function(){return this._matrix},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"removeEmptySpaceAtBottom",{get:function(){return this._removeEmptySpaceAtBottom},enumerable:!1,configurable:!0}),D.prototype.checkFontsToCorrectHeight=function(t){return"Arial Unicode MS"==t||"Microsoft YaHei"==t},D.prototype.getLineStyle=function(t){switch(t){case A.Solid:return"single";case A.Dot:return"dotted";case A.Dash:return"dashSmallGap";case A.DashDot:return"dotDash";case A.DashDotDot:return"dotDotDash";case A.Double:return"double";default:return""}},D.prototype.getColorString=function(t){if(0==t.a)return"auto";if(t.a<32)return"FFFFFF";return n.format("{0:X8}",t.toArgb()).substr(2)},D.prototype.getStyleNumber=function(t,e){if(t.length>0)for(var r=0;r<t.length;r++){var i=t[r];if(i.alignment==e.alignment&&i.name==e.name&&i.fontName==e.fontName&&i.fontSize==e.fontSize&&i.bold==e.bold&&i.italic==e.italic&&i.underline==e.underline&&i.textColor.equals(e.textColor)&&i.rightToLeft==e.rightToLeft)return r}var n;return t.push(e),t.length-1},D.prototype.getStyleFromComponent=function(t){if(null!=t&&!n.isNullOrEmpty(t.componentStyle)){var e=t.stimulsoft.as(E),r=t.stimulsoft.as(b),i=t.stimulsoft.as(y),o=t.stimulsoft.as(x),a=new R;return a.name=t.componentStyle,null!=e&&(a.fontName=e.font.name,a.fontSize=Math.round2(2*e.font.sizeInPoints,0),a.bold=e.font.bold,a.italic=e.font.italic,a.underline=e.font.underline),null!=r&&(a.textColor=v.toColor(r.textBrush)),null!=i&&(a.alignment=i.horAlignment),null!=o&&(a.rightToLeft=o.textOptions.rightToLeft),this.getStyleNumber(this.styleList,a)}return-1},D.prototype.stringToUrl=function(t){var e,r,i,o;if(n.isNullOrEmpty(t))return"";var a=new f;if(t.stimulsoft.startsWith("file:"))try{for(var s=__values(t.split("")),l=s.next();!l.done;l=s.next()){var m;(m=l.value).charCodeAt(0)<32||'"'==m?a.append(n.format("%{0:x2}",m)):a.append(m)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}else try{for(var c=__values(t.split("")),p=c.next();!p.done;p=c.next()){var m;(m=p.value).charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(m)?a.append("_"):a.append(m)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return a.toString()},Object.defineProperty(D,"hiToTwips",{get:function(){return 14.4*.995},enumerable:!1,configurable:!0}),D.prototype.convert=function(t){return Math.round2(t*D.hiToTwips)},D.prototype.convertHiToTwips=function(t){return Math.round2(14.4*t)},D.prototype.convertTwipsToEmu=function(t){return Math.round2(t/D.hiToTwips/100*914400)},D.prototype.convertStringToBookmark=function(t){var e,r,i=new f;try{for(var n=__values(t.split("")),o=n.next();!o.done;o=n.next()){var a=o.value;S.isLetterOrDigit(a)&&i.append(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return i.length>0&&null!=i.toString()[0]&&S.isDigit(i.toString()[0])&&i.insert(0,"b"),i.toString()},D.prototype.writeFromMatrix=function(o,a,s,l){for(var m,c,p=this.matrix.coordX.countItems,d=this.matrix.coordY.countItems,S=i.create(Number,p),f=this.matrix.coordX.getKeys(),v=0;v<p;v++){var E=this.matrix.coordX.getByIndex(v,f);S[v]=this.convert(E)}for(var b=i.create(Number,d),y=this.matrix.coordY.getKeys(),x=0;x<d;x++){var A=this.matrix.coordY.getByIndex(x,y);b[x]=this.convert(A)}var T=!1,P=0,L=i.create2(Boolean,d,p),C=i.create2(Boolean,d,p),F="";this.currentPassNumber=2+(t["StiOptions"].Export.Word.divideSegmentPages?1:0);for(var x=1;x<d;x++){this.invokeExporting2(x,d,this.currentPassNumber,this.maximumPassNumber);var B=x-1>=a&&x-1<=s;0==l&&(this.matrix.linePlacement[x-1]!=r.StiTableLineInfo.PageHeader&&this.matrix.linePlacement[x-1]!=r.StiTableLineInfo.PageFooter&&this.matrix.linePlacement[x-1]!=r.StiTableLineInfo.Trash||(B=!1)),P>0&&(P--,B=!1);var k=100005,R=[],I=!1;if(B)for(var N=1;N<p;N++){var O=this.matrix.cells[x-1][N-1];if(0==L[x][N]&&null!=O&&null!=O.component){if(null!=O.component.tagValue){var H=O.component.tagValue.toString().toLowerCase();-1!=H.indexOf("rtfparagraph")&&(R.push(O),B=!1),-1!=H.indexOf("rtfnewpage")&&(I=!0)}var M=null;O.component.stimulsoft.is(u)&&(M=O.component.margins),O.component.stimulsoft.is(w)&&(M=O.component.margins),null!=M&&(M.top<k&&(k=M.top),O.height>0&&(k=0))}}k*=D.hiToTwips;var W=Math.round2(k);if(I&&(T&&(o.writeFullEndElement(),T=!1),o.writeStartElement("w:p"),o.writeStartElement("w:r"),o.writeStartElement("w:br"),o.writeAttributeString("w:type","page"),o.writeEndElement(),o.writeEndElement(),o.writeEndElement()),B){if(this.usePageHeadersAndFooters&&this.matrix.linePlacement[x-1]==r.StiTableLineInfo.HeaderAP){var U=this.matrix.parentBandName[x-1],X=U.indexOf("");-1!=X&&(U=U.substr(0,X)),U!=F&&(F=U,T&&o.writeFullEndElement(),o.writeStartElement("w:p"),o.writeEndElement(),o.writeStartElement("w:tbl"),this.writeTableInfo(o,S,p),T=!0)}T||(o.writeStartElement("w:tbl"),this.writeTableInfo(o,S,p),T=!0),o.writeStartElement("w:tr");var z=b[x]-b[x-1];o.writeStartElement("w:trPr"),this.usePageHeadersAndFooters&&!t["StiOptions"].Export.Word.forceLineHeight||(o.writeStartElement("w:trHeight"),(!this.usePageHeadersAndFooters&&t["StiOptions"].Export.Word.lineHeightExactly||this.usePageHeadersAndFooters&&t["StiOptions"].Export.Word.lineHeightExactlyForPHFMode)&&o.writeAttributeString("w:hRule","exact"),o.writeAttributeString("w:val",n.format("{0}",z)),o.writeEndElement()),this.usePageHeadersAndFooters&&this.matrix.linePlacement[x-1]==r.StiTableLineInfo.HeaderAP&&(o.writeStartElement("w:tblHeader"),o.writeEndElement()),o.writeEndElement()}for(var V=0,v=1;v<p;v++){var O=this.matrix.cells[x-1][v-1];if(!L[x][v]||C[x][v]){V++;var G=!0;if(C[x][v]){var Y=x;while(C[Y][v])Y--;O=this.matrix.cells[Y-1][v-1],G=!1}if(null!=O&&G){for(var j=0;j<=O.height;j++)for(var _=0;_<=O.width;_++)L[x+j][v+_]=!0;if(O.height>0)for(var j=1;j<=O.height;j++)C[x+j][v]=!0}if(B){if(o.writeStartElement("w:tc"),null!=O){o.writeStartElement("w:tcPr");for(var q=0,K=0;K<O.width+1;K++)q+=S[v+K]-S[v-1+K];if(o.writeStartElement("w:tcW"),o.writeAttributeString("w:w",n.format("{0}",q)),o.writeAttributeString("w:type","dxa"),o.writeEndElement(),O.width>0&&(o.writeStartElement("w:gridSpan"),o.writeAttributeString("w:val",n.format("{0}",O.width+1)),o.writeEndElement()),O.height>0&&(C[x][v]?(o.writeStartElement("w:vMerge"),o.writeEndElement()):(o.writeStartElement("w:vMerge"),o.writeAttributeString("w:val","restart"),o.writeEndElement())),null!=O.cellStyle.textOptions){var Q=O.cellStyle.textOptions.angle,J="";Q>45&&Q<135&&(J="btLr"),Q>225&&Q<315&&(J="tbRl"),""!=J&&(o.writeStartElement("w:textDirection"),o.writeAttributeString("w:val",J),o.writeEndElement())}var Z=O.component.stimulsoft.is(u)&&O.component.checkAllowHtmlTags()&&!t["StiOptions"].Export.Word.renderHtmlTagsAsImage;if(G&&O.component.stimulsoft.is(u)&&(!O.component.isExportAsImage(e.StiExportFormat.Word2007)||Z)){var $=O.component,tt=this.convert($.margins.left),et=this.convert($.margins.right-t["StiOptions"].Export.Word.rightMarginCorrection),rt=this.convert($.margins.top);rt>W&&(rt=W),(tt>0||et>0||rt>0)&&(o.writeStartElement("w:tcMar"),rt>0&&(o.writeStartElement("w:top"),o.writeAttributeString("w:w",n.format("{0}",rt)),o.writeAttributeString("w:type","dxa"),o.writeEndElement()),tt>0&&(o.writeStartElement("w:left"),o.writeAttributeString("w:w",n.format("{0}",tt)),o.writeAttributeString("w:type","dxa"),o.writeEndElement()),et>0&&(o.writeStartElement("w:right"),o.writeAttributeString("w:w",n.format("{0}",et)),o.writeAttributeString("w:type","dxa"),o.writeEndElement()),o.writeEndElement())}var it="";switch(O.cellStyle.vertAlignment){case h.Center:it="center";break;case h.Bottom:it="bottom";break}""!=it&&(o.writeStartElement("w:vAlign"),o.writeAttributeString("w:val",it),o.writeEndElement()),this.writeBorders(o,O.top,O.left,O.height+1,O.width+1),O.component.isExportAsImage(e.StiExportFormat.Word2007)||(o.writeStartElement("w:shd"),o.writeAttributeString("w:val","clear"),o.writeAttributeString("w:color","auto"),o.writeAttributeString("w:fill",this.getColorString(O.cellStyle.color)),o.writeEndElement()),o.writeEndElement();var nt=this.restrictEditing==r.StiWord2007RestrictEditing.ExceptEditableFields&&null!=O.component&&O.component.stimulsoft.is(u)&&O.component.editable;nt&&(o.writeStartElement("w:permStart"),o.writeAttributeString("w:id","0"),o.writeEndElement());var ot=!0;if(G){var at={ref:ot};this.writeCellContent(o,O,at,x,v,S,b),ot=at.ref}ot&&(o.writeStartElement("w:p"),o.writeFullEndElement()),nt&&(o.writeStartElement("w:permEnd"),o.writeAttributeString("w:id","0"),o.writeEndElement())}else{var st=null,lt={ref:st},mt=this.renderBorder2TableGetValues(x,v,lt),ct=0;if(0==(mt&g.Right)){while(v+ct+1<p&&null==this.matrix.cells[x-1][v+ct+1-1]&&0==L[x][v+ct+1]&&0==C[x][v+ct+1]){var pt=null,gt={ref:pt},ht=this.renderBorder2TableGetValues(x,v+ct+1,gt);if((ht&g.Left)>0)break;if((ht&(g.Top|g.Bottom))!=(mt&(g.Top|g.Bottom)))break;if(st!=pt)break;if(ct++,(ht&g.Right)>0)break}if(ct>0)for(var _=1;_<=ct;_++)L[x][v+_]=!0}o.writeStartElement("w:tcPr");var q=S[v+ct]-S[v-1];o.writeStartElement("w:tcW"),o.writeAttributeString("w:w",n.format("{0}",q)),o.writeAttributeString("w:type","dxa"),o.writeEndElement(),ct>0&&(o.writeStartElement("w:gridSpan"),o.writeAttributeString("w:val",n.format("{0}",ct+1)),o.writeEndElement()),this.writeBorders(o,x-1,v-1,1,ct+1),o.writeEndElement(),o.writeStartElement("w:p"),o.writeFullEndElement()}o.writeFullEndElement()}}if(V>=64)break}B&&o.writeFullEndElement();try{for(var wt=(m=void 0,__values(R)),ut=wt.next();!ut.done;ut=wt.next()){var dt=ut.value;T&&o.writeEndElement(),T=!1,P=dt.height;var St=!1,ft={ref:St};this.writeCellContent(o,dt,ft,dt.top+1,dt.left+1,S,b),St=ft.ref}}catch(t){m={error:t}}finally{try{ut&&!ut.done&&(c=wt.return)&&c.call(wt)}finally{if(m)throw m.error}}}T&&o.writeEndElement()},D.prototype.writeCellContent=function(r,i,o,a,s,l,m){var c,p,g,h,d=o.ref,v=null,b=-1,x=this.matrix.bookmarks[a-1][s-1];null==x||this.bookmarkList.containsKey(x)||(b=this.bookmarkList.count,v=this.convertStringToBookmark(x),this.bookmarkList.set(x,b));var A=null,T=-1;if(null!=i.component&&null!=i.component.hyperlinkValue){var L=i.component.hyperlinkValue.toString().trim();L.length>0&&!L.stimulsoft.startsWith("javascript:")&&(L.stimulsoft.startsWith("#")?A=this.convertStringToBookmark(L.substr(1)):(A=this.stringToUrl(L),this.hyperlinkList.containsKey(A)?T=Math.trunc(this.hyperlinkList.get(A)):(T=this.hyperlinkList.count,this.hyperlinkList.add(A,T))))}if(!i.component.stimulsoft.is(u)||i.component.isExportAsImage(e.StiExportFormat.Word2007)||i.component.checkAllowHtmlTags())if(i.component.stimulsoft.is(w)&&!t["StiOptions"].Export.Word.renderRichTextAsImage)var F=i.component;else if(i.component.stimulsoft.is(u)&&i.component.checkAllowHtmlTags()&&!t["StiOptions"].Export.Word.renderHtmlTagsAsImage)n.isNullOrWhiteSpace(i.text)||this.writeHtmlTags(r,i);else if(i.component.isExportAsImage(e.StiExportFormat.Word2007)){var B=i.component.stimulsoft.as(k);if(null!=B){var R=this.imageResolution,I={ref:R},D=B.getImage(I);if(R=I.ref,null!=D){var N=this.matrix.getRealImageData(i,D);d=!1;var O=0;O=null!=N?this.imageCache.addImageIntRaw(N,N.imageFormat):this.imageCache.addImageIntRaw(D,D.imageFormat);var H=-1,M=-1;r.writeStartElement("w:p"),r.writeStartElement("w:pPr");var W=i.cellStyle.horAlignment,U=!1;if(null!=i.cellStyle.textOptions&&(U=i.cellStyle.textOptions.rightToLeft),null==i.component.stimulsoft.as(y))var X=i.component.stimulsoft.as(C);var z="";(W==P.Left&&1==U||W==P.Right&&0==U)&&(z="right"),W==P.Center&&(z="center"),W==P.Width&&(z="both"),""!=z&&(r.writeStartElement("w:jc"),r.writeAttributeString("w:val",z),r.writeEndElement()),r.writeEndElement(),-1!=b&&(r.writeStartElement("w:bookmarkStart"),r.writeAttributeString("w:id",b.toString()),r.writeAttributeString("w:name",v),r.writeEndElement()),r.writeStartElement("w:r"),r.writeStartElement("w:rPr"),r.writeElementString("w:noProof",""),r.writeEndElement(),r.writeStartElement("w:drawing"),r.writeStartElement("wp:inline"),r.writeAttributeString("distT","0"),r.writeAttributeString("distB","0"),r.writeAttributeString("distL","0"),r.writeAttributeString("distR","0");var V=m[a-1+i.height+1]-m[a-1],G=l[s-1+i.width+1]-l[s-1];-1!=H&&(G=H,V=M),r.writeStartElement("wp:extent"),r.writeAttributeString("cx",n.format("{0}",this.convertTwipsToEmu(G))),r.writeAttributeString("cy",n.format("{0}",this.convertTwipsToEmu(V))),r.writeEndElement(),r.writeStartElement("wp:effectExtent"),r.writeAttributeString("l","0"),r.writeAttributeString("t","0"),r.writeAttributeString("r","0"),r.writeAttributeString("b","0"),r.writeEndElement(),r.writeStartElement("wp:docPr"),r.writeAttributeString("id",n.format("{0}",O+2)),r.writeAttributeString("name",n.format("Picture {0}",O+1)),r.writeAttributeString("descr",n.format("Image{0:D5}.jpg",O+1)),null!=A&&(-1==T&&(A="#"+A,this.hyperlinkList.containsKey(A)?T=this.hyperlinkList.get(A):(T=this.hyperlinkList.count,this.hyperlinkList.add(A,T))),r.writeStartElement("a:hlinkClick"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),r.writeAttributeString("r:id",n.format("hId{0}",T)),r.writeEndElement()),r.writeEndElement(),r.writeStartElement("wp:cNvGraphicFramePr"),r.writeStartElement("a:graphicFrameLocks"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),r.writeAttributeString("noChangeAspect","1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:graphic"),r.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),r.writeStartElement("a:graphicData"),r.writeAttributeString("uri","http://schemas.openxmlformats.org/drawingml/2006/picture"),r.writeStartElement("pic:pic"),r.writeAttributeString("xmlns:pic","http://schemas.openxmlformats.org/drawingml/2006/picture"),r.writeStartElement("pic:nvPicPr"),r.writeStartElement("pic:cNvPr"),r.writeAttributeString("id","0"),r.writeAttributeString("name",n.format("Image{0:D5}.jpg",O+1)),r.writeEndElement(),r.writeStartElement("pic:cNvPicPr"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("pic:blipFill"),r.writeStartElement("a:blip"),r.writeAttributeString("r:embed",n.format("rId{0}",5+O)),r.writeAttributeString("cstate","print"),r.writeEndElement(),r.writeStartElement("a:stretch"),r.writeStartElement("a:fillRect"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("pic:spPr"),r.writeStartElement("a:xfrm"),r.writeStartElement("a:off"),r.writeAttributeString("x","0"),r.writeAttributeString("y","0"),r.writeEndElement(),r.writeStartElement("a:ext"),r.writeAttributeString("cx",n.format("{0}",this.convertTwipsToEmu(G))),r.writeAttributeString("cy",n.format("{0}",this.convertTwipsToEmu(V))),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("a:prstGeom"),r.writeAttributeString("prst","rect"),r.writeStartElement("a:avLst"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),-1!=b&&(r.writeStartElement("w:bookmarkEnd"),r.writeAttributeString("w:id",b.toString()),r.writeEndElement()),r.writeEndElement()}}}else-1!=b&&(r.writeStartElement("w:bookmarkStart"),r.writeAttributeString("w:id",b.toString()),r.writeAttributeString("w:name",v),r.writeEndElement(),r.writeStartElement("w:bookmarkEnd"),r.writeAttributeString("w:id",b.toString()),r.writeEndElement());else{var Y=new f(i.text);if(this.usePageHeadersAndFooters){var j=i.component.tagValue;n.isNullOrEmpty(j)||-1!=j.toLowerCase().indexOf("rtfnewpage")||-1==j.indexOf("#PageNumber#")&&-1==j.indexOf("#TotalPageCount#")&&-1==j.indexOf("#PageRef")||(Y=new f(j))}var _=[],q="";try{for(var K=__values(Y.toString().split("")),Q=K.next();!Q.done;Q=K.next()){var J=Q.value;S.isControl(J)&&"\t"!=J?"\n"==J&&(_.push(q),q=""):q+=J}}catch(t){c={error:t}}finally{try{Q&&!Q.done&&(p=K.return)&&p.call(K)}finally{if(c)throw c.error}}""!=q&&_.push(q),0==_.length&&_.push(q),_.length>0&&(d=!1);for(var Z=this.getStyleFromComponent(i.component),$=0;$<_.length;$++){var tt=_[$];r.writeStartElement("w:p"),r.writeStartElement("w:pPr");var et=i.component.stimulsoft.as(u).lineSpacing;if(null!=this.lineSpace||1!=et){var rt=this.lineSpace;1!=et&&(rt=Math.round2(240*t["StiOptions"].Export.Word.lineSpacing*et).toString());var it=i.component.stimulsoft.as(E);null!=it&&null!=it.font&&this.checkFontsToCorrectHeight(it.font.name)&&(rt=this.lineSpace2,1!=et&&(rt=Math.round2(240*t["StiOptions"].Export.Word.lineSpacing*.772*et).toString())),r.writeStartElement("w:spacing"),r.writeAttributeString("w:line",rt),r.writeEndElement()}-1!=Z&&(r.writeStartElement("w:pStyle"),r.writeAttributeString("w:val",n.format("Style{0}",Z)),r.writeEndElement());var W=i.cellStyle.horAlignment,U=!1;null!=i.cellStyle.textOptions&&(U=i.cellStyle.textOptions.rightToLeft);var z="";if((W==P.Left&&1==U||W==P.Right&&0==U)&&(z="right"),W==P.Center&&(z="center"),W==P.Width&&(z="both"),""!=z&&(r.writeStartElement("w:jc"),r.writeAttributeString("w:val",z),r.writeEndElement()),-1==Z&&this.writeRunProperties(r,i),r.writeEndElement(),null!=A&&(r.writeStartElement("w:hyperlink"),-1==T?r.writeAttributeString("w:anchor",A):r.writeAttributeString("r:id",n.format("hId{0}",T))),-1!=b&&(r.writeStartElement("w:bookmarkStart"),r.writeAttributeString("w:id",b.toString()),r.writeAttributeString("w:name",v),r.writeEndElement()),""!=tt)if(this.usePageHeadersAndFooters){tt=tt.stimulsoft.replaceAll("#PageNumber#","").stimulsoft.replaceAll("#TotalPageCount#","");var nt=[],ot=new f;try{for(var at=(g=void 0,__values(tt.split(""))),st=at.next();!st.done;st=at.next()){var J;""==(J=st.value)||""==J?(ot.length>0&&nt.push(ot.toString()),nt.push(J.toString()),ot=new f):ot.append(J)}}catch(t){g={error:t}}finally{try{st&&!st.done&&(h=at.return)&&h.call(at)}finally{if(g)throw g.error}}ot.length>0&&nt.push(ot.toString()),0==nt.length&&nt.push(tt);for(var lt=0;lt<nt.length;lt++){var mt=nt[lt];if(mt.length>0&&(""==mt[0]||""==mt[0])){switch(r.writeStartElement("w:r"),-1==Z&&this.writeRunProperties(r,i),r.writeStartElement("w:fldChar"),r.writeAttributeString("w:fldCharType","begin"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("w:r"),this.writeRunProperties(r,i),r.writeStartElement("w:instrText"),mt.charAt(0)){case"":r.writeString("PAGE");break;case"":r.writeString("NUMPAGES");break}r.writeEndElement(),r.writeEndElement(),r.writeStartElement("w:r"),this.writeRunProperties(r,i),r.writeStartElement("w:fldChar"),r.writeAttributeString("w:fldCharType","end"),r.writeEndElement(),r.writeEndElement()}else r.writeStartElement("w:r"),-1==Z&&this.writeRunProperties(r,i),r.writeStartElement("w:t"),r.writeAttributeString("xml:space","preserve"),r.writeString(mt),r.writeEndElement(),r.writeEndElement()}}else r.writeStartElement("w:r"),-1==Z&&this.writeRunProperties(r,i),r.writeStartElement("w:t"),r.writeAttributeString("xml:space","preserve"),r.writeString(tt),r.writeEndElement(),r.writeEndElement();-1!=b&&(r.writeStartElement("w:bookmarkEnd"),r.writeAttributeString("w:id",b.toString()),r.writeEndElement()),null!=A&&r.writeEndElement(),r.writeEndElement()}}o.ref=d},D.prototype.writeTableInfo=function(t,e,r){t.writeStartElement("w:tblPr"),t.writeStartElement("w:tblStyle"),t.writeAttributeString("w:val","a1"),t.writeEndElement(),t.writeStartElement("w:tblW"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:tblLayout"),t.writeAttributeString("w:type","fixed"),t.writeEndElement(),t.writeStartElement("w:tblCellMar"),t.writeStartElement("w:top"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:left"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:bottom"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:right"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:tblLook"),t.writeAttributeString("w:val","04A0"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:tblGrid");for(var i=1;i<r;i++){var o=e[i]-e[i-1];t.writeStartElement("w:gridCol"),t.writeAttributeString("w:w",n.format("{0}",o)),t.writeEndElement()}t.writeFullEndElement()},D.prototype.writeHtmlTags=function(e,r){var i=r.component,n=r.text,o=new F(i.font.bold,i.font.italic,i.font.underline,i.font.strikeout,i.font.sizeInPoints,i.font.name,v.toColor(i.textBrush),v.toColor(i.brush),!1,!1,0,0,i.lineSpacing,i.horAlignment),a=new B(o,0),s=t.Base.Drawing.StiTextRenderer.parseHtmlToStates(n,a),l=this.getStyleFromComponent(r.component);this.writeParagraphBegin(e,r,l,s,0);for(var m=0;m<s.length;m++){var c=s[m],p=c.ts;if("\n"==c.text.toString()&&m<s.stimulsoft.countItems-1){e.writeEndElement(),this.writeParagraphBegin(e,r,l,s,m+1);continue}e.writeStartElement("w:r"),e.writeStartElement("w:rPr"),p.bold&&(e.writeStartElement("w:b"),e.writeEndElement()),p.italic&&(e.writeStartElement("w:i"),e.writeEndElement()),p.underline&&(e.writeStartElement("w:u"),e.writeAttributeString("w:val","single"),e.writeEndElement()),p.strikeout&&(e.writeStartElement("w:strike"),e.writeEndElement()),p.superscript&&(e.writeStartElement("w:vertAlign"),e.writeAttributeString("w:val","superscript"),e.writeEndElement()),p.subsript&&(e.writeStartElement("w:vertAlign"),e.writeAttributeString("w:val","subscript"),e.writeEndElement()),p.fontColor.toArgb()!=o.fontColor.toArgb()&&(e.writeStartElement("w:color"),e.writeAttributeString("w:val",this.getColorString(p.fontColor)),e.writeEndElement()),p.backColor.toArgb()!=o.backColor.toArgb()&&(e.writeStartElement("w:shd"),e.writeAttributeString("w:val","clear"),e.writeAttributeString("w:color","auto"),e.writeAttributeString("w:fill",this.getColorString(p.backColor)),e.writeEndElement()),e.writeStartElement("w:sz"),e.writeAttributeString("w:val",(2*p.fontSize).toString()),e.writeEndElement(),e.writeStartElement("w:szCs"),e.writeAttributeString("w:val",(2*p.fontSize).toString()),e.writeEndElement(),e.writeStartElement("w:rFonts");var g=p.fontName;this.fontList.set(g,g),e.writeAttributeString("w:ascii",g),e.writeAttributeString("w:hAnsi",g),e.writeAttributeString("w:eastAsia",g),e.writeAttributeString("w:cs",g),e.writeEndElement();var h=p.letterSpacing*p.fontSize*18.8+t["StiOptions"].Export.Word.spaceBetweenCharacters;0!=h&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:val",h.toString()),e.writeEndElement()),null!=r.cellStyle.textOptions&&r.cellStyle.textOptions.rightToLeft&&(e.writeStartElement("w:rtl"),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w:t"),e.writeAttributeString("xml:space","preserve"),e.writeString(t.Base.Drawing.StiTextRenderer.prepareStateText(c.text).toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},D.prototype.writeParagraphBegin=function(e,r,i,o,a){e.writeStartElement("w:p"),e.writeStartElement("w:pPr"),-1!=i?(e.writeStartElement("w:pStyle"),e.writeAttributeString("w:val",n.format("Style{0}",i)),e.writeEndElement()):this.writeRunProperties(e,r);var s=o[a];if("\n"!=s.text.toString()){var l=a+1;while(l<o.length&&"\n"!=o[l].text.toString())s=o[l],l++}var m=t["StiOptions"].Export.Word.lineSpacing*s.ts.lineHeight;this.checkFontsToCorrectHeight(s.ts.fontName)&&(m*=.772),1!=m&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:line",Math.round2(240*m).toString()),e.writeEndElement());var c=null;s.ts.textAlign==P.Center&&(c="center"),s.ts.textAlign==P.Right&&(c="right"),s.ts.textAlign==P.Width&&(c="both"),null!=c&&(e.writeStartElement("w:jc"),e.writeAttributeString("w:val",c),e.writeEndElement()),e.writeEndElement()},D.prototype.writeRunProperties=function(e,r){e.writeStartElement("w:rPr"),e.writeStartElement("w:rFonts");var i=r.cellStyle.font.name;this.fontList.set(i,i),e.writeAttributeString("w:ascii",i),e.writeAttributeString("w:hAnsi",i),e.writeAttributeString("w:eastAsia",i),e.writeAttributeString("w:cs",i),e.writeEndElement(),r.cellStyle.font.bold&&(e.writeStartElement("w:b"),e.writeEndElement()),r.cellStyle.font.italic&&(e.writeStartElement("w:i"),e.writeEndElement()),r.cellStyle.font.underline&&(e.writeStartElement("w:u"),e.writeAttributeString("w:val","single"),e.writeEndElement()),e.writeStartElement("w:color"),e.writeAttributeString("w:val",this.getColorString(r.cellStyle.textColor)),e.writeEndElement(),e.writeStartElement("w:sz"),e.writeAttributeString("w:val",n.format("{0}",2*r.cellStyle.font.sizeInPoints)),e.writeEndElement(),0!=t["StiOptions"].Export.Word.spaceBetweenCharacters&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:val",n.format("{0}",t["StiOptions"].Export.Word.spaceBetweenCharacters)),e.writeEndElement()),null!=r.cellStyle.textOptions&&r.cellStyle.textOptions.rightToLeft&&(r.cellStyle.font.bold&&(e.writeStartElement("w:bCs"),e.writeEndElement()),r.cellStyle.font.italic&&(e.writeStartElement("w:iCs"),e.writeEndElement()),e.writeStartElement("w:szCs"),e.writeAttributeString("w:val",n.format("{0}",2*r.cellStyle.font.sizeInPoints)),e.writeEndElement(),e.writeStartElement("w:rtl"),e.writeEndElement()),e.writeEndElement()},D.prototype.renderBorder2TableGetValues=function(t,e,r){var i=r.ref,n=g.None,o=new f;return null!=this.matrix.bordersY[t-1][e-1]&&(n|=g.Left),null!=this.matrix.bordersY[t-1][e-1+1]&&(n|=g.Right),null!=this.matrix.bordersX[t-1][e-1]&&(o.append("\\t"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1][e-1])),n|=g.Top),null!=this.matrix.bordersX[t-1+1][e-1]&&(o.append("\\b"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1+1][e-1])),n|=g.Bottom),i=o.toString(),r.ref=i,n},D.prototype.getLineStyle2TableGetValues=function(t){var e=new f;return e.append(this.getLineStyle(t.style)),e.append(Math.trunc(15*t.size)),e.append(n.format("c{0}",this.getColorString(t.color))),e.toString()},D.prototype.writeDocument=function(e,i,n){var s=new m,l=new d(a.UTF8,s);l.indentation=this.xmlIndentation<0?0:this.xmlIndentation,l.formatting=this.xmlIndentation<0?o.None:o.Indented,l.writeStartDocument(),l.writeStartElement("w:document"),l.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),l.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),l.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),l.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),l.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),l.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),l.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),l.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),l.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),l.writeStartElement("w:body");var c=e;e=null;var g=0,h=0;while(g<c.count){(e=new p(i,c)).cacheMode=i.renderedPages.cacheMode,e.addV2Internal(c.getPageWithoutCache(g));while(g<c.count-1&&this.comparePages(c.getPageWithoutCache(g+1),c.getPageWithoutCache(g)))g++,e.addV2Internal(c.getPageWithoutCache(g));var w=e.getByIndex(0);if(null!=w){if(e.getPage(w),this.usePageHeadersAndFooters){var u=new p(i,i.renderedPages);u.cacheMode=i.renderedPages.cacheMode,u.add(e.getByIndex(0)),this._matrix=new r.StiMatrix(u,t["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!1);var S=0,f=0,v=!1;f=this.matrix.coordY.countItems-1-1;while(f>0&&this.matrix.linePlacement[f]!=r.StiTableLineInfo.PageHeader)f--;if(f>=0&&this.matrix.linePlacement[f]==r.StiTableLineInfo.PageHeader){S=0;while(this.matrix.linePlacement[S]!=r.StiTableLineInfo.PageHeader)S++;v=!0}this.headersData.push(this.writeHeader(S,f,v)),this.imageCache.imagePackedStore.length>0?this.headersRels.push(this.writeHeaderFooterRels()):this.headersRels.push(null);var E=!1;S=0;while(this.matrix.linePlacement[S]!=r.StiTableLineInfo.PageFooter&&S<this.matrix.coordY.countItems-1-1)S++;if(this.matrix.linePlacement[S]==r.StiTableLineInfo.PageFooter){f=this.matrix.coordY.countItems-1-1;while(this.matrix.linePlacement[f]!=r.StiTableLineInfo.PageFooter)f--;E=!0}this.footersData.push(this.writeFooter(S,f,E)),this.imageCache.imagePackedStore.length>0?this.footersRels.push(this.writeHeaderFooterRels()):this.footersRels.push(null),this._matrix=new r.StiMatrix(e,t["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!0),f=this.matrix.coordY.countItems-1-1,this.writeFromMatrix(l,0,f,!1)}else this._matrix=new r.StiMatrix(e,t["StiOptions"].Export.Word.divideBigCells,this,null,r.StiDataExportMode.AllBands,n),this.writeFromMatrix(l,0,this.matrix.coordY.countItems-1-1,!0);g<c.count-1&&(l.writeStartElement("w:p"),l.writeStartElement("w:pPr"),this.writePageInfo(l,e.getByIndex(0),h),l.writeEndElement(),l.writeEndElement())}g++,h++}return e.count>0&&this.writePageInfo(l,e.getByIndex(0),h-1),l.writeFullEndElement(),l.writeFullEndElement(),l.writeEndDocument(),l.flush(),s},D.prototype.comparePages=function(t,e){var r=t.excelSheetValue;n.isNullOrEmpty(r)&&(r="");var i=e.excelSheetValue;if(n.isNullOrEmpty(i)&&(i=""),r!=i)return!1;if(t.orientation!=e.orientation)return!1;if(!t.margins.equals(e.margins))return!1;if(t.unlimitedHeight!=e.unlimitedHeight)return!1;return!0},D.prototype.writePageInfo=function(e,r,i){var o=this.convertHiToTwips(r.unit.convertToHInches(r.pageHeight*(this.usePageHeadersAndFooters?1:r.segmentPerHeight))),a=this.convertHiToTwips(r.unit.convertToHInches(r.pageWidth*(this.usePageHeadersAndFooters?1:r.segmentPerWidth))),s=this.convertHiToTwips(r.unit.convertToHInches(r.margins.left)),l=this.convertHiToTwips(r.unit.convertToHInches(r.margins.right)),m=this.convertHiToTwips(r.unit.convertToHInches(r.margins.top)),p=this.convertHiToTwips(r.unit.convertToHInches(r.margins.bottom))-t["StiOptions"].Export.Word.bottomMarginCorrection;p<0&&(p=0),a>31500&&(a=31500),o>31500&&(o=31500),e.writeStartElement("w:sectPr"),this.usePageHeadersAndFooters?(e.writeStartElement("w:headerReference"),e.writeAttributeString("w:type","default"),e.writeAttributeString("r:id",n.format("rIdh{0}",i+1)),e.writeEndElement(),e.writeStartElement("w:footerReference"),e.writeAttributeString("w:type","default"),e.writeAttributeString("r:id",n.format("rIdf{0}",i+1)),e.writeEndElement()):t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(e.writeStartElement("w:headerReference"),e.writeAttributeString("w:type","default"),e.writeAttributeString("r:id","rIdh1"),e.writeEndElement()),e.writeStartElement("w:pgSz"),e.writeAttributeString("w:w",n.format("{0}",a)),e.writeAttributeString("w:h",n.format("{0}",o)),r.orientation==c.Landscape&&e.writeAttributeString("w:orient","landscape"),e.writeEndElement(),e.writeStartElement("w:pgMar"),e.writeAttributeString("w:top",n.format("{0}",m)),e.writeAttributeString("w:right",n.format("{0}",l)),e.writeAttributeString("w:bottom",n.format("{0}",p)),e.writeAttributeString("w:left",n.format("{0}",s)),e.writeAttributeString("w:header",n.format("{0}",m)),e.writeAttributeString("w:footer",n.format("{0}",p)),e.writeAttributeString("w:gutter","0"),e.writeEndElement(),e.writeEndElement()},D.prototype.writeBorders=function(t,e,r,i,n){for(var o=!0,a=!0,s=0;s<i;s++)null==this.matrix.bordersY[e+s][r]&&(o=!1),null==this.matrix.bordersY[e+s][r+n]&&(a=!1);for(var l=!0,m=!0,s=0;s<n;s++)null==this.matrix.bordersX[e][r+s]&&(l=!1),null==this.matrix.bordersX[e+i][r+s]&&(m=!1);(l||o||m||a)&&(t.writeStartElement("w:tcBorders"),l&&this.writeBorderData(t,"w:top",this.matrix.bordersX[e][r]),o&&this.writeBorderData(t,"w:left",this.matrix.bordersY[e][r]),m&&this.writeBorderData(t,"w:bottom",this.matrix.bordersX[e+i][r]),a&&this.writeBorderData(t,"w:right",this.matrix.bordersY[e][r+n]),t.writeEndElement())},D.prototype.writeBorderData=function(t,e,r){if(null!=r){var i=this.getLineStyle(r.style);""!=i&&(t.writeStartElement(e),t.writeAttributeString("w:val",i),t.writeAttributeString("w:sz",n.format("{0}",Math.trunc(5*r.size))),t.writeAttributeString("w:space","0"),t.writeAttributeString("w:color",this.getColorString(r.color)),t.writeEndElement())}},D.prototype.writeFootNotes=function(){var t=new m,e=new d(a.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("w:footnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeEndNotes=function(){var t=new m,e=new d(a.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("w:endnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeHeader=function(t,e,r){var i=new m,n=new d(a.UTF8,i);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?o.None:o.Indented,n.writeStartDocument(),n.writeStartElement("w:hdr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),r?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i},D.prototype.writeFooter=function(t,e,r){var i=new m,n=new d(a.UTF8,i);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?o.None:o.Indented,n.writeStartDocument(),n.writeStartElement("w:ftr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),r?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i},D.prototype.writeContentTypes=function(){var e=new m,r=new d(a.UTF8,e);if(r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?o.None:o.Indented,r.writeStartDocument(),r.writeStartElement("Types"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),r.writeStartElement("Default"),r.writeAttributeString("Extension","rels"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","xml"),r.writeAttributeString("ContentType","application/xml"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","jpeg"),r.writeAttributeString("ContentType","image/jpeg"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","emf"),r.writeAttributeString("ContentType","image/x-emf"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","rtf"),r.writeAttributeString("ContentType","application/rtf"),r.writeEndElement(),r.writeStartElement("Default"),r.writeAttributeString("Extension","png"),r.writeAttributeString("ContentType","image/png"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/docProps/app.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/docProps/core.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/document.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/styles.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/settings.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/webSettings.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/fontTable.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"),r.writeEndElement(),this.usePageHeadersAndFooters){r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/footnotes.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/endnotes.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),r.writeEndElement();for(var i=0;i<this.headersData.length;i++)r.writeStartElement("Override"),r.writeAttributeString("PartName",n.format("/word/footer{0}.xml",i+1)),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName",n.format("/word/header{0}.xml",i+1)),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),r.writeEndElement()}else t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/footnotes.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/endnotes.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),r.writeEndElement(),r.writeStartElement("Override"),r.writeAttributeString("PartName","/word/headerAdditional.xml"),r.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),r.writeEndElement());return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writeMainRels=function(){var t=new m,e=new d(a.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","word/document.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeDocPropsApp=function(){var t=new m,e=new d(a.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Office Word"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("Template","Normal.dotm"),e.writeElementString("TotalTime","0"),e.writeElementString("Pages","1"),e.writeElementString("Words","1"),e.writeElementString("Characters","1"),e.writeElementString("DocSecurity",this.restrictEditing==r.StiWord2007RestrictEditing.No?"0":"8"),e.writeElementString("Lines","1"),e.writeElementString("Paragraphs","1"),e.writeElementString("ScaleCrop","false"),e.writeElementString("LinksUpToDate","false"),e.writeElementString("CharactersWithSpaces","1"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeDocPropsCore=function(){var e=new m,r=new d(a.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?o.None:o.Indented,r.writeStartDocument(),r.writeStartElement("cp:coreProperties"),r.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),r.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),r.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");var i=n.format("{0}{1}",s.now.toString("yyyy-MM-dd"),s.now.toString("THH:mm:ssZ"));return r.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),r.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),r.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),r.writeElementString("cp:keywords",""),r.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),r.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),r.writeElementString("cp:revision","1"),r.writeStartElement("dcterms:created"),r.writeAttributeString("xsi:type","dcterms:W3CDTF"),r.writeString(i),r.writeEndElement(),r.writeStartElement("dcterms:modified"),r.writeAttributeString("xsi:type","dcterms:W3CDTF"),r.writeString(i),r.writeEndElement(),r.writeElementString("cp:contentStatus",t.StiVersion.platform()),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writeSettings=function(){var t=new m,e=new d(a.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("w:settings"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:sl","http://schemas.openxmlformats.org/schemaLibrary/2006/main"),this.restrictEditing!=r.StiWord2007RestrictEditing.No&&(e.writeStartElement("w:documentProtection"),e.writeAttributeString("w:edit","readOnly"),e.writeAttributeString("w:enforcement","1"),e.writeAttributeString("w:cryptProviderType","rsaFull"),e.writeAttributeString("w:cryptAlgorithmClass","hash"),e.writeAttributeString("w:cryptAlgorithmType","typeAny"),e.writeAttributeString("w:cryptAlgorithmSid","4"),e.writeAttributeString("w:cryptSpinCount","50000"),e.writeAttributeString("w:hash","aw5VYrxGrQVOl7/SJDI9GvbcwaE="),e.writeAttributeString("w:salt","974T1u8C/8p0OAB+3ev3nQ=="),e.writeEndElement()),e.writeStartElement("w:zoom"),e.writeAttributeString("w:percent","100"),e.writeEndElement(),e.writeStartElement("w:proofState"),e.writeAttributeString("w:spelling","clean"),e.writeAttributeString("w:grammar","clean"),e.writeEndElement(),e.writeStartElement("w:defaultTabStop"),e.writeAttributeString("w:val","708"),e.writeEndElement(),e.writeStartElement("w:characterSpacingControl"),e.writeAttributeString("w:val","doNotCompress"),e.writeEndElement(),this.usePageHeadersAndFooters&&(e.writeStartElement("w:footnotePr"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:endnotePr"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("w:compat"),e.writeEndElement(),e.writeStartElement("m:mathPr"),e.writeStartElement("m:mathFont"),e.writeAttributeString("m:val","Cambria Math"),e.writeEndElement(),e.writeStartElement("m:brkBin"),e.writeAttributeString("m:val","before"),e.writeEndElement(),e.writeStartElement("m:brkBinSub"),e.writeAttributeString("m:val","--"),e.writeEndElement(),e.writeStartElement("m:smallFrac"),e.writeAttributeString("m:val","off"),e.writeEndElement(),e.writeStartElement("m:dispDef"),e.writeEndElement(),e.writeStartElement("m:lMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:rMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:defJc"),e.writeAttributeString("m:val","centerGroup"),e.writeEndElement(),e.writeStartElement("m:wrapIndent"),e.writeAttributeString("m:val","1440"),e.writeEndElement(),e.writeStartElement("m:intLim"),e.writeAttributeString("m:val","subSup"),e.writeEndElement(),e.writeStartElement("m:naryLim"),e.writeAttributeString("m:val","undOvr"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:themeFontLang"),e.writeAttributeString("w:val","en-EN"),e.writeEndElement(),e.writeStartElement("w:clrSchemeMapping"),e.writeAttributeString("w:bg1","light1"),e.writeAttributeString("w:t1","dark1"),e.writeAttributeString("w:bg2","light2"),e.writeAttributeString("w:t2","dark2"),e.writeAttributeString("w:accent1","accent1"),e.writeAttributeString("w:accent2","accent2"),e.writeAttributeString("w:accent3","accent3"),e.writeAttributeString("w:accent4","accent4"),e.writeAttributeString("w:accent5","accent5"),e.writeAttributeString("w:accent6","accent6"),e.writeAttributeString("w:hyperlink","hyperlink"),e.writeAttributeString("w:followedHyperlink","followedHyperlink"),e.writeEndElement(),e.writeStartElement("w:shapeDefaults"),e.writeStartElement("o:shapedefaults"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("spidmax","2050"),e.writeEndElement(),e.writeStartElement("o:shapelayout"),e.writeAttributeString("v:ext","edit"),e.writeStartElement("o:idmap"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("data","1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:decimalSymbol"),e.writeAttributeString("w:val",","),e.writeEndElement(),e.writeStartElement("w:listSeparator"),e.writeAttributeString("w:val",";"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeWebSettings=function(){var t=new m,e=new d(a.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("w:webSettings"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeStartElement("w:optimizeForBrowser"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeFontTable=function(){var t,e,r=new m,i=new d(a.UTF8,r);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?o.None:o.Indented,i.writeStartDocument(),i.writeStartElement("w:fonts"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),this.fontList.set("Calibri","Calibri"),this.fontList.set("Cambria","Cambria");try{for(var n=__values(this.fontList.values),s=n.next();!s.done;s=n.next()){var l=s.value;i.writeStartElement("w:font"),i.writeAttributeString("w:name",l),i.writeFullEndElement()}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),r},D.prototype.writeDocumentRels=function(){var e,r,i=new m,s=new d(a.UTF8,i);s.indentation=this.xmlIndentation<0?0:this.xmlIndentation,s.formatting=this.xmlIndentation<0?o.None:o.Indented,s.writeStartDocument(),s.writeStartElement("Relationships"),s.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),s.writeStartElement("Relationship"),s.writeAttributeString("Id","rId1"),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),s.writeAttributeString("Target","styles.xml"),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id","rId2"),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings"),s.writeAttributeString("Target","settings.xml"),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id","rId3"),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings"),s.writeAttributeString("Target","webSettings.xml"),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id","rId4"),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable"),s.writeAttributeString("Target","fontTable.xml"),s.writeEndElement();for(var l=0;l<this.imageCache.imagePackedStore.length;l++)s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rId{0}",5+l)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),s.writeAttributeString("Target",n.format("media/image{0:D5}.jpeg",l+1)),s.writeEndElement();if(this.usePageHeadersAndFooters){s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),s.writeAttributeString("Target","footnotes.xml"),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),s.writeAttributeString("Target","endnotes.xml"),s.writeEndElement();for(var l=0;l<this.headersData.length;l++)s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rIdh{0}",l+1)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),s.writeAttributeString("Target",n.format("header{0}.xml",l+1)),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rIdf{0}",l+1)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer"),s.writeAttributeString("Target",n.format("footer{0}.xml",l+1)),s.writeEndElement()}else t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),s.writeAttributeString("Target","footnotes.xml"),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),s.writeAttributeString("Target","endnotes.xml"),s.writeEndElement(),s.writeStartElement("Relationship"),s.writeAttributeString("Id","rIdh1"),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),s.writeAttributeString("Target","headerAdditional.xml"),s.writeEndElement());if(this.hyperlinkList.count>0)try{for(var c=__values(this.hyperlinkList.keys),p=c.next();!p.done;p=c.next()){var g=p.value;s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("hId{0}",Math.trunc(this.hyperlinkList.get(g)))),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),s.writeAttributeString("Target",g),s.writeAttributeString("TargetMode","External"),s.writeEndElement()}}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(this.embedsList.length>0)for(var l=0;l<this.embedsList.length;l++)s.writeStartElement("Relationship"),s.writeAttributeString("Id",n.format("reId{0}",1+l)),s.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"),s.writeAttributeString("Target",n.format("embeddings/richtext{0:D5}.rtf",l+1)),s.writeAttributeString("TargetMode","Internal"),s.writeEndElement();return s.writeFullEndElement(),s.writeEndDocument(),s.flush(),i},D.prototype.writeHeaderFooterRels=function(){var t=new m,e=new d(a.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?o.None:o.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(var r=0;r<this.imageCache.imagePackedStore.length;r++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",5+r)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),e.writeAttributeString("Target",n.format("media/image{0:D5}.jpeg",r+1)),e.writeEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},D.prototype.writeStyles=function(){var e=new m,r=new d(a.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?o.None:o.Indented,r.writeStartDocument(),r.writeStartElement("w:styles"),r.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),r.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),r.writeStartElement("w:style"),r.writeAttributeString("w:type","paragraph"),r.writeAttributeString("w:default","1"),r.writeAttributeString("w:styleId","a"),r.writeStartElement("w:name"),r.writeAttributeString("w:val","Normal"),r.writeEndElement(),r.writeStartElement("w:qFormat"),r.writeEndElement(),r.writeStartElement("w:pPr"),r.writeStartElement("w:spacing"),r.writeAttributeString("w:after","0"),r.writeAttributeString("w:line","240"),r.writeAttributeString("w:lineRule","auto"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("w:rPr"),r.writeStartElement("w:sz"),r.writeAttributeString("w:val",n.format("{0}",Math.round2(2*t["StiOptions"].Export.Word.normalStyleDefaultFontSize))),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("w:style"),r.writeAttributeString("w:type","character"),r.writeAttributeString("w:default","1"),r.writeAttributeString("w:styleId","a0"),r.writeStartElement("w:name"),r.writeAttributeString("w:val","Default Paragraph Font"),r.writeEndElement(),r.writeStartElement("w:uiPriority"),r.writeAttributeString("w:val","1"),r.writeEndElement(),r.writeStartElement("w:semiHidden"),r.writeEndElement(),r.writeStartElement("w:unhideWhenUsed"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("w:style"),r.writeAttributeString("w:type","table"),r.writeAttributeString("w:default","1"),r.writeAttributeString("w:styleId","a1"),r.writeStartElement("w:name"),r.writeAttributeString("w:val","Normal Table"),r.writeEndElement(),r.writeStartElement("w:uiPriority"),r.writeAttributeString("w:val","99"),r.writeEndElement(),r.writeStartElement("w:semiHidden"),r.writeEndElement(),r.writeStartElement("w:unhideWhenUsed"),r.writeEndElement(),r.writeStartElement("w:qFormat"),r.writeEndElement(),r.writeStartElement("w:tblPr"),r.writeStartElement("w:tblInd"),r.writeAttributeString("w:w","0"),r.writeAttributeString("w:type","dxa"),r.writeEndElement(),r.writeStartElement("w:tblCellMar"),r.writeStartElement("w:top"),r.writeAttributeString("w:w","0"),r.writeAttributeString("w:type","dxa"),r.writeEndElement(),r.writeStartElement("w:left"),r.writeAttributeString("w:w","0"),r.writeAttributeString("w:type","dxa"),r.writeEndElement(),r.writeStartElement("w:bottom"),r.writeAttributeString("w:w","0"),r.writeAttributeString("w:type","dxa"),r.writeEndElement(),r.writeStartElement("w:right"),r.writeAttributeString("w:w","0"),r.writeAttributeString("w:type","dxa"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("w:style"),r.writeAttributeString("w:type","numbering"),r.writeAttributeString("w:default","1"),r.writeAttributeString("w:styleId","a2"),r.writeStartElement("w:name"),r.writeAttributeString("w:val","No List"),r.writeEndElement(),r.writeStartElement("w:uiPriority"),r.writeAttributeString("w:val","99"),r.writeEndElement(),r.writeStartElement("w:semiHidden"),r.writeEndElement(),r.writeStartElement("w:unhideWhenUsed"),r.writeEndElement(),r.writeEndElement();for(var i=0;i<this.styleList.length;i++){var s=this.styleList[i];r.writeStartElement("w:style"),r.writeAttributeString("w:type","paragraph"),r.writeAttributeString("w:customStyle","1"),r.writeAttributeString("w:styleId",n.format("Style{0}",i)),r.writeStartElement("w:name"),r.writeAttributeString("w:val",s.name),r.writeEndElement(),r.writeStartElement("w:basedOn"),r.writeAttributeString("w:val","a"),r.writeEndElement(),r.writeStartElement("w:rPr"),r.writeStartElement("w:rFonts"),r.writeAttributeString("w:ascii",s.fontName),r.writeAttributeString("w:hAnsi",s.fontName),r.writeAttributeString("w:cs",s.fontName),r.writeEndElement(),s.bold&&(r.writeStartElement("w:b"),r.writeEndElement()),s.italic&&(r.writeStartElement("w:i"),r.writeEndElement()),s.underline&&(r.writeStartElement("w:u"),r.writeAttributeString("w:val","single"),r.writeEndElement()),r.writeStartElement("w:color"),r.writeAttributeString("w:val",this.getColorString(s.textColor)),r.writeEndElement(),r.writeStartElement("w:sz"),r.writeAttributeString("w:val",n.format("{0}",s.fontSize)),r.writeEndElement(),0!=t["StiOptions"].Export.Word.spaceBetweenCharacters&&(r.writeStartElement("w:spacing"),r.writeAttributeString("w:val",n.format("{0}",t["StiOptions"].Export.Word.spaceBetweenCharacters)),r.writeEndElement()),s.rightToLeft&&(s.bold&&(r.writeStartElement("w:bCs"),r.writeEndElement()),s.italic&&(r.writeStartElement("w:iCs"),r.writeEndElement()),r.writeStartElement("w:szCs"),r.writeAttributeString("w:val",n.format("{0}",s.fontSize)),r.writeEndElement(),r.writeStartElement("w:rtl"),r.writeEndElement()),r.writeEndElement(),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},D.prototype.writeImage=function(t){var e=new m,r=this.imageCache.imagePackedStore[t];return null!=r&&e.write(r,0,r.length),e},D.prototype.writeAdditionalData=function(e,r){var i=new m,n=null;return n=r?t.System.Convert.fromBase64String(e):a.ASCII.getBytes(e),i.write(n,0,n.length),i},D.prototype.exportWord=function(i,o,a){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Word 2007 format"),null==a)throw new Error("The 'settings' argument cannot be equal in null.");var s=a.pageRange;this.usePageHeadersAndFooters=a.usePageHeadersAndFooters,this._removeEmptySpaceAtBottom=a.removeEmptySpaceAtBottom,this.imageResolution=a.imageResolution,this.imageQuality=a.imageQuality,this.docCompanyString=a.companyString,this.docLastModifiedString=a.lastModifiedString,this.restrictEditing=a.restrictEditing,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,1!=t["StiOptions"].Export.Word.lineSpacing&&(this.lineSpace=Math.round2(240*t["StiOptions"].Export.Word.lineSpacing).toString(),this.lineSpace2=Math.round2(.772*t["StiOptions"].Export.Word.lineSpacing*240).toString()),t["StiOptions"].Export.Word.restrictEditing>this.restrictEditing&&(this.restrictEditing=t["StiOptions"].Export.Word.restrictEditing),this.report=i;try{this.styleList=[],this.fontList=new T,this.imageCache=new e.StiImageCache(t["StiOptions"].Export.Word.allowImageComparer,!0,e.ImageFormat.Jpeg,this.imageQuality,!1),this.bookmarkList=new T,this.hyperlinkList=new T,this.embedsList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(t["StiOptions"].Export.Word.divideSegmentPages?1:0);var m=!1,c=s.getSelectedPages(i.renderedPages);if(t["StiOptions"].Export.Word.divideSegmentPages){var p=!0;if(this.usePageHeadersAndFooters&&c.count>0&&c.getByIndex(0).unlimitedHeight&&1==c.getByIndex(0).segmentPerWidth&&(p=!1),p){var g=r.StiSegmentPagesDivider.divide(c,this);c!=g&&(m=!0),c=g,this.currentPassNumber++}}var h=new l;if(h.begin(o,!0),this.usePageHeadersAndFooters&&(this.headersData=[],this.headersRels=[],this.footersData=[],this.footersRels=[]),h.addFile("word/document.xml",this.writeDocument(c,i,m),!0),this.usePageHeadersAndFooters)for(var w=0;w<this.headersData.length;w++)h.addFile(n.format("word/header{0}.xml",w+1),this.headersData[w]),null!=this.headersRels[w]&&h.addFile(n.format("word/_rels/header{0}.xml.rels",w+1),this.headersRels[w]),h.addFile(n.format("word/footer{0}.xml",w+1),this.footersData[w]),null!=this.footersRels[w]&&h.addFile(n.format("word/_rels/footer{0}.xml.rels",w+1),this.footersRels[w]);if(this.usePageHeadersAndFooters&&(h.addFile("word/footnotes.xml",this.writeFootNotes()),h.addFile("word/endnotes.xml",this.writeEndNotes())),h.addFile("[Content_Types].xml",this.writeContentTypes()),h.addFile("_rels/.rels",this.writeMainRels()),h.addFile("docProps/app.xml",this.writeDocPropsApp()),h.addFile("docProps/core.xml",this.writeDocPropsCore()),h.addFile("word/settings.xml",this.writeSettings()),h.addFile("word/webSettings.xml",this.writeWebSettings()),h.addFile("word/fontTable.xml",this.writeFontTable()),h.addFile("word/_rels/document.xml.rels",this.writeDocumentRels()),h.addFile("word/styles.xml",this.writeStyles()),this.imageCache.imagePackedStore.length>0)for(var w=0;w<this.imageCache.imagePackedStore.length;w++)h.addFile(n.format("word/media/image{0:D5}.jpeg",w+1),this.writeImage(w));t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||this.usePageHeadersAndFooters||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion||(h.addFile("word/footnotes.xml",this.writeFootNotes()),h.addFile("word/endnotes.xml",this.writeEndNotes()),h.addFile("word/media/imageAdditional.png",this.writeAdditionalData(r.StiExportUtils.additionalData,!0)),h.addFile("word/headerAdditional.xml",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<w:hdr xmlns:ve="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" '+'xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" '+'xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" '+'xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml"><w:p><w:pPr><w:pStyle w:val="a3"/></w:pPr><w:r><w:rPr><w:noProof/><w:lang w:eastAsia="ru-RU"/></w:rPr><w:pict>'+'<v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>'+'<v:f eqn="if lineDrawn pixelLineWidth 0"/><v:f eqn="sum @0 1 0"/><v:f eqn="sum 0 0 @1"/><v:f eqn="prod @2 1 2"/><v:f eqn="prod @3 21600 pixelWidth"/><v:f eqn="prod @3 21600 pixelHeight"/><v:f eqn="sum @0 0 1"/>'+'<v:f eqn="prod @6 1 2"/><v:f eqn="prod @7 21600 pixelWidth"/><v:f eqn="sum @8 21600 0"/><v:f eqn="prod @7 21600 pixelHeight"/><v:f eqn="sum @10 21600 0"/></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'<o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="WordPictureWatermark11777093" o:spid="_x0000_s2050" type="#_x0000_t75" '+'style="position:absolute;margin-left:0;margin-top:0;width:467.45pt;height:433.85pt;z-index:-251657216;mso-position-horizontal:center;mso-position-horizontal-relative:margin;mso-position-vertical:center;mso-position-vertical-relative:margin" '+'o:allowincell="f"><v:imagedata r:id="rId1" o:title="additional"/></v:shape></w:pict></w:r></w:p></w:hdr>',!1)),h.addFile("word/_rels/headerAdditional.xml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/imageAdditional.png" /></Relationships>',!1))),h.end()}finally{null!=this.matrix&&(this.matrix.clear(),this._matrix=null),this.fontList.clear(),this.fontList=null,this.imageCache.clear(),this.imageCache=null,this.styleList.stimulsoft.clear(),this.styleList=null,this.bookmarkList.clear(),this.bookmarkList=null,this.hyperlinkList.clear(),this.hyperlinkList=null,this.embedsList.stimulsoft.clear(),this.embedsList=null,this.usePageHeadersAndFooters&&(this.headersData.stimulsoft.clear(),this.headersData=null,this.headersRels.stimulsoft.clear(),this.headersRels=null,this.footersData.stimulsoft.clear(),this.footersData=null,this.footersRels.stimulsoft.clear(),this.footersRels=null),i.renderedPages.cacheMode&&r.StiMatrix.GCCollect()}},D}(r.StiExportService);r.StiWord2007ExportService=I}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.Base.Drawing.StiColorUtils,n=t.Report.Components.StiDataBarIndicator,o=t.Report.Components.StiIconSetHelper,a=t.Report.Components.StiIcon,s=t.Report.Components.StiIconSetIndicator,l=t.System.StiArray,m=t.Report.Components.StiBookmarksCollection,c=t.Report.Components.StiBookmark,p=t.System.Char,g=t.Base.Drawing.StiHtmlTag,h=t.Report.Components.StiImageRotation,w=t.System.StiString,u=t.Report.Dashboard.StiDashboardExport,d=t.Report.Dashboard.IStiDashboard,S=t.System.Drawing.Color,f=t.System.IO.MemoryStream,v=t.Report.Components.StiContainer,E=t.Base.Drawing.StiBrush,b=t.Base.Drawing.StiGradientBrush,y=t.Base.Drawing.StiGlareBrush,x=t.Base.Drawing.StiHatchBrush,A=t.Base.Drawing.StiGlassBrush,T=t.System.Collections.Hashtable,P=t.System.Text.StringBuilder,L=t.Report.Components.StiText,C=t.Report.Components.StiShape,F=t.Report.Components.StiRectanglePrimitive,B=t.Report.Components.IStiFont,k=t.Report.Components.IStiBrush,R=t.Report.Components.IStiTextBrush,I=t.Report.Components.IStiTextOptions,D=t.Report.Components.IStiBorder,N=t.System.Xml.XmlTextWriter,O=t.System.DateTime,H=t.Report.Chart.IStiChart,M=t.Report.Components.StiImage,W=t.System.Drawing.Rectangle,U=t.Base.Drawing.StiHorAlignment,X=t.Base.Drawing.StiVertAlignment,z=t.Report.Components.IStiExportImageExtended,V=t.Report.Components.StiCheckBox,G=t.Report.BarCodes.StiBarCode,Y=t.Report.Components.IStiTextHorAlignment,j=t.System.Drawing.FontStyle,_=function(){function t(t){this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Component=null,this.service=null,this.service=t}return Object.defineProperty(t.prototype,"Right",{get:function(){return this.X+this.Width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.Y+this.Height},enumerable:!1,configurable:!0}),t}();r.StiPdfData=_;var q=function(){function t(){}return t}();r.StiImageData=q;var K=function(){function t(){}return t}();r.StiShadingData=K;var Q=function(){function t(){}return t}();r.StiShadingFunctionData=Q;var J=function(){function t(){}return t}();r.StiEditableObject=J;var Z=function(){function t(){}return t}(),$=function(){function t(){}return t}(),tt=function(tt){function et(){var t=null!==tt&&tt.apply(this,arguments)||this;return t.imageQuality=.75,t.imageResolutionMain=1,t.imageResolutionMode=r.StiImageResolutionMode.Auto,t.sw=null,t.pageStream=null,t.imageList=null,t.imageCache=null,t.imageInterpolationTable=null,t.imageCacheIndexToList=null,t.imageInfoList=null,t.imageInfoCounter=0,t.colorTable=l.create(String,256),t.alphaTable=l.create(Boolean,256),t.pdfFont=null,t.bidi=null,t.standardPdfFonts=!0,t.embeddedFonts=!1,t.useUnicodeMode=!1,t.reduceFontSize=!0,t.compressed=!1,t.compressedFonts=!1,t.encrypted=!1,t.usePdfA=!1,t.pdfComplianceMode=r.StiPdfComplianceMode.None,t.exportRtfTextAsImage=!1,t.autoPrint=r.StiPdfAutoPrintMode.None,t.imageCompressionMethod=r.StiPdfImageCompressionMethod.Jpeg,t.imageFormat=r.StiImageFormat.Color,t.monochromeDitheringType=r.StiMonochromeDitheringType.FloydSteinberg,t.allowEditable=r.StiPdfAllowEditable.No,t.useTransparency=!0,t.fontGlyphsReduceNotNeed=null,t.bookmarksTree=null,t.bookmarksTreeTemp=null,t.linksArray=null,t.tagsArray=null,t.tooltipsArray=null,t.shadingArray=null,t.hatchArray=null,t.shadingFunctionArray=null,t.haveBookmarks=!1,t.haveLinks=!1,t.haveAnnots=!1,t.haveTooltips=!1,t.CodePage1252part80AF=[8364,8226,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,8226,381,8226,8226,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,8226,382,376],t.CodePage1252=l.create(Number,256),t.hiToTwips=.72,t.precision_digits_font=3,t.pdfCKT=.55228,t.IDValue=null,t.IDValueString="",t.IDValueStringMeta="",t.currentDateTime="",t.currentDateTimeMeta="",t.producerName="Stimulsoft Reports",t.creatorName="",t.keywords="",t.keyLength=r.StiPdfEncryptionKeyLength.Bit40,t.lastColorStrokeA=255,t.lastColorNonStrokeA=255,t.colorStack=null,t.info=null,t.haveDigitalSignature=!1,t.pdfSecurity=null,t.printScaling=!0,t.colorHash1=new T,t.colorHash2=new T,t._gsTable=null,t}return __extends(et,tt),et.prototype.implements=function(){return[r.IStiPdfExportService]},Object.defineProperty(et.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Pdf},enumerable:!1,configurable:!0}),et.prototype.exportTo=function(t,e,r){this.exportPdf1(t,e,r)},et.prototype.exportToAsync=function(e,i,n,o){var a=this,s=o.imageCompressionMethod==r.StiPdfImageCompressionMethod.Flate;t.Report.Export.StiExportImageHelper.convertAllImages(i,t.System.Drawing.Imaging.ImageFormat.Jpeg,s).try((function(){if(!i.isDocument&&i.getCurrentPage().is(d))return void u.exportAsync(i,n,o).try((function(){return e()}));a.exportTo(i,n,o),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null),e()}))},Object.defineProperty(et.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),et.prototype.stringReplace=function(t,e,r){e=e.replace(et.regexEscape,"\\$1");var i=new RegExp(e,"g");return t.replace(i,r)},et.prototype.getHatchNumber=function(t){if(this.hatchArray.length>0)for(var e=0;e<this.hatchArray.length;e++){var r=this.hatchArray[e];if(t.style==r.style&&t.backColor==r.backColor&&t.foreColor==r.foreColor)return e}return this.hatchArray.push(t),this.hatchArray.length-1},et.prototype.getShadingFunctionNumber=function(t,e,r){if(this.shadingFunctionArray.length>0)for(var i=0;i<this.shadingFunctionArray.length;i++){var n=this.shadingFunctionArray[i];if(n.Color1.equals(t)&&n.Color2.equals(e)&&n.IsGlare==r)return i}var o=new Q;return o.Color1=t,o.Color2=e,o.IsGlare=r,this.shadingFunctionArray.push(o),this.shadingFunctionArray.length-1},et.prototype.addXref=function(t){var e=this.sw.position;this.xref[t]=e.toString().stimulsoft.padLeft(10,"0")+" 00000 n",this.currentObjectNumber=t,this.currentGenerationNumber=0},et.prototype.convertToString=function(e,r){var i;return void 0===r&&(r=2),Math.round2(e,r).toString().split(",").join(t.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)},et.convertToEscapeSequence=function(t){var e=[40,41,92,13,10,8,12],r="()\\rnbf",i,n;if(null==t)return"";n=new P;for(var o=0;o<t.length;o++){i=!1;for(var a=0;a<e.length;a++)if(t.charCodeAt(o)==e[a]){n.append("\\"+r[a]),i=!0;break}i||n.append(t.charAt(o))}return n.toString()},et.convertToEscapeSequencePlusTabs=function(t){var e=[40,41,92,13,10,9,8,12],r="()\\rntbf",i,n;if(null==t)return"";n="";for(var o=0;o<t.length;o++){i=!1;for(var a=0;a<e.length;a++)if(t.charCodeAt(o)==e[a]){n+="\\"+r[a],i=!0;break}i||(n+=t.charAt(o))}return n},et.prototype.setStrokeColor=function(e){var r=this.colorHash1.get(e);null==r&&(r=w.format("{0} {1} {2} RG",this.colorTable[e.r],this.colorTable[e.g],this.colorTable[e.b]),this.colorHash1.set(e,r)),this.pageStream.writeLine(r);var i=e.a;i!=this.lastColorStrokeA&&t["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[i][0]),this.lastColorStrokeA=i,this.alphaTable[i]=!0)},et.prototype.setNonStrokeColor=function(e){var r=this.colorHash2.get(e);null==r&&(r=w.format("{0} {1} {2} rg",this.colorTable[e.r],this.colorTable[e.g],this.colorTable[e.b]),this.colorHash2.set(e,r)),this.pageStream.writeLine(r);var i=e.a;i!=this.lastColorNonStrokeA&&t["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[i][1]),this.lastColorNonStrokeA=i,this.alphaTable[i]=!0)},Object.defineProperty(et.prototype,"gsTable",{get:function(){if(null==this._gsTable){this._gsTable=l.create2(String,256,2);for(var t=0;t<256;t++)this._gsTable[t][0]=w.format("/GS{0:X2}S gs",t),this._gsTable[t][1]=w.format("/GS{0:X2}N gs",t)}return this._gsTable},enumerable:!1,configurable:!0}),et.prototype.pushColorToStack=function(){this.colorStack.push(this.lastColorStrokeA),this.colorStack.push(this.lastColorNonStrokeA)},et.prototype.popColorFromStack=function(){this.lastColorNonStrokeA=this.colorStack.pop(),this.lastColorStrokeA=this.colorStack.pop()},et.prototype.fillRectBrush=function(t,e){var r=E.toColor(t);if(this.setNonStrokeColor(r),this.storeShadingData2(e.x,e.y,e.width,e.height,t),(t.stimulsoft.is(b)||t.stimulsoft.is(y))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+this.shadingCurrent),t.stimulsoft.is(x)){var i=t.stimulsoft.as(x);this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.getHatchNumber(i)+1)}if(t.stimulsoft.is(A)){var n=t.stimulsoft.as(A);this.setNonStrokeColor(n.getTopColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y+e.height/2),this.convertToString(e.width),this.convertToString(e.height/2)),this.setNonStrokeColor(n.getBottomColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height/2)),r=S.transparent}0!=r.a&&this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height))},et.prototype.storeStringLine=function(t,e,r){void 0===r&&(r=!1);var i=t+this.convertToHexString(e,r);this.storeString(i),this.sw.writeLine()},et.prototype.storeString=function(t){this.sw.writeString(t,!1)},et.prototype.convertToHexString=function(t,e){var r="";if(w.isNullOrEmpty(t))if(this.encrypted){for(var i=this.pdfSecurity.encryptData([],this.currentObjectNumber,this.currentGenerationNumber),n="",o=0;o<i.length;o++)n+=String.fromCharCode(i[o]);r+="("+et.convertToEscapeSequencePlusTabs(n)+")"}else r+="()";else{for(var a=!1,s=0;s<t.length;s++)t.charCodeAt(s)>127&&(a=!0);if(this.encrypted){var l=null;if(1==a){l=[];for(var o=0;o<t.length;o++){var m=t.charCodeAt(o);l[2+2*o+0]=m>>8&255,l[2+2*o+1]=255&m}l[0]=254,l[1]=255}else{l=[];for(var o=0;o<t.length;o++)l[o]=t.charCodeAt(o)}for(var i=this.pdfSecurity.encryptData(l,this.currentObjectNumber,this.currentGenerationNumber),n="",o=0;o<i.length;o++)n+=String.fromCharCode(i[o]);r+="("+et.convertToEscapeSequencePlusTabs(n)+")"}else if(1==a){r+="<FEFF";for(var o=0;o<t.length;o++)r+=w.format("{0:X4}",t.charCodeAt(o));r+=">"}else r+=e?"("+et.convertToEscapeSequencePlusTabs(t)+")":"("+t+")"}return r},et.prototype.storeMemoryStream2=function(t,e){if(this.encrypted){var r=this.pdfSecurity.encryptData(t.toArray(),this.currentObjectNumber,this.currentGenerationNumber);this.sw.writeLine1(w.format(e,r.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),this.sw.write(r,0,r.length)}else this.sw.writeLine1(w.format(e,t.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),t.writeTo(this.sw);t.close()},et.prototype.storeMemoryStream3=function(t,e){for(var r=new f,i=0;i<t.length;i++)r.writeByte(t[i]);this.storeMemoryStream2(r,e),r.close()},et.prototype.storeMemoryStream4=function(t,e){for(var r=new f,i=0;i<t.length;i++)r.writeByte(t[i]);this.storeMemoryStream2(r,e),r.close()},et.prototype.renderStartDoc=function(i,n){var o,a;this.sw.writeLine(this.keyLength==r.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==r.StiPdfEncryptionKeyLength.Bit256_r6?"%PDF-1.7":"%PDF-1.4"),this.sw.write([37,226,227,207,211],0,5),this.sw.writeLine(),this.addXref(1),this.sw.writeLine("1 0 obj"),this.sw.writeLine("<<"),this.keyLength==r.StiPdfEncryptionKeyLength.Bit256_r5&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 3>>>>"),this.keyLength==r.StiPdfEncryptionKeyLength.Bit256_r6&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 8>>>>"),this.sw.writeLine("/Type /Catalog"),this.sw.writeLine1("/Pages {0} 0 R",this.info.pages.ref),this.sw.writeLine("/MarkInfo<</Marked true>>"),this.sw.writeLine1("/Metadata {0} 0 R",this.info.metadata.ref),this.sw.writeLine1("/OutputIntents {0} 0 R",this.info.outputIntents.ref),this.sw.writeLine1("/StructTreeRoot {0} 0 R",this.info.structTreeRoot.ref),this.haveBookmarks?(this.sw.writeLine1("/Outlines {0} 0 R",this.info.outlines.ref),this.sw.writeLine("/PageMode /UseOutlines")):this.sw.writeLine("/PageMode /UseNone"),this.printScaling||(this.sw.writeLine("/ViewerPreferences"),this.sw.writeLine("<<"),this.sw.writeLine("/PrintScaling /None"),this.sw.writeLine(">>")),(this.haveAnnots||this.haveDigitalSignature)&&this.sw.writeLine1("/AcroForm {0} 0 R",this.info.acroForm.ref),this.autoPrint!=r.StiPdfAutoPrintMode.None&&this.sw.writeLine1("/Names <</JavaScript {0} 0 R>>",this.info.embeddedJS.ref),this.usePdfA||this.sw.writeLine1("/OCProperties << /OCGs [{0} 0 R] /D << /ON [{0} 0 R] /AS [<</Event /Print /OCGs [{0} 0 R] /Category [/Print]>>] >> >>",this.info.optionalContentGroup.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(2),this.sw.writeLine("2 0 obj"),this.sw.writeLine("<<"),this.storeStringLine("/Producer ",this.producerName,!0),this.storeStringLine("/Creator ",this.creatorName,!0),w.isNullOrEmpty(i.reportAuthor)||this.storeStringLine("/Author ",i.reportAuthor,!0),w.isNullOrEmpty(i.reportAlias)||this.storeStringLine("/Subject ",i.reportAlias,!0),w.isNullOrEmpty(i.reportName)||this.storeStringLine("/Title ",i.reportName,!0),w.isNullOrEmpty(this.keywords)||this.storeStringLine("/Keywords ",this.keywords,!0),this.storeStringLine("/CreationDate ","D:"+this.currentDateTime),this.storeStringLine("/ModDate ","D:"+this.currentDateTime);try{for(var s=__values(i.metaTags.list),l=s.next();!l.done;l=s.next()){var m=l.value;m.name.stimulsoft.startsWith("pdf:")&&this.storeStringLine(w.format("/{0} ",e.StiNameValidator.correctName(m.name.substr(4),!1)),m.tag)}}catch(t){o={error:t}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(3),this.sw.writeLine("3 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Cs1 [/Pattern /DeviceRGB]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.pages.ref),this.sw.writeLine1("{0} 0 obj",this.info.pages.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pages"),this.sw.writeString("/Kids [ ");for(var c=0;c<n.count;c++)this.sw.writeString(w.format("{0} 0 R ",this.info.pageList[c].ref));if(this.sw.writeLine("]"),this.sw.writeLine1("/Count {0}",n.count),t["StiOptions"].Export.Pdf.allowInheritedPageResources){var p;(p=[]).push("/Resources"),p.push("<<"),p.push("/ProcSet [/PDF /Text /ImageC]"),p.push("/Font"),p.push("<<");for(var c=0;c<this.fontsCounter;c++)p.push(w.format("/F{0} {1} 0 R",c,this.info.fontList[c].ref));if(p.push(">>"),this.imageCache.imageStore.length>0){p.push("/XObject"),p.push("<<");for(var c=0;c<this.imageCache.imageStore.length;c++)p.push(w.format("/Image{0} {1} 0 R",c,this.info.xObjectList[c].ref));p.push(">>")}p.push("/Pattern"),p.push("<<"),p.push(w.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(var g=0;g<this.hatchArray.length;g++)p.push(w.format("/PH{0} {1} 0 R",1+g,this.info.patterns.hatchItems[g].ref));for(var g=0;g<this.shadingArray.length;g++)p.push(w.format("/P{0} {1} 0 R",2+g,this.info.patterns.shadingItems[g].ref));p.push(">>"),p.push("/ColorSpace 3 0 R"),t["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&p.push(w.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||p.push(w.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),p.push(">>");for(var h=0;h<p.length;h++)this.sw.writeLine(p[h])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(5),this.sw.writeLine("5 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /StructTreeRoot"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(6),this.sw.writeLine("6 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /OCG"),this.sw.writeLine("/Name (Printable off)"),this.sw.writeLine("/Usage <<"),this.sw.writeLine("/Print << /PrintState /OFF >>"),this.sw.writeLine("/View << /ViewState /ON >>"),this.sw.writeLine(">>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(var u=0;u<n.count;u++){this.addXref(this.info.pageList[u].ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[u].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Page"),this.sw.writeLine("/Parent 4 0 R");var d=n.getByIndex(u),S=this.hiToTwips*i.unit.convertToHInches(d.pageHeight*d.segmentPerHeight),f=this.hiToTwips*i.unit.convertToHInches(d.pageWidth*d.segmentPerWidth);if(S>14400&&(S=14400),f>14400&&(f=14400),this.sw.writeLine1("/MediaBox [ 0 0 {0} {1} ]",this.convertToString(f),this.convertToString(S)),!t["StiOptions"].Export.Pdf.allowInheritedPageResources){var p;(p=[]).push("/Resources"),p.push("<<"),p.push("/ProcSet [/PDF /Text /ImageC]"),p.push("/Font"),p.push("<<");for(var c=0;c<this.fontsCounter;c++)p.push(w.format("/F{0} {1} 0 R",c,this.info.fontList[c].ref));if(p.push(">>"),this.imageCache.imageStore.length>0){p.push("/XObject"),p.push("<<");for(var c=0;c<this.imageCache.imageStore.length;c++)p.push(w.format("/Image{0} {1} 0 R",c,this.info.xObjectList[c].ref));p.push(">>")}var v=new P;v.append(w.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(var g=0;g<this.hatchArray.length;g++)v.append(w.format("/PH{0} {1} 0 R",1+g,this.info.patterns.hatchItems[g].ref));for(var g=0;g<this.shadingArray.length;g++){var E;this.shadingArray[g].Page==u&&v.append(w.format("/P{0} {1} 0 R",2+g,this.info.patterns.shadingItems[g].ref))}p.push("/Pattern << "+v.toString()+" >>"),p.push("/ColorSpace 3 0 R"),t["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&p.push(w.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||p.push(w.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),p.push(">>");for(var h=0;h<p.length;h++)this.sw.writeLine(p[h])}if(this.sw.writeLine1("/Contents {0} 0 R",this.info.pageList[u].content.ref),this.usePdfA||(this.sw.writeLine("/Group"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Group"),this.sw.writeLine("/S /Transparency"),this.sw.writeLine("/CS /DeviceRGB"),this.sw.writeLine(">>")),this.haveLinks||this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){if(this.sw.writeLine("/Annots ["),this.haveLinks)for(var b=0;b<this.linksCounter;b++){var y;this.linksArray[b].Page==u&&this.sw.writeLine1("{0} 0 R ",this.info.linkList[b].ref)}if(this.haveAnnots){for(var b=0;b<this.annotsCounter;b++){var x;(x=this.annotsArray[b]).Page==u&&this.sw.writeLine1("{0} 0 R ",this.info.acroForm.annots[b].ref)}for(var b=0;b<this.annots2Counter;b++){var x;if((x=this.annots2Array[b]).Page==u)for(var A=0;A<this.info.acroForm.checkBoxes[b].items.length;A++)this.sw.writeLine1("{0} 0 R ",this.info.acroForm.checkBoxes[b].items[A].ref)}}this.sw.writeLine("]")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},et.prototype.renderEndDoc=function(){var e=this.sw.position;this.sw.writeLine("xref"),this.sw.writeLine1("0 {0}",this.xref.stimulsoft.countItems+1),this.sw.writeLine("0000000000 65535 f");for(var i=0;i<this.xref.stimulsoft.countItems;i++)this.sw.writeLine(this.xref[i+1]);this.sw.writeLine("trailer"),this.sw.writeLine("<<"),this.sw.writeLine1("/Size {0}",this.xref.stimulsoft.countItems+1),this.sw.writeLine("/Root 1 0 R"),this.sw.writeLine("/Info 2 0 R"),this.encrypted&&this.sw.writeLine1("/Encrypt {0} 0 R",this.info.encode.ref),this.sw.writeLine1("/ID[<{0}><{0}>]",this.IDValueString),this.sw.writeLine(">>"),this.sw.writeLine("%"+r.StiExportUtils.getReportVersion()),this.sw.writeLine("%"+t.StiVersion.platform()),this.sw.writeLine("startxref"),this.sw.writeLine1("{0}",e),this.sw.writeLine("%%EOF")},et.prototype.renderPageHeader=function(t){this.addXref(this.info.pageList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[t].content.ref),this.sw.writeLine("<<"),this.pageStream=new f,this.pageStream.writeLine("2 J")},et.prototype.renderPageFooter=function(e,i){if(!(t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion)){var n=i/596*1.4,o=e/840*1.4;n>o?n=o:o=n,this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine("1 J 1 j 20 w"),this.setStrokeColor(S.fromArgb(64,100,100,100)),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm 0.707 0.707 -0.707 0.707 0 0 cm 1 0 0 1 -155 -50 cm",this.convertToString(n),this.convertToString(o),this.convertToString(i/2),this.convertToString(e/2)),this.pageStream.writeLine("40 0 m 40 100 l 0 100 m 80 100 l S"),this.pageStream.writeLine("100 0 m 100 70 l 100 45 m 120 65 l 130 72 l 140 68 l S"),this.pageStream.writeLine("170 0 m 170 70 l 169 100 m 171 100 l S"),this.pageStream.writeLine("215 60 m 222 69 l 232 71 l 255 70 l 265 60 l 265 5 l 270 0 l 265 44 m 220 31 l 212 20 l 212 10 l 225 0 l 235 0 l 250 5 l 265 18 l S"),this.pageStream.writeLine("310 0 m 310 100 l S"),this.pageStream.writeLine("Q"),this.popColorFromStack()}if(this.pageStream.position<this.pageStream.length&&this.pageStream.setLength(this.pageStream.position),1==this.compressed){var a=this.pageStream.toArray(),s=r.StiExportUtils.makePdfDeflateStream(a);this.storeMemoryStream2(s,"/Filter [/FlateDecode] /Length {0}")}else this.storeMemoryStream2(this.pageStream,"/Filter [] /Length {0}");this.sw.writeLine(),this.pageStream.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")},et.prototype.renderFontTable=function(){for(var e=0;e<this.fontsCounter;e++){var i=new P;this.pdfFont.currentFont=e;var n=this.pdfFont.fontList[e],o=n.Name;if(t["StiOptions"].Export.Pdf.useAlternativeFontNames&&t["StiOptions"].Export.Pdf.alternativeFontNames.containsKey(o)&&(o=t["StiOptions"].Export.Pdf.alternativeFontNames.get(o)),this.useUnicodeMode){i=new P(o.stimulsoft.replaceAll(" ","#20")),(n.Bold||n.Italic)&&(i.append(","),n.Bold&&i.append("Bold"),n.Italic&&i.append("Italic")),this.embeddedFonts&&i.insert(0,w.format("SR{0}{1}{2}{3}+",String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65))),this.addXref(this.info.fontList[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /Type0"),this.sw.writeLine1("/BaseFont /{0}",i),this.sw.writeLine1("/DescendantFonts [{0} 0 R]",this.info.fontList[e].descendantFont.ref),this.sw.writeLine("/Encoding /Identity-H"),this.sw.writeLine1("/ToUnicode {0} 0 R",this.info.fontList[e].toUnicode.ref),this.sw.writeLine1("/Name /F{0}",e),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].descendantFont.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].descendantFont.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /CIDFontType2"),this.sw.writeLine1("/BaseFont /{0}",i),this.sw.writeLine("/CIDSystemInfo"),this.sw.writeLine("<<"),this.storeStringLine("/Registry","Adobe"),this.storeStringLine("/Ordering","Identity"),this.sw.writeLine("/Supplement 0"),this.sw.writeLine(">>"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[e].fontDescriptor.ref),this.usePdfA&&this.sw.writeLine("/CIDToGIDMap /Identity"),this.sw.writeLine("/W [0 [1000]");for(var a=this.pdfFont.GlyphList,s=a.length,m=l.create(Number,s),c=l.create(Number,s),p=32;p<s;p++)m[p]=a[p],c[p]=p;for(var g=32;g<m.length-1;g++)for(var h=g+1;h<m.length;h++)if(m[g]>m[h]){var u=m[g];m[g]=m[h],m[h]=u;var d=c[g];c[g]=c[h],c[h]=d}var S=new P,v=32;while(v<this.pdfFont.MappedSymbolsCount){S.append(m[v].toString()+" ["),S.append(this.pdfFont.Widths[c[v]-32].toString()),v++;while(v<this.pdfFont.MappedSymbolsCount&&m[v]-1==m[v-1])S.append(" "+this.pdfFont.Widths[c[v]-32].toString()),v++;while(v<this.pdfFont.MappedSymbolsCount&&m[v]==m[v-1])v++;S.append("]"),this.sw.writeLine1("{0}",S),S=new P}null!=this.pdfFont.GlyphWidths&&this.pdfFont.GlyphWidths[65535],this.sw.writeLine("]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].toUnicode.ref);var E="SR+F"+e.toString();this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].toUnicode.ref),this.sw.writeLine("<<");var b=new f;b.writeLine("/CIDInit /ProcSet findresource begin"),b.writeLine("12 dict begin"),b.writeLine("begincmap"),b.writeLine("/CIDSystemInfo"),b.writeLine("<<"),b.writeLine("/Registry (Adobe)"),b.writeLine1("/Ordering ({0})",E),b.writeLine("/Supplement 0"),b.writeLine(">> def"),b.writeLine1("/CMapName /{0} def",E),b.writeLine("/CMapType 2 def"),b.writeLine("1 begincodespacerange"),b.writeLine("<0000> <FFFF>"),b.writeLine("endcodespacerange");var y=this.pdfFont.MappedSymbolsCount-32,x=32;while(y>0){var A=y;A>100&&(A=100),b.writeLine1("{0} beginbfchar",A);for(var T=0;T<A;T++)b.writeLine1("<{0:X4}> <{1:X4}>",this.pdfFont.GlyphList[x],this.pdfFont.UnicodeMapBack[x]),x++;b.writeLine("endbfchar"),y-=A}b.writeLine("endcmap"),b.writeLine("CMapName currentdict /CMap defineresource pop"),b.writeLine("end"),b.writeLine("end"),b.flush();var L=b.toArray();if(b.close(),1==this.compressed){var C=r.StiExportUtils.makePdfDeflateStream(L);this.storeMemoryStream2(C,"/Length {0} /Filter [/FlateDecode] /Length1 "+L.length.toString())}else this.storeMemoryStream4(L,"/Length {0} /Filter [] /Length1 {0}");this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].cIDSet.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].cIDSet.ref),this.sw.writeLine("<<");for(var F=l.create(Boolean,65536+32),B=0,k=0;k<this.pdfFont.GlyphList.length;k++){var R=this.pdfFont.GlyphList[k];65535!=R&&(F[R]=!0,R>B&&(B=R))}if(null!=this.pdfFont.GlyphWidths&&0!=this.pdfFont.GlyphWidths[65535])for(var k=0;k<65535;k++)this.pdfFont.GlyphWidths[k]>0&&0==this.pdfFont.GlyphBackList[k]&&(F[k]=!0,k>B&&(B=k));var I=Math.trunc(B/8)+1,D=l.create(Number,I+1),N=0;while(N<I){var O=8*N,H=0;F[O]&&(H|=128),F[O+1]&&(H|=64),F[O+2]&&(H|=32),F[O+3]&&(H|=16),F[O+4]&&(H|=8),F[O+5]&&(H|=4),F[O+6]&&(H|=2),F[O+7]&&(H|=1),D[N]=H,N++}if(1==this.compressed){var C=r.StiExportUtils.makePdfDeflateStream(D);this.storeMemoryStream2(C,"/Length {0} /Filter [/FlateDecode] /Length1 "+D.length.toString())}else this.storeMemoryStream4(D,"/Length {0} /Filter [] /Length1 "+D.length.toString());this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}else{this.addXref(this.info.fontList[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),1==this.standardPdfFonts?(this.sw.writeLine("/Subtype /Type1"),this.sw.writeLine1("/BaseFont /{0}",n.PdfName)):(this.sw.writeLine("/Subtype /TrueType"),i=new P(this.stringReplace(o," ","#20")),1!=n.Bold&&1!=n.Italic||(i.append(","),1==n.Bold&&i.append("Bold"),1==n.Italic&&i.append("Italic")),this.sw.writeLine1("/BaseFont /{0}",i),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[e].fontDescriptor.ref)),this.sw.writeLine1("/Encoding {0} 0 R",this.info.fontList[e].encoding.ref);for(var M=new P(" "),T=32;T<this.pdfFont.MappedSymbolsCount;T++)M.append(this.pdfFont.Widths[T-32].toString()+" ");if(this.sw.writeLine1("/FirstChar {0}",32),this.sw.writeLine1("/LastChar {0}",this.pdfFont.MappedSymbolsCount-1),this.sw.writeLine1("/Widths [{0}]",M),this.sw.writeLine1("/Name /F{0}",e),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].encoding.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].encoding.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Encoding"),this.sw.writeLine("/BaseEncoding /WinAnsiEncoding"),this.pdfFont.MappedSymbolsCount>this.pdfFont.firstMappedSymbol){for(var W=new P(this.pdfFont.firstMappedSymbol.toString()+" "),T=this.pdfFont.firstMappedSymbol;T<this.pdfFont.MappedSymbolsCount;T++)W.append("/"+this.pdfFont.CharPdfNames[T]);this.sw.writeLine1("/Differences [{0}]",W)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}var U=null;if(this.embeddedFonts){var X=t.Base.StiFontCollection.getBinFont(n.Font.name,n.Font.style);if(null==(U=null!=X?X.data:null)||U.stimulsoft.is(Uint8Array)||(U=null),null==U){var z=(n.Font.style&j.Bold)>0,V=(n.Font.style&j.Italic)>0;z&&V?(null!=(X=t.Base.StiFontCollection.getBinFont(n.Font.name,j.Italic))&&null!=X.data||null!=(X=t.Base.StiFontCollection.getBinFont(n.Font.name,j.Bold))&&null!=X.data||null!=(X=t.Base.StiFontCollection.getBinFont(n.Font.name,j.Regular))&&null!=X.data)&&(U=X.data):(z&&null!=(X=t.Base.StiFontCollection.getBinFont(n.Font.name,j.Regular))&&null!=X.data&&(U=X.data),V&&null!=(X=t.Base.StiFontCollection.getBinFont(n.Font.name,j.Regular))&&null!=X.data&&(U=X.data))}if(null==U){var G=this.report.dictionary.resources.getByName(n.Font.name);null==G&&(G=this.report.dictionary.resources.getByAlias(n.Font.name)),null!=G&&null!=G.content&&G.content.length>0&&(U=new Uint8Array(G.content))}}if(0==this.standardPdfFonts){this.addXref(this.info.fontList[e].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",i),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",this.pdfFont.LLX,this.pdfFont.LLY,this.pdfFont.URX,this.pdfFont.URY),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),1==this.embeddedFonts&&null!=U&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[-1==n.ParentFontNumber?e:n.ParentFontNumber].fontFile2.ref);var Y=1==this.useUnicodeMode;this.pdfComplianceMode!=r.StiPdfComplianceMode.A2&&this.pdfComplianceMode!=r.StiPdfComplianceMode.A3||(Y=!1),Y&&this.sw.writeLine1("/CIDSet {0} 0 R",this.info.fontList[e].cIDSet.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}if(this.embeddedFonts)if(null!=U&&U.length>0&&-1==n.ParentFontNumber){var D;if(this.reduceFontSize)null!=(D=this.pdfFont.reduceFontSize(U,n.Name,!this.fontGlyphsReduceNotNeed[e]))&&(U=D);if(this.addXref(this.info.fontList[e].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].fontFile2.ref),this.sw.writeLine("<<"),1==this.compressedFonts){if(U.stimulsoft.is(Uint8Array)){var C=r.StiExportUtils.makePdfDeflateStream(U);this.storeMemoryStream2(C,"/Length {0} /Filter [/FlateDecode] /Length1 "+U.length.toString())}if(U.stimulsoft.is(f)){var _=U.toArray(),C=r.StiExportUtils.makePdfDeflateStream(_);this.storeMemoryStream2(C,"/Length {0} /Filter [/FlateDecode] /Length1 "+U.length.toString())}}else U.stimulsoft.is(Uint8Array)&&this.storeMemoryStream3(U,"/Length {0} /Filter [] /Length1 "+U.length.toString()),U.stimulsoft.is(f)&&this.storeMemoryStream2(U,"/Length {0} /Filter [] /Length1 "+U.length.toString());this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}else this.addXref(this.info.fontList[e].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].fontFile2.ref),this.sw.writeLine("<< >>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},et.prototype.renderImageTable=function(){if(this.imageCache.imageStore.length>0)for(var t=0;t<this.imageCache.imageStore.length;t++){var e=this.imageCacheIndexToList.get(t),i=this.imageCache.imagePackedStore[t],n=this.imageCache.imageMaskStore[t],o=e.ImageFormat;this.addXref(this.info.xObjectList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine1("/ColorSpace /{0}",o==r.StiImageFormat.Monochrome?"DeviceGray":"DeviceRGB"),this.sw.writeLine1("/Width {0}",e.Width),this.sw.writeLine1("/Height {0}",e.Height),this.sw.writeLine1("/BitsPerComponent {0}",o==r.StiImageFormat.Monochrome?"1":"8"),this.imageInterpolationTable.containsKey(t)&&this.sw.writeLine("/Interpolate true"),null!=n&&this.sw.writeLine1("/SMask {0} 0 R",this.info.xObjectList[t].mask.ref),this.sw.writeLine1("/Name /{0}",e.Name);var a="DCTDecode";this.imageCompressionMethod==r.StiPdfImageCompressionMethod.Flate&&(a="FlateDecode"),null==i&&(i=[56,48,56,48,56,48],a="ASCIIHexDecode");var s="/Length {0} "+w.format("/Filter [/{0}]",a),l=new f;if(l.write(i,0,i.length),this.storeMemoryStream2(l,s),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),null!=n){this.addXref(this.info.xObjectList[t].mask.ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[t].mask.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine("/ColorSpace /DeviceGray"),this.sw.writeLine("/Matte [ 0 0 0 ]"),this.sw.writeLine1("/Width {0}",e.Width),this.sw.writeLine1("/Height {0}",e.Height),this.sw.writeLine("/BitsPerComponent 8"),this.imageInterpolationTable.containsKey(t)&&this.sw.writeLine("/Interpolate true");var m="/Length {0} /Filter /FlateDecode",c=new f;c.write(n,0,n.length),this.storeMemoryStream2(c,m),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}},et.prototype.renderBookmarksTable=function(){if(this.haveBookmarks){this.addXref(this.info.outlines.ref),this.sw.writeLine1("{0} 0 obj",this.info.outlines.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Outlines"),this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Count {0}",1),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(var t=0;t<this.bookmarksCounter;t++){this.addXref(this.info.outlines.items[t].ref);var e=this.bookmarksTree[t];this.sw.writeLine1("{0} 0 obj",this.info.outlines.items[t].ref),this.sw.writeLine("<<"),this.storeStringLine("/Title ",e.Title,!0),-1!=e.Parent&&this.sw.writeLine1("/Parent {0} 0 R",this.info.outlines.items[e.Parent].ref),-1!=e.Prev&&this.sw.writeLine1("/Prev {0} 0 R",this.info.outlines.items[e.Prev].ref),-1!=e.Next&&this.sw.writeLine1("/Next {0} 0 R",this.info.outlines.items[e.Next].ref),-1!=e.First&&this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[e.First].ref),-1!=e.Last&&this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[e.Last].ref),e.Count>0&&(0==t?this.sw.writeLine1("/Count {0}",e.Count):this.sw.writeLine1("/Count {0}",-e.Count)),e.Y>-1&&this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.Page].ref,this.convertToString(e.Y)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}},et.prototype.renderPatternTable=function(){if(this.addXref(this.info.patterns.resources.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.resources.ref),this.sw.writeLine("<< /ProcSet [/PDF] >>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.patterns.first.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.first.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 2 2]"),this.sw.writeLine("/XStep 3"),this.sw.writeLine("/YStep 3"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.pageStream=new f,this.pageStream.writeLine("1 J 1 j 1 w"),this.pageStream.writeLine("1 0 0 RG"),this.pageStream.writeString("1 1 m 1.1 1.1 l S"),this.storeMemoryStream2(this.pageStream,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.hatchArray.length>0)for(var t=0;t<this.hatchArray.length;t++)this.writeHatchPattern(t);if(this.shadingArray.length>0)for(var e=0;e<this.shadingArray.length;e++)this.writeShadingPattern(e);if(this.shadingFunctionArray.length>0){for(var r=0;r<this.shadingFunctionArray.length;r++)this.writeShadingFunction(r);this.sw.writeLine("")}this.pageStream.close()},et.prototype.writeHatchPattern=function(t){var e=this.hatchArray[t],i=e.style;i>53&&(i=53),this.addXref(this.info.patterns.hatchItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.hatchItems[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 1 1]"),this.sw.writeLine("/XStep 1"),this.sw.writeLine("/YStep 1"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.sw.writeLine("/Matrix [5.5 0 0 5.5 0 0]");var n=new f;0!=e.backColor.a&&(n.writeLine1("{0} {1} {2} rg",this.colorTable[e.backColor.r],this.colorTable[e.backColor.g],this.colorTable[e.backColor.b]),n.writeLine("0 0 1 1 re f")),n.writeLine1("{0} {1} {2} rg",this.colorTable[e.foreColor.r],this.colorTable[e.foreColor.g],this.colorTable[e.foreColor.b]),n.writeLine("BI"),n.writeLine("/W 8"),n.writeLine("/H 8"),n.writeLine("/BPC 1"),n.writeLine("/IM true"),n.writeLine("/D [1 0]"),n.writeLine("/F [/AHx]"),n.writeLine("ID"),n.writeLine(r.StiPdfResources.hatchData[i]+">"),n.writeLine("EI"),n.flush(),this.storeMemoryStream2(n,"/Length {0}"),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")},et.prototype.writeShadingPattern=function(t){var e=this.shadingArray[t],r=1,i=1,n=e.Angle;n<0&&(n+=360),n>=270&&n<360&&(n=360-n,i=-1),n>=180&&n<270&&(n-=180,i=-1,r=-1),n>=90&&n<180&&(n=180-n,r=-1),n=n*Math.PI/180;var o=e.X+e.Width/2,a=e.Y+e.Height/2,s=Math.sqrt(e.Width*e.Width+e.Height*e.Height)/2,l=Math.atan2(e.Height,e.Width),m=Math.PI/2-n+l,c=s*Math.sin(m),p=c*Math.cos(n)*r,g=c*Math.sin(n)*i,h=o-p,u=o+p,d=a+g,S=a-g;this.addXref(this.info.patterns.shadingItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/PatternType 2"),this.sw.writeString("/Shading <<"),this.sw.writeString("/ColorSpace /DeviceRGB"),this.sw.writeString("/ShadingType 2"),this.sw.writeString(w.format("/Coords [{0} {1} {2} {3}]",this.convertToString(h),this.convertToString(d),this.convertToString(u),this.convertToString(S))),this.sw.writeString("/Extend [true true]"),this.sw.writeString(w.format("/Function {0} 0 R",this.info.patterns.shadingFunctionItems[e.FunctionIndex].ref)),this.sw.writeString(">> "),this.sw.writeLine(">>"),this.sw.writeLine("endobj")},et.prototype.writeShadingFunction=function(t){var e=this.shadingFunctionArray[t];this.addXref(this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/FunctionType 0"),this.sw.writeString("/Size [3]"),this.sw.writeString("/Decode [0 1 0 1 0 1]"),this.sw.writeString("/Range [0 1 0 1 0 1]"),this.sw.writeString("/BitsPerSample 8"),this.sw.writeString("/Domain [0 1]"),this.sw.writeString(w.format("/Encode [0 {0}]",e.IsGlare?2:1)),this.sw.writeString("/Order 1");var r=new f;r.writeByte(e.Color1.r),r.writeByte(e.Color1.g),r.writeByte(e.Color1.b),r.writeByte(e.Color2.r),r.writeByte(e.Color2.g),r.writeByte(e.Color2.b),r.writeByte(e.Color1.r),r.writeByte(e.Color1.g),r.writeByte(e.Color1.b),this.storeMemoryStream2(r,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj")},et.prototype.renderLinkTable=function(){if(this.haveLinks)for(var t=0;t<this.linksCounter;t++){var e=this.linksArray[t];if(e.Link.stimulsoft.startsWith("##")&&this.tagsArray.stimulsoft.countItems>0)for(var i=e.Link.substr(2),n=0;n<this.tagsArray.stimulsoft.countItems;n++){var o=this.tagsArray[n];if(o.Link==i){e.DestPage=o.Page,e.DestY=o.Y;break}}else if("#"==e.Link.charAt(0)&&this.haveBookmarks){var i;if("%"==(i=e.Link.substr(1)).charAt(0)&&i.length>2){var a=i.lastIndexOf(i.charAt(1));a<i.length-1&&(i=i.substr(a+1))}for(var s=0;s<this.bookmarksCounter;s++){var l=this.bookmarksTree[s];if(l.Title==i){e.DestPage=l.Page,e.DestY=l.Y;break}}}if(this.linksArray[t]=e,this.addXref(this.info.linkList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.linkList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Link"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.sw.writeLine("/Border [0 0 0]"),"#"==e.Link.charAt(0))e.DestY>-1?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.DestPage].ref,this.convertToString(e.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref);else{var m=this.stringReplace(e.Link,"\\","/"),c=m.length>6&&p.isLetter(m,0)&&":"==m.charAt(1)&&"/"==m.charAt(2)||"/"==m.charAt(0)&&p.isLetter(m,1)&&"/"==m.charAt(2);c&&":"==m.charAt(1)&&(m="/"+m.charAt(0)+m.substr(2)),this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),c?(this.sw.writeLine("/S /Launch"),this.sw.writeLine("/F <<"),this.sw.writeLine("/Type /Filespec"),this.storeStringLine("/F ",m),this.storeStringLine("/UF ",m),this.sw.writeLine(">>")):(this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",r.StiExportUtils.stringToUrl(m))),this.sw.writeLine(">>")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},et.prototype.renderAnnotTable=function(){if(this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){this.addXref(this.info.acroForm.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Fields [");for(var e=0;e<this.annotsCounter;e++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.annots[e].ref);for(var e=0;e<this.annots2Counter;e++)for(var i=0;i<this.info.acroForm.checkBoxes[e].items.length;i++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.checkBoxes[e].items[i].ref);for(var e=0;e<this.unsignedSignaturesCounter;e++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.unsignedSignatures[e].ref);this.haveDigitalSignature&&this.sw.writeLine1("{0} 0 R",this.info.acroForm.signatures[0].ref);for(var e=0;e<this.tooltipsCounter;e++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.tooltips[e].ref);if(this.sw.writeLine("]"),this.sw.writeLine("/DR <<"),this.annotsCounter>0||this.annots2Counter>0){
this.sw.writeLine("/Font <<");for(var e=0;e<this.fontsCounter;e++)this.sw.writeLine1("/FA{0} {1} 0 R",e,this.info.acroForm.annotFontItems[e].ref);this.sw.writeLine(">>")}if(this.sw.writeLine(">>"),this.haveAnnots&&this.fontsCounter>0&&this.storeStringLine("/DA ","/FA0 0 Tf 0 g"),this.haveDigitalSignature&&this.sw.writeLine("/SigFlags 3"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.haveAnnots){for(var n=new T,e=0;e<this.annotsCounter;e++){var o=this.annotsArray[e],a="";if(t["StiOptions"].Export.Pdf.useEditableFieldName&&(a=o.Component.name),t["StiOptions"].Export.Pdf.useEditableFieldAlias&&(a=o.Component.alias),t["StiOptions"].Export.Pdf.useEditableFieldTag&&(a=o.Component.tagValue),w.isNullOrEmpty(a)&&(a=w.format("Field{0}",e)),n.containsKey(a)){var s=2,l="";while(n.containsKey(a+l))l="_"+s.toString(),s++;a+=l}n.add(a,a),this.addXref(this.info.acroForm.annots[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.X+o.Width),this.convertToString(o.Y+o.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[o.Page].ref),this.sw.writeLine("/FT /Tx"),this.sw.writeLine("/BS << /W 0 >>"),this.storeStringLine("/T ",a),this.sw.writeLine("/MK << /TP 2 >>"),this.sw.writeLine("/H /P"),this.sw.writeLine1("/AP << /N {0} 0 R >>",this.info.acroForm.annots[e].aP.ref);var m=o.Multiline?4096:0,c;null!=o.Component.as(L)&&null!=o.Component.as(L).TextOptions&&o.Component.as(L).TextOptions.LineLimit&&(m|=8388608),this.sw.writeLine1("/Ff {0}",m),this.storeStringLine("/DA ",w.format("/FA{0} {1} Tf {2} {3} {4} rg",o.FontNumber,this.convertToString(o.FontSize,this.precision_digits_font),this.colorTable[o.FontColor.r],this.colorTable[o.FontColor.g],this.colorTable[o.FontColor.b])),this.storeStringLine("/V ",o.Text),this.storeStringLine("/DV ",o.Text),this.sw.writeLine1("/Q {0}",(o.Alignment==t.Base.Drawing.StiTextHorAlignment.Center?1:0)+(o.Alignment==t.Base.Drawing.StiTextHorAlignment.Right?2:0)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annots[e].aP.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[e].aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(o.Width),this.convertToString(o.Height)),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF /Text ]"),this.sw.writeLine1("/Font << /F{0} {1} 0 R >> >>",o.FontNumber,this.info.fontList[o.FontNumber].ref),(c=new f).writeLine("/Tx BMC"),c.writeLine("q");var p=1;c.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(p),this.convertToString(p),this.convertToString(o.Width-p),this.convertToString(o.Height-p)),c.flush(),c.write(o.Content,0,o.Content.length),c.writeLine("Q"),c.writeLine("EMC"),c.flush(),this.storeMemoryStream2(c,"/Filter [] /Length {0}"),this.sw.writeLine(""),c.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(var g=0;g<this.fontsCounter;g++){this.pdfFont.currentFont=g;var h=this.pdfFont.fontList[g],u=h.Name;t["StiOptions"].Export.Pdf.useAlternativeFontNames&&t["StiOptions"].Export.Pdf.alternativeFontNames.containsKey(u)&&(u=t["StiOptions"].Export.Pdf.alternativeFontNames.get(u));var d=new P(this.stringReplace(u," ","#20"));if((h.Bold||h.Italic)&&(d.append(","),h.Bold&&d.append("Bold"),h.Italic&&d.append("Italic")),this.addXref(this.info.acroForm.annotFontItems[g].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[g].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /TrueType"),this.sw.writeLine1("/Name /FA{0}",g),this.sw.writeLine1("/BaseFont /{0}",d),this.sw.writeLine("/Encoding /WinAnsiEncoding"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.acroForm.annotFontItems[g].fontDescriptor.ref),this.fontGlyphsReduceNotNeed[g]){for(var S=new P(" "),v=32;v<256;v++)S.append(this.pdfFont.Widths[this.pdfFont.UnicodeMap[this.CodePage1252[v]]-32].toString()+" ");this.sw.writeLine("/FirstChar 32"),this.sw.writeLine("/LastChar 255"),this.sw.writeLine1("/Widths [{0}]",S)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annotFontItems[g].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[g].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",d),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",-this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",-500,-200,1500,1e3),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),1==this.embeddedFonts&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[g].fontFile2.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(var e=0;e<this.annots2Counter;e++){var o=this.annots2Array[e],a="";if(t["StiOptions"].Export.Pdf.useEditableFieldName&&(a=o.Component.name),t["StiOptions"].Export.Pdf.useEditableFieldAlias&&(a=o.Component.alias),t["StiOptions"].Export.Pdf.useEditableFieldTag&&(a=o.Component.tagValue),w.isNullOrEmpty(a)&&(a=w.format("Checkbox{0}",e+1)),n.containsKey(a)){var s=2,l="";while(n.containsKey(a+l))l="_"+s.toString(),s++;a+=l}n.add(a,a);var E=.01,b=o.Component.as(V),y=r.StiPdfRenderPrimitives.getCheckBoxValue(b);if(null==y&&(y=!1),this.info.acroForm.checkBoxes[e].items.length>1){var x=this.info.acroForm.checkBoxes[e].items[0],c;this.addXref(x.ref),this.sw.writeLine1("{0} 0 obj",x.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.X+o.Width-E),this.convertToString(o.Y+o.Height-E)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[e].items.length||0==y?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[o.Page].ref),this.storeStringLine("/T ",a+"Yes"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",x.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",x.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aP.ref),this.sw.writeLine1("{0} 0 obj",x.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(o.Width),this.convertToString(o.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(var A=0;A<this.hatchArray.length;A++)this.sw.writeLine1(w.format("/PH{0} {1} 0 R",1+A,this.info.patterns.hatchItems[A].ref));for(var A=0;A<this.shadingArray.length;A++)this.sw.writeLine1(w.format("/P{0} {1} 0 R",2+A,this.info.patterns.shadingItems[A].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),(c=new f).writeLine("/Tx BMC"),c.writeLine("q");var p=1;c.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(p),this.convertToString(p),this.convertToString(o.Width-p),this.convertToString(o.Height-p)),c.flush(),c.write(o.Content,0,o.Content.length),c.writeLine("Q"),c.writeLine("EMC"),c.flush(),this.storeMemoryStream2(c,"/Filter [] /Length {0}"),this.sw.writeLine(""),c.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aA[0].ref),this.sw.writeLine1("{0} 0 obj",x.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",x.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",a+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aA[1].ref),this.sw.writeLine1("{0} 0 obj",x.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",a+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),x=this.info.acroForm.checkBoxes[e].items[1],this.addXref(x.ref),this.sw.writeLine1("{0} 0 obj",x.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.X+o.Width-E),this.convertToString(o.Y+o.Height-E)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[e].items.length||1==y?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[o.Page].ref),this.storeStringLine("/T ",a+"No"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",x.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",x.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aP.ref),this.sw.writeLine1("{0} 0 obj",x.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(o.Width),this.convertToString(o.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(var A=0;A<this.hatchArray.length;A++)this.sw.writeLine1(w.format("/PH{0} {1} 0 R",1+A,this.info.patterns.hatchItems[A].ref));for(var A=0;A<this.shadingArray.length;A++)this.sw.writeLine1(w.format("/P{0} {1} 0 R",2+A,this.info.patterns.shadingItems[A].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),(c=new f).writeLine("/Tx BMC"),c.writeLine("q"),p=1,c.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(p),this.convertToString(p),this.convertToString(o.Width-p),this.convertToString(o.Height-p)),c.flush(),c.write(o.Content2,0,o.Content2.length),c.writeLine("Q"),c.writeLine("EMC"),c.flush(),this.storeMemoryStream2(c,"/Filter [] /Length {0}"),this.sw.writeLine(""),c.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aA[0].ref),this.sw.writeLine1("{0} 0 obj",x.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine1("/Next {0} 0 R",x.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",a+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aA[1].ref),this.sw.writeLine1("{0} 0 obj",x.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",a+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}if(3==this.info.acroForm.checkBoxes[e].items.length){var x=this.info.acroForm.checkBoxes[e].items[2];this.addXref(x.ref),this.sw.writeLine1("{0} 0 obj",x.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.X+o.Width-E),this.convertToString(o.Y+o.Height-E)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[o.Page].ref),this.storeStringLine("/T ",a+"None"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",x.aA[0].ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aA[0].ref),this.sw.writeLine1("{0} 0 obj",x.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",x.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",a+"None"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(x.aA[1].ref),this.sw.writeLine1("{0} 0 obj",x.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",a+(b.checkStyleForTrue==t.Report.Components.StiCheckStyle.None?"No":"Yes")),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}for(var e=0;e<this.unsignedSignaturesCounter;e++){var o=this.unsignedSignaturesArray[e],a="";if(t["StiOptions"].Export.Pdf.useEditableFieldName&&(a=o.Component.name),t["StiOptions"].Export.Pdf.useEditableFieldAlias&&(a=o.Component.alias),t["StiOptions"].Export.Pdf.useEditableFieldTag&&(a=o.Component.tagValue),w.isNullOrEmpty(a)&&(a=w.format("UnsignedSignature{0}",e)),n.containsKey(a)){var s=2,l="";while(n.containsKey(a+l))l="_"+s.toString(),s++;a+=l}n.add(a,a);var C=this.info.acroForm.unsignedSignatures[e].ref;this.addXref(C),this.sw.writeLine1("{0} 0 obj",C),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(o.X),this.convertToString(o.Y),this.convertToString(o.X+o.Width),this.convertToString(o.Y+o.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[o.Page].ref),this.sw.writeLine("/FT /Sig"),this.storeStringLine("/T ",a),this.sw.writeLine("/MK << >>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}},et.prototype.renderTooltipTable=function(){if(this.haveTooltips)for(var t=0;t<this.tooltipsCounter;t++){for(var e=this.tooltipsArray[t],i=!1,n=new Z,o=0;o<this.linksCounter;o++)if((n=this.linksArray[o]).X==e.X&&n.Y==e.Y&&n.Width==e.Width&&n.Height==e.Height&&n.Page-1==e.Page){i=!0;break}this.addXref(this.info.acroForm.tooltips[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.tooltips[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.storeStringLine("/TU ",e.Link),this.sw.writeLine("/F 0"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",w.format("Tooltip{0}",t)),this.sw.writeLine("/FT /Btn"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine("/H /N"),this.sw.writeLine("/AP <<"),this.sw.writeLine(">>"),i&&("#"==n.Link.charAt(0)?n.DestY>-1?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[n.DestPage].ref,this.convertToString(n.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref):(this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",r.StiExportUtils.stringToUrl(this.stringReplace(n.Link,"\\","/"))),this.sw.writeLine(">>"))),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}},et.prototype.renderEncodeRecord=function(){this.encrypted&&(this.addXref(this.info.encode.ref),this.sw.writeLine1("{0} 0 obj",this.info.encode.ref),this.sw.writeLine("<<"),this.pdfSecurity.renderEncodeRecord(this.sw),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))},et.prototype.renderExtGStateRecord=function(){this.addXref(this.info.extGState.ref),this.sw.writeLine1("{0} 0 obj",this.info.extGState.ref),this.sw.writeLine("<<");for(var t=0;t<256;t++)if(this.alphaTable[t]){var e=w.format("{0:X2}",t).toUpperCase();this.sw.writeLine1("/GS{0}S <</Type /ExtGState /BM /Normal /CA {1}>>",e,this.colorTable[t]),this.sw.writeLine1("/GS{0}N <</Type /ExtGState /BM /Normal /ca {1}>>",e,this.colorTable[t])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")},et.prototype.storeImageData=function(e,r,i,n,o){void 0===o&&(o=!1),null!=e&&e.tryConvertSync(t.System.Drawing.Imaging.ImageFormat.Jpeg);var a=this.imageCache.addImageInt(e),s=new q;return null!=e&&null!=e.bytes?(s.Width=e.width,s.Height=e.height):(s.Width=1,s.Height=1),s.Name=w.format("Image{0}",a),s.ImageFormat=this.imageFormat,this.imageList.push(s),this.imageCacheIndexToList.set(a,s),n&&this.imageInterpolationTable.set(a,!0),r},et.prototype.storeImageDataForGeom=function(t){var e=t.imageToDraw.horizontalResolution/100;this.imageResolutionMode==r.StiImageResolutionMode.NoMoreThan&&(e=t.stretch?t.imageToDraw.width/this.report.unit.convertToHInches(t.width):1/t.multipleFactor),e=this.storeImageData(t.imageToDraw,e,!0,t.smoothing),this.imageInfoList.set(this.imageInfoCounter,e)},et.prototype.writeImageInfo=function(t,e){var i=this.imageList[this.imagesCurrent];this.imagesCurrent++;var n=t.Component.as(M);if(this.imageResolutionMode!=r.StiImageResolutionMode.Exactly&&null!=n&&!n.margins.isEmpty){var o=this.hiToTwips*n.margins.left,a=this.hiToTwips*n.margins.right,s=this.hiToTwips*n.margins.top,l=this.hiToTwips*n.margins.bottom;0!=o&&(t.X+=o,t.Width-=o),0!=l&&(t.Y+=l,t.Height-=l),0!=a&&(t.Width-=a),0!=s&&(t.Height-=s)}var m=h.None;null!=n&&(m=n.imageRotation);var c=i.Width,p=i.Height;m!=h.Rotate90CCW&&m!=h.Rotate90CW||(c=i.Height,p=i.Width);var g=t.X,w=t.Y,u=this.hiToTwips*(c-1)/e,d=this.hiToTwips*(p-1)/e,f=!1;if(this.imageResolutionMode!=r.StiImageResolutionMode.Exactly&&null!=n&&null!=n.imageToDraw){var v=n.imageToDraw,E=n.getPaintRectangle(!0,!1);E=n.convertImageMargins(E,!1);var b=new W(0,0,E.width,E.height);if(n.stretch){var y=c,x=p;if(null==v&&(y=1,x=1),n.aspectRatio){var A=b.width/y,T=b.height/x;switch(A>T?b.width=y*T:b.height=x*A,n.vertAlignment){case X.Center:b.y=(E.height-b.height)/2;break;case X.Top:b.y=E.height-b.height;break}switch(n.horAlignment){case U.Center:b.x=(E.width-b.width)/2;break;case U.Right:b.x=E.width-b.width;break}g+=b.x*this.hiToTwips,w+=b.y*this.hiToTwips,u=b.width*this.hiToTwips,d=b.height*this.hiToTwips}else u=t.Width,d=t.Height}else{var y=c*n.multipleFactor,x=p*n.multipleFactor;switch(null!=v&&null!=v.bytes||(y=1,x=1),b.width=y,b.height=x,n.horAlignment){case U.Center:b.x=(E.width-y)/2;break;case U.Right:b.x=E.width-y;break}switch(n.vertAlignment){case X.Center:b.y=(E.height-x)/2;break;case X.Top:b.y=E.height-x;break}g+=b.x*this.hiToTwips,w+=b.y*this.hiToTwips,u=b.width*this.hiToTwips,d=b.height*this.hiToTwips,f=!0}}this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(S.black),f&&this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(t.X),this.convertToString(t.Y),this.convertToString(t.Width),this.convertToString(t.Height)),m==h.None?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(u),this.convertToString(d),this.convertToString(g),this.convertToString(w)):(this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(g+u/2),this.convertToString(w+d/2)),m==h.Rotate90CCW&&this.pageStream.writeLine("0 1 -1 0 0 0 cm"),m==h.Rotate90CW&&this.pageStream.writeLine("0 -1 1 0 0 0 cm"),m==h.Rotate180&&this.pageStream.writeLine("-1 0 0 -1 0 0 cm"),m==h.FlipHorizontal&&this.pageStream.writeLine("-1 0 0 1 0 0 cm"),m==h.FlipVertical&&this.pageStream.writeLine("1 0 0 -1 0 0 cm"),m==h.Rotate90CCW||m==h.Rotate90CW?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(d),this.convertToString(u),this.convertToString(-d/2),this.convertToString(-u/2)):this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(u),this.convertToString(d),this.convertToString(-u/2),this.convertToString(-d/2))),this.pageStream.writeLine1("/{0} Do",i.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()},et.prototype.writeImageInfo2=function(t,e,r){var i=this.imageList[this.imagesCurrent];this.imagesCurrent++,this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(S.black),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(this.hiToTwips*i.Width/e),this.convertToString(this.hiToTwips*i.Height/r),this.convertToString(t.X),this.convertToString(t.Y)),this.pageStream.writeLine1("/{0} Do",i.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()},et.prototype.renderImage=function(t,r){if(this.imageInfoList.containsKey(this.imageInfoCounter)){var i=this.imageInfoList.get(this.imageInfoCounter);this.writeImageInfo(t,i)}else{var n=t.Component.as(z);if(null!=n&&t.Component.isExportAsImage(e.StiExportFormat.Pdf)){var i,o={ref:i=r},a=n.getImage(o,e.StiExportFormat.Pdf);i=o.ref,null!=a&&null!=a.bytes&&this.writeImageInfo(t,i)}}},et.prototype.renderWatermark=function(e,i,n,o,a){var s=e.watermark;if(null!=s&&s.enabled){if(null!=s.image&&s.showImageBehind==i){var l=this.imageList[this.imagesCurrent],m=l.Width*this.hiToTwips*s.imageMultipleFactor,c=l.Height*this.hiToTwips*s.imageMultipleFactor,p=0,g=0,h=1,u=1,d=s.imageAlignment,f=s.imageTiling;if(s.imageStretch){var v=c/m;m=n,c=o,f=!1,s.aspectRatio&&(o/n>v?c=m*v:m=c/v)}switch((s.imageStretch||s.imageMultipleFactor>1)&&this.imageInterpolationTable.set(this.imageCache.imageIndex[this.imagesCurrent],!0),f&&(d=t.System.Drawing.ContentAlignment.TopLeft,h=Math.round2(n/m)+1,u=Math.round2(o/c)+1),d){case t.System.Drawing.ContentAlignment.TopCenter:case t.System.Drawing.ContentAlignment.MiddleCenter:case t.System.Drawing.ContentAlignment.BottomCenter:p=(n-m)/2;break;case t.System.Drawing.ContentAlignment.TopRight:case t.System.Drawing.ContentAlignment.MiddleRight:case t.System.Drawing.ContentAlignment.BottomRight:p=n-m;break}switch(d){case t.System.Drawing.ContentAlignment.TopLeft:case t.System.Drawing.ContentAlignment.TopCenter:case t.System.Drawing.ContentAlignment.TopRight:g=o-c;break;case t.System.Drawing.ContentAlignment.MiddleLeft:case t.System.Drawing.ContentAlignment.MiddleCenter:case t.System.Drawing.ContentAlignment.MiddleRight:g=(o-c)/2;break}this.setNonStrokeColor(S.fromArgb(255-s.imageTransparency,S.black));for(var E=0;E<u;E++)for(var b=0;b<h;b++)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(m),this.convertToString(c),this.convertToString(p+m*b),this.convertToString(g-c*E)),this.pageStream.writeLine1("/{0} Do",l.Name),this.pageStream.writeLine("Q"),this.popColorFromStack();this.imagesCurrent++}if(!w.isNullOrEmpty(s.text)&&s.showBehind==i){var y=new _(this);y.X=0,y.Y=0,y.Width=n,y.Height=o;var x=new L(new W(y.X,y.Y,y.Width,y.Height));x.text=s.text,x.textBrush=s.textBrush,x.font=s.font,x.textOptions=new t.Base.Drawing.StiTextOptions,x.textOptions.angle=s.angle,x.horAlignment=t.Base.Drawing.StiTextHorAlignment.Center,x.vertAlignment=X.Center,x.page=e,x.textQuality=t.Report.Components.StiTextQuality.Standard,y.Component=x,r.StiPdfRenderText.renderTextFont(y),r.StiPdfRenderText.renderText(y)}}},et.prototype.storeShadingData1=function(t,e){if(null!=t){if(t.is(b)){var r=t,i;(i=new K).Angle=r.angle,i.Page=e,i.FunctionIndex=this.getShadingFunctionNumber(r.startColor,r.endColor,!1),this.shadingArray.push(i)}if(t.is(y)){var r=t,i;(i=new K).Angle=r.angle,i.FunctionIndex=this.getShadingFunctionNumber(r.startColor,r.endColor,!0),i.Page=e,this.shadingArray.push(i)}}},et.prototype.storeShadingData2=function(t,e,r,i,n){if(null!=n&&(n.is(b)||n.is(y))){var o=this.shadingArray[this.shadingCurrent];o.X=t,o.Y=e,o.Width=r,o.Height=i,this.shadingArray[this.shadingCurrent]=o,this.shadingCurrent++}return this.shadingCurrent},et.prototype.storeHatchData=function(t){var e;null!=t&&(t.is(x)&&this.getHatchNumber(t),t.is(A)&&t.as(A).drawHatch)},et.prototype.renderMetadata=function(e){var i,n,o,a,s=new f,l='<?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?>\r\n';s.writeString(l);var m=new f,c=new N(t.System.Text.Encoding.UTF8,m);if(c.formatting=t.System.Xml.Formatting.Indented,c.writeStartElement("x:xmpmeta"),c.writeAttributeString("xmlns:x","adobe:ns:meta/"),c.writeAttributeString("x:xmptk","Adobe XMP Core 4.0-c316 44.253921, Sun Oct 01 2006 17:14:39"),c.writeStartElement("rdf:RDF"),c.writeAttributeString("xmlns:rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),c.writeStartElement("rdf:Description"),c.writeAttributeString("rdf:about",""),c.writeAttributeString("xmlns:xap","http://ns.adobe.com/xap/1.0/"),c.writeElementString("xap:ModifyDate",this.currentDateTimeMeta),c.writeElementString("xap:CreateDate",this.currentDateTimeMeta),c.writeElementString("xap:MetadataDate",this.currentDateTimeMeta),c.writeElementString("xap:CreatorTool",t["StiOptions"].Export.Pdf.creatorString),c.writeFullEndElement(),c.writeStartElement("rdf:Description"),c.writeAttributeString("rdf:about",""),c.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),c.writeElementString("dc:format","application/pdf"),c.writeStartElement("dc:title"),c.writeStartElement("rdf:Alt"),w.isNullOrEmpty(e.reportName)||(c.writeStartElement("rdf:li"),c.writeAttributeString("xml:lang","x-default"),c.writeString(e.reportName),c.writeFullEndElement()),c.writeEndElement(),c.writeFullEndElement(),c.writeStartElement("dc:description"),c.writeStartElement("rdf:Alt"),w.isNullOrEmpty(e.reportAlias)||(c.writeStartElement("rdf:li"),c.writeAttributeString("xml:lang","x-default"),c.writeString(e.reportAlias),c.writeFullEndElement()),c.writeEndElement(),c.writeFullEndElement(),c.writeStartElement("dc:creator"),c.writeStartElement("rdf:Seq"),w.isNullOrEmpty(e.reportAuthor)||(c.writeStartElement("rdf:li"),c.writeAttributeString("xml:lang","x-default"),c.writeString(e.reportAuthor),c.writeFullEndElement()),c.writeEndElement(),c.writeFullEndElement(),c.writeStartElement("dc:subject"),c.writeStartElement("rdf:Bag"),!w.isNullOrEmpty(this.keywords)){var p=this.keywords.split(";");try{for(var g=__values(p),h=g.next();!h.done;h=g.next()){var u=h.value;c.writeStartElement("rdf:li"),c.writeString(u.trim()),c.writeFullEndElement()}}catch(t){i={error:t}}finally{try{h&&!h.done&&(n=g.return)&&n.call(g)}finally{if(i)throw i.error}}}c.writeEndElement(),c.writeFullEndElement(),c.writeFullEndElement(),c.writeStartElement("rdf:Description"),c.writeAttributeString("rdf:about",""),c.writeAttributeString("xmlns:xapMM","http://ns.adobe.com/xap/1.0/mm/"),c.writeElementString("xapMM:DocumentID",this.IDValueStringMeta),c.writeElementString("xapMM:InstanceID",this.IDValueStringMeta),c.writeFullEndElement(),c.writeStartElement("rdf:Description"),c.writeAttributeString("rdf:about",""),c.writeAttributeString("xmlns:pdf","http://ns.adobe.com/pdf/1.3/"),c.writeAttributeString("xmlns:pdfx","http://ns.adobe.com/pdf/1.3/"),c.writeElementString("pdf:Producer",this.producerName),c.writeElementString("pdf:Keywords",this.keywords);try{for(var d=__values(e.metaTags.list),S=d.next();!S.done;S=d.next()){var v=S.value;v.name.stimulsoft.startsWith("pdf:")&&c.writeElementString("pdfx:"+v.name.substr(4),v.tag)}}catch(t){o={error:t}}finally{try{S&&!S.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}if(c.writeFullEndElement(),this.usePdfA){c.writeStartElement("rdf:Description"),c.writeAttributeString("rdf:about",""),c.writeAttributeString("xmlns:pdfaid","http://www.aiim.org/pdfa/ns/id/");var E="1";switch(this.pdfComplianceMode){case r.StiPdfComplianceMode.A1:E="1";break;case r.StiPdfComplianceMode.A2:E="2";break;case r.StiPdfComplianceMode.A3:E="3";break}c.writeElementString("pdfaid:part",E),c.writeElementString("pdfaid:conformance","A"),c.writeFullEndElement()}c.writeFullEndElement(),c.writeFullEndElement(),c.writeString("                              \r\n"),c.writeString("                              \r\n"),c.writeString("                              \r\n"),c.writeString("                              \r\n"),c.writeString("                              \r\n");var b=m.toArray();c.close(),m.close(),s.write(b,0,b.length),s.writeString('<?xpacket end="w"?>'),this.addXref(this.info.metadata.ref),this.sw.writeLine1("{0} 0 obj",this.info.metadata.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Metadata"),this.sw.writeLine("/Subtype /XML"),this.storeMemoryStream2(s,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")},et.prototype.renderColorSpace=function(){this.addXref(this.info.destOutputProfile.ref),this.sw.writeLine1("{0} 0 obj",this.info.destOutputProfile.ref),this.sw.writeLine("<<"),this.sw.writeLine("/N 3");var t=null,e=null;1==this.compressed?(t=r.StiExportUtils.makePdfDeflateStream(r.StiPdfResources.sRGBprofile),e="/Length {0} /Filter [/FlateDecode] /Length1 "+r.StiPdfResources.sRGBprofile.length.toString(),this.storeMemoryStream2(t,e)):((t=new f).write(r.StiPdfResources.sRGBprofile,0,r.StiPdfResources.sRGBprofile.length),e="/Length {0}",this.storeMemoryStream2(t,e)),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.outputIntents.ref),this.sw.writeLine1("{0} 0 obj",this.info.outputIntents.ref),this.sw.writeLine("[<<"),this.storeStringLine("/Info","sRGB IEC61966-2.1"),this.storeStringLine("/OutputConditionIdentifier","Custom"),this.storeStringLine("/OutputCondition",""),this.storeStringLine("/RegistryName",""),this.sw.writeLine("/S /GTS_PDFA1"),this.sw.writeLine1("/DestOutputProfile {0} 0 R",this.info.destOutputProfile.ref),this.sw.writeLine("/Type /OutputIntent"),this.sw.writeLine(">>]"),this.sw.writeLine("endobj"),this.sw.writeLine("")},et.prototype.renderAutoPrint=function(){this.autoPrint!=r.StiPdfAutoPrintMode.None&&(this.addXref(this.info.embeddedJS.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Names [(EmbeddedJS) {0} 0 R]",this.info.embeddedJS.content.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedJS.content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.content.ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /JavaScript"),this.sw.writeLine1("/JS (print\\({0}\\);)",this.autoPrint==r.StiPdfAutoPrintMode.Dialog?"true":"false"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))},et.prototype.addBookmarkNode=function(t,e){var r=new $;r.Parent=-1,r.First=-1,r.Last=-1,r.Prev=-1,r.Next=-1,r.Count=-1,r.Page=-1,r.Y=-1,r.Title="",r.Guid="",r.Used=-1==e,this.bookmarksTree.push(r);var i=this.bookmarksTree.stimulsoft.countItems-1;if(r.Parent=e,r.Title=t.text,r.Guid=t.componentGuid,0==t.bookmarks.count)r.Count=0;else{for(var n=-1,o=0;o<=t.bookmarks.count-1;o++){var a=this.bookmarksTree.stimulsoft.countItems,s=t.bookmarks.list[o];this.addBookmarkNode(s,i);var l=this.bookmarksTree[a];o<t.bookmarks.count-1&&(l.Next=this.bookmarksTree.stimulsoft.countItems),o>0&&(l.Prev=n),this.bookmarksTree[a]=l,n=a}r.First=i+1,r.Last=this.bookmarksTree.stimulsoft.countItems-1,r.Count=this.bookmarksTree.stimulsoft.countItems-i-1}this.bookmarksTree[i]=r},et.prototype.makeBookmarkFromTree=function(t,e){if(t.text=e.Title,t.bookmarks=new m,e.Count>0){var r=e.First;while(-1!=r){var i=this.bookmarksTree[r];if(i.Used){var n=new c;t.bookmarks.add(n),this.makeBookmarkFromTree(n,i)}r=i.Next}}},et.prototype.exportPdf=function(t,e,r){try{this.exportPdf1(t,e,r)}finally{}},et.prototype.exportPdf1=function(m,p,h){var u,d,S,f,b,y,x,A,N,M;if(null==h)throw new Error("The 'settings' argument cannot be equal in null.");this.report=m;var W=h.pageRange,U=h.imageResolution;this.imageResolutionMode=h.imageResolutionMode,this.imageQuality=h.imageQuality,this.embeddedFonts=h.embeddedFonts,this.standardPdfFonts=!!h.standardPdfFonts,this.compressed=!!h.compressed,this.useUnicodeMode=h.useUnicode;var X=h.passwordInputUser,j=h.passwordInputOwner,q=h.userAccessPrivileges;this.keyLength=h.keyLength,this.pdfComplianceMode=h.pdfComplianceMode,this.autoPrint=h.autoPrintMode,this.allowEditable=h.allowEditable,this.creatorName=t["StiOptions"].Export.Pdf.creatorString,this.keywords=t["StiOptions"].Export.Pdf.keywordsString,w.isNullOrEmpty(h.creatorString)||(this.creatorName=h.creatorString),w.isNullOrEmpty(h.keywordsString)||(this.keywords=h.keywordsString),w.isNullOrEmpty(this.creatorName)&&(this.creatorName=this.producerName),this.usePdfA=this.pdfComplianceMode!=r.StiPdfComplianceMode.None,this.useTransparency=this.pdfComplianceMode!=r.StiPdfComplianceMode.A1,this.compressed=!0,this.compressedFonts=!0,this.usePdfA&&(this.standardPdfFonts=!1,this.embeddedFonts=!0,this.useUnicodeMode=!0);var Q=W.rangeType!=e.StiRangeType.All,tt=!this.usePdfA;this.embeddedFonts&&(this.standardPdfFonts=!1),this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.useUnicodeMode&&(this.standardPdfFonts=!1),U<10&&(U=10),U/=100,this.imageResolutionMain=U,this.bidi=new r.StiBidirectionalConvert(!0),this.pdfFont=new r.PdfFonts,this.pdfFont.standardPdfFonts=this.standardPdfFonts,this.pdfFont.useUnicode=this.useUnicodeMode,this.fontGlyphsReduceNotNeed=null;for(var et=0;et<=255;et++){var rt,it=Math.round2(et/255,3).toString().split(",").join(t.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator);this.colorTable[et]=it,this.alphaTable[et]=!1}switch(this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=new Array,this.imageList=new Array,this.imageCompressionMethod){case r.StiPdfImageCompressionMethod.Flate:this.imageCache=new e.StiImageCache(!0,!0,e.ImageFormat.MemoryBmp,this.imageQuality,tt);break;default:this.imageCache=new e.StiImageCache(!0,!0,e.ImageFormat.Jpeg,this.imageQuality,tt);break}this.imageInterpolationTable=new T,this.imageCacheIndexToList=new T,this.imageInfoList=new T,this.imageInfoCounter=0,this.pdfFont.fontList=new Array,this.xref=new Array,this.bookmarksTree=new Array,this.haveBookmarks=!1,this.linksArray=new Array,this.annotsArray=new Array,this.annots2Array=new Array,this.unsignedSignaturesArray=new Array,this.shadingArray=new Array,this.shadingFunctionArray=new Array,this.hatchArray=new Array,this.tooltipsArray=new Array,this.sw=p,this.fontsCounter=0,this.bookmarksCounter=0,this.linksCounter=0,this.annotsCounter=0,this.annots2Counter=0,this.tooltipsCounter=0;for(var nt=0;nt<256;nt++)this.CodePage1252[nt]=nt;for(var nt=0;nt<32;nt++)this.CodePage1252[128+nt]=this.CodePage1252part80AF[nt];this.fontGlyphsReduceNotNeed=l.create(Boolean,256);var ot=O.now,at=ot.toString("yyyyMMddHHmmsszzz");this.currentDateTime=at.substr(0,17)+"'"+at.substr(18,2)+"'",this.currentDateTimeMeta=ot.toString("yyyy-MM-ddTHH:mm:sszzz");var st=ot.toString("yyyyMMddHHmmssffff");st+=this.producerName,st+=this.creatorName,st+=m.reportAuthor,st+=m.reportAlias,st+=m.reportName;for(var lt="",nt=0;nt<st.length;nt++)lt+=String.fromCharCode(255&st.charCodeAt(nt));this.IDValue=t.Base.StiMD5Helper.MD5(lt,!1);for(var mt="",nt=0;nt<this.IDValue.length;nt++)mt+=r.StiExportUtils.toHex(this.IDValue[nt]);this.IDValueString=mt,this.IDValueStringMeta=w.format("uuid:{0}-{1}-{2}-{3}-{4}",this.IDValueString.substring(0,8),this.IDValueString.substring(8,4),this.IDValueString.substring(12,4),this.IDValueString.substring(16,4),this.IDValueString.substring(20,12)).toLowerCase(),this.pdfSecurity=new r.StiPdfSecurity(this),this.usePdfA||(this.encrypted=this.pdfSecurity.computingCryptoValues(q,j,X,this.keyLength,this.IDValue)),this.encrypted&&this.useUnicodeMode&&(this.embeddedFonts=!0);var ct=W.getSelectedPages(m.renderedPages);null!=m.bookmark&&0!=m.bookmark.bookmarks.count&&(this.addBookmarkNode(m.bookmark,-1),this.haveBookmarks=!0,this.bookmarksCounter=this.bookmarksTree.stimulsoft.countItems);var pt=0;try{for(var gt=__values(ct.list),ht=gt.next();!ht.done;ht=gt.next()){var wt=ht.value,ut;if(ct.getPage(wt),this.storeShadingData1(wt.brush,pt),this.storeHatchData(wt.brush),null!=wt.hyperlinkValue&&wt.hyperlinkValue.toString().trim().length>0&&!wt.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA)(ut=new Z).Link=wt.hyperlinkValue.ToString(),ut.Page=pt,this.linksArray.push(ut);if(null!=wt.watermark&&wt.watermark.enabled){if(!w.isNullOrEmpty(wt.watermark.text)){null!=wt.watermark.font&&this.pdfFont.getFontNumber(wt.watermark.font);var dt=new P(wt.watermark.text);dt=this.bidi.convert(dt,!1),this.pdfFont.storeUnicodeSymbolsInMap(dt.toString()),this.storeShadingData1(wt.watermark.textBrush,pt),this.storeHatchData(wt.watermark.textBrush)}1==wt.watermark.showImageBehind&&null!=wt.watermark.image&&this.storeImageData(wt.watermark.image,U,!1,!1)}try{for(var St=(S=void 0,__values(wt.components.list)),ft=St.next();!ft.done;ft=St.next()){var vt;if((vt=ft.value).enabled&&(!m.isPrinting||vt.printable)){var Et,ut,ut,ut;if(this.imageInfoCounter++,Et=vt.width>0&&vt.height>0){var bt=vt.as(k);null!=bt&&(this.storeShadingData1(bt.brush,pt),this.storeHatchData(bt.brush));var yt=vt.as(C),xt;if(null!=yt&&r.StiPdfRenderPrimitives.checkShape(yt))continue;if(vt.stimulsoft.is(V)){var At=vt,Tt;if(this.storeShadingData1(At.textBrush,pt),this.storeHatchData(At.textBrush),this.allowEditable==r.StiPdfAllowEditable.Yes&&At.editable)(Tt=new J).Page=pt,Tt.Component=vt,this.annots2Array.push(Tt);continue}if(xt=vt.isExportAsImage(e.StiExportFormat.Pdf)){var Pt=!1,Lt=vt;if(this.imageResolutionMode!=r.StiImageResolutionMode.Exactly&&null!=Lt&&null!=Lt.imageToDraw&&null!=Lt.imageToDraw.bytes){Pt=!0;var Ct=Lt.imageToDraw.horizontalResolution/100;this.imageResolutionMode==r.StiImageResolutionMode.NoMoreThan&&(Ct=Lt.stretch?Lt.imageToDraw.width/m.unit.convertToHInches(vt.width):1/Lt.multipleFactor),Ct=this.storeImageData(Lt.imageToDraw,Ct,!0,Lt.smoothing),this.imageInfoList.set(this.imageInfoCounter,Ct)}if(!Pt){var Ft=vt.as(z);if(null!=Ft){var Ct,Bt={ref:Ct=U},kt=Ft.getImage(Bt,e.StiExportFormat.Pdf);Ct=Bt.ref,null!=kt&&(this.storeImageData(kt,Ct,!1,!1),this.imageInfoList.set(this.imageInfoCounter,Ct))}}}var Rt=vt.as(B);if(null!=Rt)var It=this.pdfFont.getFontNumber(Rt.font);var Dt=vt.stimulsoft.as(I);if(vt.is(L)&&!xt){var Nt=vt,Ot=null!=Dt&&null!=Dt.textOptions&&Dt.textOptions.rightToLeft,dt=new P(Nt.text);if(Nt.allowHtmlTags){var Ht=new t.Base.Drawing.StiHtmlTagsState(Nt.font.bold,Nt.font.italic,Nt.font.underline,Nt.font.strikeout,Nt.font.size,Nt.font.name,E.toColor(Nt.textBrush),E.toColor(Nt.brush),!1,!1,0,0,1,Nt.horAlignment),Mt=new t.Base.Drawing.StiHtmlState(Ht,0),Wt=t.Base.Drawing.StiTextRenderer.parseHtmlToStates(Nt.text,Mt);dt=new P;for(var Ut=0;Ut<Wt.length;Ut++){var Xt=Wt[Ut];dt.append(t.Base.Drawing.StiTextRenderer.prepareStateText(Xt.text))}}dt=this.bidi.convert(dt,Ot),this.pdfFont.storeUnicodeSymbolsInMap(dt.toString());var zt=vt.as(R),Tt;if(null!=Nt&&null!=zt&&(this.storeShadingData1(zt.textBrush,pt),this.storeHatchData(zt.textBrush)),this.allowEditable==r.StiPdfAllowEditable.Yes&&Nt.editable)(Tt=new J).Page=pt,this.annotsArray.push(Tt),this.fontGlyphsReduceNotNeed[this.pdfFont.currentFont]=!0;if(null!=Nt.indicator){var Vt=Nt.indicator.stimulsoft.as(s);if(null!=Vt&&(Vt.icon!=a.None||null!=Vt.customIcon)){var kt=o.getIcon(Vt),Ct=1;Ct=this.storeImageData(kt,Ct,!1,!0,!0),this.imageInfoList[this.imageInfoCounter]=Ct}var Gt=Nt.indicator.stimulsoft.as(n);if(null!=Gt&&0!=Gt.value&&Gt.brushType==t.Report.Components.StiBrushType.Gradient){var Yt=Gt.value<0?Gt.negativeColor:Gt.positiveColor,jt=i.light(Yt,200),_t=new K;_t.Page=pt,_t.FunctionIndex=this.getShadingFunctionNumber(Yt,jt,!1),this.shadingArray.push(_t)}}}if(vt.is(G)&&!xt){var qt=new r.StiPdfGeomWriter(this.pageStream,this,!0),Kt=r.StiBarCodeExportPainter.createNew(qt),Qt=vt;if(!w.isNullOrEmpty(Qt.codeValue)&&null!=Qt.page){var Jt=m.unit.convertRectangleToHInches(Qt.clientRectangle);Qt.barCodeType.draw(Kt,Qt,Jt,1)}}else if(vt.is(H)&&!xt){var Zt;(Zt=new _(this)).Component=vt,r.StiPdfRenderChart.renderChart(Zt,!0,pt)}}if(null!=vt.hyperlinkValue&&vt.hyperlinkValue.toString().trim().length>0&&!vt.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA)(ut=new Z).Link=vt.hyperlinkValue.toString(),ut.Page=pt,this.linksArray.push(ut);if(null!=vt.toolTipValue&&vt.toolTipValue.toString().trim().length>0&&!this.usePdfA)(ut=new Z).Page=pt,this.tooltipsArray.push(ut);if(null!=vt.tagValue&&"pdfunsignedsignaturefield"==vt.tagValue.toString().toLowerCase()&&!this.usePdfA)(ut=new J).Page=pt,this.unsignedSignaturesArray.push(ut)}}}catch(t){S={error:t}}finally{try{ft&&!ft.done&&(f=St.return)&&f.call(St)}finally{if(S)throw S.error}}pt++,null!=wt.watermark&&wt.watermark.enabled&&0==wt.watermark.showImageBehind&&null!=wt.watermark.image&&this.storeImageData(wt.watermark.image,U,!1,!1)}}catch(t){u={error:t}}finally{try{ht&&!ht.done&&(d=gt.return)&&d.call(gt)}finally{if(u)throw u.error}}for(var $t=0;$t<this.pdfFont.fontList.length;$t++)this.pdfFont.currentFont=$t,this.pdfFont.storeUnicodeSymbolsInMap("…");if(this.unsignedSignaturesArray.stimulsoft.countItems>0&&(this.annotsArray.stimulsoft.countItems>0||this.annots2Array.stimulsoft.countItems>0))for(var $t=0;$t<this.pdfFont.fontList.stimulsoft.countItems;$t++){var te;"Arial"==this.pdfFont.fontList[$t].Name&&(this.fontGlyphsReduceNotNeed[$t]=!0)}for(var ee="",re=32;re<256;re++)ee+=String.fromCharCode(this.CodePage1252[re]);for(var ie=0;ie<this.pdfFont.fontList.length;ie++)this.fontGlyphsReduceNotNeed[ie]&&(this.pdfFont.currentFont=ie,this.pdfFont.storeUnicodeSymbolsInMap(ee));this.imagesCurrent=0,this.annotsCurrent=0,this.annots2Current=0,this.shadingCurrent=0,this.linksCounter=this.linksArray.stimulsoft.countItems,this.haveLinks=this.linksCounter>0,this.annotsCounter=this.annotsArray.length,this.annots2Counter=this.annots2Array.length,this.unsignedSignaturesCounter=this.unsignedSignaturesArray.length,this.haveAnnots=this.annotsCounter>0||this.annots2Counter>0||this.unsignedSignaturesCounter>0,this.tooltipsCounter=this.tooltipsArray.stimulsoft.countItems,this.haveTooltips=this.tooltipsCounter>0,this.pdfFont.InitFontsData(m),this.fontsCounter=this.pdfFont.fontList.length,this.info=new r.StiPdfStructure;for(var nt=0;nt<ct.count;nt++)this.info.pageList.push(this.info.createContentObject(!0));for(var nt=0;nt<this.imageCache.imagePackedStore.length;nt++)this.info.xObjectList.push(this.info.createXObject(!0,null!=this.imageCache.imageMaskStore[nt]));for(var nt=0;nt<this.pdfFont.fontList.length;nt++)this.info.fontList.push(this.info.createFontObject(!0,this.useUnicodeMode,this.standardPdfFonts,this.embeddedFonts));if(this.info.outlines=this.info.createOutlinesObject(this.haveBookmarks),this.haveBookmarks)for(var nt=0;nt<this.bookmarksCounter;nt++)this.info.outlines.items.push(this.info.createObject(!0));this.info.patterns=this.info.createPatternsObject(!0);for(var nt=0;nt<this.hatchArray.length;nt++)this.info.patterns.hatchItems.push(this.info.createObject(!0));for(var nt=0;nt<this.shadingArray.length;nt++)this.info.patterns.shadingItems.push(this.info.createObject(!0));for(var nt=0;nt<this.shadingFunctionArray.length;nt++)this.info.patterns.shadingFunctionItems.push(this.info.createObject(!0));for(var nt=0;nt<this.linksCounter;nt++)this.info.linkList.push(this.info.createObject(!0));if(this.info.encode=this.info.createObject(this.encrypted),this.info.extGState=this.info.createObject(!0),this.info.acroForm=this.info.createAcroFormObject(this.haveAnnots||this.haveTooltips),this.haveAnnots){for(var nt=0;nt<this.annotsCounter;nt++)this.info.acroForm.annots.push(this.info.createAnnotObject(!0,!0,0));for(var nt=0;nt<this.fontsCounter;nt++)this.info.acroForm.annotFontItems.push(this.info.createFontObject(!0,!1,!1,!1,!0));for(var nt=0;nt<this.annots2Counter;nt++)this.info.acroForm.checkBoxes.push(new r.StiPdfCheckBoxObjInfo),this.info.acroForm.checkBoxes[nt].items=[],this.info.acroForm.checkBoxes[nt].items.push(this.info.createAnnotObject(!0,!0,2)),this.info.acroForm.checkBoxes[nt].items.push(this.info.createAnnotObject(!0,!0,2)),null==this.annots2Array[nt].Component.as(V).checkedValue&&this.info.acroForm.checkBoxes[nt].items.push(this.info.createAnnotObject(!0,!1,2));for(var nt=0;nt<this.unsignedSignaturesCounter;nt++)this.info.acroForm.unsignedSignatures.push(this.info.createAnnotObject(!0,!1,0))}for(var nt=0;nt<this.tooltipsCounter;nt++)this.info.acroForm.tooltips.push(this.info.createAnnotObject(!0,!1,0));this.info.metadata=this.info.createObject(!0),this.info.destOutputProfile=this.info.createObject(!0),this.info.outputIntents=this.info.createObject(!0),this.info.embeddedJS=this.info.createContentObject(this.autoPrint!=r.StiPdfAutoPrintMode.None),this.renderStartDoc(m,ct);var ne=0;this.linksArray.stimulsoft.clear(),this.tagsArray=new Array,this.tooltipsArray.stimulsoft.clear(),this.unsignedSignaturesArray.stimulsoft.clear(),this.imageInfoCounter=0,this.currentPassNumber++;try{for(var oe=__values(ct.list),ae=oe.next();!ae.done;ae=oe.next()){var wt=ae.value;if(ct.getPage(wt),this.isStopped)return;this.renderPageHeader(ne++);var se=this.hiToTwips*m.unit.convertToHInches(wt.pageHeight*wt.segmentPerHeight),le=this.hiToTwips*m.unit.convertToHInches(wt.pageWidth*wt.segmentPerWidth),me=this.hiToTwips*m.unit.convertToHInches(wt.margins.left),ce=this.hiToTwips*m.unit.convertToHInches(wt.margins.right),pe=this.hiToTwips*m.unit.convertToHInches(wt.margins.top),ge=this.hiToTwips*m.unit.convertToHInches(wt.margins.bottom),ut,Zt,he;if(se>14400&&(se=14400),this.haveBookmarks&&(!w.isNullOrEmpty(wt.guid)||null!=wt.bookmarkValue&&""!=wt.bookmarkValue.toString())){var we=0;while(we<this.bookmarksCounter){var ue;if(0==(ue=this.bookmarksTree[we]).Used&&-1==ue.Page){var de=!1;if(w.isNullOrEmpty(ue.Guid)?w.isNullOrEmpty(ue.Title)||null!=wt.bookmarkValue&&wt.bookmarkValue.length>0&&ue.Title==wt.bookmarkValue&&(de=!0):w.isNullOrEmpty(wt.guid)||ue.Guid!=wt.guid||(de=!0),de){ue.Page=ne-1,ue.Y=se,ue.Used=!0,this.bookmarksTree[we]=ue;break}}we++}}if(null!=wt.hyperlinkValue&&wt.hyperlinkValue.toString().trim().length>0&&!wt.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA)(ut=new Z).Link=wt.hyperlinkValue.toString(),ut.X=0,ut.Y=0,ut.Width=le,ut.Height=se,ut.Page=ne,ut.DestPage=-1,ut.DestY=-1,this.linksArray.push(ut);if(null!=wt.brush)(Zt=new _(this)).X=0,Zt.Y=0,Zt.Width=le,Zt.Height=se,(he=new v).brush=wt.brush,he.border=null,Zt.Component=he,r.StiPdfRenderPrimitives.renderBorder1(Zt);this.renderWatermark(wt,!0,le,se,U);var Se=new Array,Zt,he;try{for(var fe=(x=void 0,__values(wt.components.list)),ve=fe.next();!ve.done;ve=fe.next()){var vt;if((vt=ve.value).enabled&&(!m.isPrinting||vt.printable)){this.imageInfoCounter++;var Ee=this.hiToTwips*m.unit.convertToHInches(vt.left),be=this.hiToTwips*m.unit.convertToHInches(vt.top),ye=this.hiToTwips*m.unit.convertToHInches(vt.right),xe=this.hiToTwips*m.unit.convertToHInches(vt.bottom),Zt,Et,ut,ut,ut;if((Zt=new _(this)).X=Ee+me,Zt.Y=be+pe,Zt.Width=ye-Ee,Zt.Height=xe-be,Zt.Y=se-(Zt.Y+Zt.Height),Zt.Component=vt,Et=vt.width>0&&vt.height>0){var xt=vt.isExportAsImage(e.StiExportFormat.Pdf);if(this.usePdfA||vt.printable||this.pageStream.writeLine("/OC /oc1 BDC"),vt.is(C)||r.StiPdfRenderPrimitives.renderBorder1(Zt),vt.is(L)&&!xt){var Ae=vt,Te=0;this.haveAnnots&&Ae.editable&&(Te=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255);var Pe=r.StiPdfRenderIndicators.renderIndicators(Zt);if(Ae.allowHtmlTags){for(var Ht=new t.Base.Drawing.StiHtmlTagsState(Ae.font.bold,Ae.font.italic,Ae.font.underline,Ae.font.strikeout,Ae.font.size,Ae.font.name,E.toColor(Ae.textBrush),E.toColor(Ae.brush),!1,!1,0,0,1,Ae.horAlignment),Mt=new t.Base.Drawing.StiHtmlState(Ht,0),Wt=t.Base.Drawing.StiTextRenderer.parseHtmlToStates(Ae.text,Mt),Le=Ae.text.stimulsoft.startsWith("<StiHtmlJs>"),dt="",Ut=0;Ut<Wt.length;Ut++){var Xt;if((Xt=Wt[Ut]).ts.tag.tag==g.P&&"\n"==Xt.text.toString())continue;dt+=t.Base.Drawing.StiTextRenderer.prepareStateText(Xt.text)}var Ce=Ae.clone(!0);if(Ce.text=dt,Zt.Component=Ce,r.StiPdfRenderText.renderTextFont(Pe),r.StiPdfRenderText.renderText(Pe),this.haveAnnots&&Ae.editable){var Tt;(Tt=this.annotsArray[this.annotsCurrent]).Multiline=Ae.wordWrap,Tt.X=Zt.X,Tt.Y=Zt.Y,Tt.Width=Zt.Width,Tt.Height=Zt.Height,Tt.Component=Zt.Component,Tt.Alignment=t.Base.Drawing.StiTextHorAlignment.Left;var Fe=Zt.Component.as(Y);if(null!=Fe){var Be=Fe.horAlignment,Dt;null!=(Dt=Zt.Component.as(I))&&null!=Dt.textOptions&&Dt.textOptions.rightToLeft&&(Be==t.Base.Drawing.StiTextHorAlignment.Left?Be=t.Base.Drawing.StiTextHorAlignment.Right:Be==t.Base.Drawing.StiTextHorAlignment.Right&&(Be=t.Base.Drawing.StiTextHorAlignment.Left)),Tt.Alignment=Be}Tt.Text=dt.toString().split("\n").join("")}}else r.StiPdfRenderText.renderTextFont(Pe),r.StiPdfRenderText.renderText(Pe);if(this.haveAnnots&&Ae.editable){this.pageStream.flush();var ke=this.pageStream.position;this.pageStream.seek(Te,t.System.IO.SeekOrigin.Begin);var Re=[],Tt;this.pageStream.read(Re,0,ke-Te),this.pageStream.seek(Te,t.System.IO.SeekOrigin.Begin),this.pageStream.setLength(Te),(Tt=this.annotsArray[this.annotsCurrent]).Content=Re,this.annotsCurrent++,this.popColorFromStack()}}if(vt.is(C))r.StiPdfRenderPrimitives.renderShape(Zt,U);else if(vt.is(G)&&!xt){var qt=new r.StiPdfGeomWriter(this.pageStream,this),Kt=r.StiBarCodeExportPainter.createNew(qt),Qt=vt;if(!w.isNullOrEmpty(Qt.codeValue)&&null!=Qt.page){this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(Zt.X),this.convertToString(Zt.Y),this.convertToString(Zt.Width),this.convertToString(Zt.Height)),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(me),this.convertToString(se-pe)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips));var Jt=m.unit.convertRectangleToHInches(Qt.clientRectangle);Qt.barCodeType.draw(Kt,Qt,Jt,1),this.pageStream.writeLine("Q"),this.popColorFromStack()}}else if(vt.is(H)&&!xt)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(Zt.X),this.convertToString(Zt.Y+Zt.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),r.StiPdfRenderChart.renderChart(Zt,!1,ne-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(vt.is(V)){var Ie=vt;if(this.haveAnnots&&Ie.editable){var Tt;(Tt=this.annots2Array[this.annots2Current]).Multiline=!1,Tt.X=Zt.X,Tt.Y=Zt.Y,Tt.Width=Zt.Width,Tt.Height=Zt.Height,Tt.Component=Zt.Component,Tt.Alignment=t.Base.Drawing.StiTextHorAlignment.Center,Tt.Text="";var De=Zt.X,Ne=Zt.Y;Zt.X=0,Zt.Y=0,this.pageStream.flush();var Te=this.pageStream.position;this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,r.StiPdfRenderPrimitives.renderCheckbox(Zt,!0),this.pageStream.flush();var ke=this.pageStream.position;this.pageStream.seek(Te,t.System.IO.SeekOrigin.Begin);var Re=[];this.pageStream.read(Re,0,ke-Te),this.pageStream.seek(Te,t.System.IO.SeekOrigin.Begin),Tt.Content=Re,this.popColorFromStack(),this.pageStream.flush(),Te=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,r.StiPdfRenderPrimitives.renderCheckbox(Zt,!1,!1),this.pageStream.flush(),ke=this.pageStream.position,this.pageStream.seek(Te,t.System.IO.SeekOrigin.Begin),Re=[],this.pageStream.read(Re,0,ke-Te),this.pageStream.seek(Te,t.System.IO.SeekOrigin.Begin),Tt.Content2=Re,this.popColorFromStack(),this.annots2Current++,Zt.X=De,Zt.Y=Ne}else{var Oe=r.StiPdfRenderPrimitives.getCheckBoxValue(Ie);null!=Oe&&r.StiPdfRenderPrimitives.renderCheckbox(Zt,Oe)}}else xt&&this.renderImage(Zt,U);if(vt.is(F))r.StiPdfRenderPrimitives.renderRoundedRectanglePrimitive(Zt);else{var He=Zt.Component.as(D);null!=He&&null!=He.border&&He.border.topmost?Se.push(Zt):r.StiPdfRenderPrimitives.renderBorder2(Zt)}this.usePdfA||vt.printable||this.pageStream.writeLine("EMC")}if(this.haveBookmarks&&(!w.isNullOrEmpty(vt.guid)||null!=vt.bookmarkValue&&""!=vt.bookmarkValue)){var we=0;while(we<this.bookmarksCounter){var ue;if(0==(ue=this.bookmarksTree[we]).Used&&-1==ue.Page){var de=!1;if(w.isNullOrEmpty(ue.Guid)?w.isNullOrEmpty(ue.Title)||null!=vt.bookmarkValue&&vt.bookmarkValue.length>0&&ue.Title==vt.bookmarkValue&&(de=!0):w.isNullOrEmpty(vt.guid)||ue.Guid!=vt.guid||(de=!0),de){ue.Page=ne-1,ue.Y=Zt.Y+Zt.Height,ue.Used=!0,this.bookmarksTree[we]=ue;break}}we++}}if(null!=vt.hyperlinkValue&&vt.hyperlinkValue.toString().trim().length>0&&!vt.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA)(ut=new Z).Link=vt.hyperlinkValue.toString(),ut.X=Zt.X,ut.Y=Zt.Y,ut.Width=Zt.Width,ut.Height=Zt.Height,ut.Page=ne,ut.DestPage=-1,ut.DestY=-1,this.linksArray.push(ut);if(null!=vt.tagValue&&vt.tagValue.toString().trim().length>0)if((ut=new Z).Link=vt.tagValue.toString(),ut.X=Zt.X,ut.Y=Zt.Y,ut.Width=Zt.Width,ut.Height=Zt.Height,ut.Page=ne-1,ut.DestPage=-1,ut.DestY=-1,this.tagsArray.push(ut),"pdfunsignedsignaturefield"==ut.Link.trim().toLowerCase()&&!this.usePdfA){var Me=new J;Me.X=ut.X,Me.Y=ut.Y,Me.Width=ut.Width,Me.Height=ut.Height,Me.Page=ut.Page,Me.Component=vt,this.unsignedSignaturesArray.push(Me)}if(null!=vt.toolTipValue&&vt.toolTipValue.toString().trim().length>0&&!this.usePdfA)(ut=new Z).Link=vt.toolTipValue.toString().trim(),ut.X=Zt.X,ut.Y=Zt.Y,ut.Width=Zt.Width,ut.Height=Zt.Height,ut.Page=ne-1,ut.DestPage=-1,ut.DestY=-1,this.tooltipsArray.push(ut)}}}catch(t){x={error:t}}finally{try{ve&&!ve.done&&(A=fe.return)&&A.call(fe)}finally{if(x)throw x.error}}try{for(var We=(N=void 0,__values(Se)),Ue=We.next();!Ue.done;Ue=We.next()){var Xe=Ue.value;r.StiPdfRenderPrimitives.renderBorder2(Xe)}}catch(t){N={error:t}}finally{try{Ue&&!Ue.done&&(M=We.return)&&M.call(We)}finally{if(N)throw N.error}}if(Se.stimulsoft.clear(),null!=wt.border)(Zt=new _(this)).X=me,Zt.Y=ge,Zt.Width=le-me-ce,Zt.Height=se-pe-ge,(he=new v).border=wt.border,Zt.Component=he,r.StiPdfRenderPrimitives.renderBorder2(Zt);this.renderWatermark(wt,!1,le,se,U),this.renderPageFooter(se,le)}}catch(t){b={error:t}}finally{try{ae&&!ae.done&&(y=oe.return)&&y.call(oe)}finally{if(b)throw b.error}}if(this.bookmarksTreeTemp=null,this.haveBookmarks&&Q){for(var ze=0;ze<this.bookmarksTree.stimulsoft.countItems;ze++){var ue;if((ue=this.bookmarksTree[ze]).Used)while(-1!=ue.Parent)(ue=this.bookmarksTree[ue.Parent]).Used=!0}var Ve=new c;this.makeBookmarkFromTree(Ve,this.bookmarksTree[0]),this.bookmarksTreeTemp=this.bookmarksTree,this.bookmarksTree=new Array,this.addBookmarkNode(Ve,-1);var Ge=this.bookmarksCounter-this.bookmarksTree.stimulsoft.countItems;if(Ge>0){var ue;(ue=new $).Parent=-1,ue.First=-1,ue.Last=-1,ue.Prev=-1,ue.Next=-1,ue.Count=-1,ue.Page=-1,ue.Y=-1,ue.Title="";for(var ze=0;ze<Ge;ze++)this.bookmarksTree.push(ue)}for(var Ye=new T,je=0;je<this.bookmarksTreeTemp.stimulsoft.countItems;je++){var ue=this.bookmarksTreeTemp[je];Ye.set(ue.Title,ue)}for(var je=0;je<this.bookmarksTree.stimulsoft.countItems;je++){var ue=this.bookmarksTree[je];if(!w.isNullOrEmpty(ue.Title)){var _e=Ye.get(ue.Title);ue.Page=_e.Page,ue.Y=_e.Y}}this.bookmarksTreeTemp=null}this.renderImageTable(),this.renderFontTable(),this.renderBookmarksTable(),this.renderPatternTable(),this.renderLinkTable(),this.renderEncodeRecord(),this.renderExtGStateRecord(),this.renderAnnotTable(),this.renderTooltipTable(),this.renderMetadata(m),this.renderColorSpace(),this.renderAutoPrint(),this.renderEndDoc(),this.xref=null,this.bookmarksTree=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.annotsArray=null,this.annots2Array=null,this.unsignedSignaturesArray=null,this.shadingArray=null,this.hatchArray=null,this.colorStack=null,this.pdfFont.clear(),this.pdfFont=null,this.bidi.clear(),this.bidi=null},et.regexEscape=new RegExp("([{}()^$&.*?/+|[\\\\]|]|-)","g"),et}(r.StiExportService);r.StiPdfExportService=tt}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.System.StiArray,i=t.System.Text.StringBuilder,n=t.System.Drawing.Font,o=t.System.Collections.Hashtable,a=t.System.IO.MemoryStream,s=t.System.Drawing.FontStyle,l=function(){function t(){}return t}();e.PdfFontInfo=l;var m=function(){function t(){}return t}();e.pfontInfo=m;var c=function(){function t(){this.TagString=null,this.Tag=0,this.CheckSum=0,this.Offset=0,this.Length=0,this.NewOffset=0,this.NewLength=0,this.Required=!1,this.NewTable=null}return t}(),p=function(){function t(){this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.IndexCmapTable=0,this.FontName=null,this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.FontName=new o}return t}(),g=function(o){function g(){var t=o.call(this)||this;return t.standardFontQuantity=12,t.standardFontNumWidths=310,t.standardFontNumChars=3680+189,t.firstMappedSymbol=64,t.factor=1,t.maxSymbols=32767,t.useUnicode=!0,t.WIDTHS=null,t.fonts=null,t.UnicodeMapsList=null,t.GlyphMapsList=null,t.standardPdfFonts=!0,t.fontsInfoStore=null,t.family_Helvetica=["Arial","Arial Black","Arial Narrow","Century Gothic","Comic Sans MS","Impact","Microsoft Sans Serif","Tahoma","Verdana"],t.family_Courier=["Courier New","Lucida Console"],t.family_Times_Roman=["Book Antiqua","Bookman Old Style","Garamond","Georgia","Times New Roman"],t.family_Symbol=["Symbol"],t.family_ZapfDingbats=["Wingdings 2"],t.PdfFontName=["Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic","Courier","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Symbol","ZapfDingbats"],t._currentFont=-1,t.TtfHeaderSize=12,t.ARG_1_AND_2_ARE_WORDS=1,t.ARGS_ARE_XY_VALUES=2,t.ROUND_XY_TO_GRID=4,t.WE_HAVE_A_SCALE=8,t.MORE_COMPONENTS=32,t.WE_HAVE_AN_X_AND_Y_SCALE=64,t.WE_HAVE_A_TWO_BY_TWO=128,t.WE_HAVE_INSTRUCTIONS=256,t.USE_MY_METRICS=512,t.OVERLAP_COMPOUND=1024,t.SCALED_COMPONENT_OFFSET=2048,t.UNSCALED_COMPONENT_OFFSET=4096,t.TablesNames=["head","hhea","hmtx","maxp","cmap","OS/2","post","cvt ","fpgm","glyf","loca","prep","name"],t.fontList=new Array,t.UnicodeMapsList=new Array,t.GlyphMapsList=new Array,t.fontsInfoStore=new h,t}return __extends(g,o),g.prototype.getFontMetrics=function(e,i,o,a){if(this.WIDTHS=r.create(Number,this.maxSymbols+1),null==e)return;var l=new n(e.name,1024,e.style,t.System.Drawing.GraphicsUnit.Pixel);r.copy(i.UnicodeMapBack,0,this.WIDTHS,i.MappedSymbolsCount);var m=t.System.Drawing.Graphics.measureChars(this.WIDTHS,i.MappedSymbolsCount,l),c=m.height,p=m.width;i.CH=0,i.tmASC=Math.round2(.8*c*this.factor),i.tmDESC=Math.round2(.2*c*this.factor),i.tmExternal=Math.round2((p-c)*this.factor),i.LLX=0,i.LLY=0,i.URX=0,i.URY=0,i.StemV=0,i.ItalicAngle=0,i.UnderscoreSize=Math.round2(c*(e.bold?.08:.06)*this.factor),i.UnderscorePosition=Math.round2(.1*-c*this.factor),i.StrikeoutSize=Math.round2(.045*c*this.factor),i.StrikeoutPosition=Math.round2(.25*c*this.factor);for(var g=0;g<i.MappedSymbolsCount;g++)this.WIDTHS[g]=Math.round2(this.WIDTHS[g]*this.factor,0);var h=t.Base.StiFontCollection.getBinFont(e.name,e.style),w=null!=h?h.data:null;if(null==w){var u=(e.style&s.Bold)>0,d=(e.style&s.Italic)>0;u&&d?null!=(h=t.Base.StiFontCollection.getBinFont(e.name,s.Italic))&&null!=h.data?(w=h.data,this.NeedSyntBold=!0):null!=(h=t.Base.StiFontCollection.getBinFont(e.name,s.Bold))&&null!=h.data?(w=h.data,this.NeedSyntItalic=!0):null!=(h=t.Base.StiFontCollection.getBinFont(e.name,s.Regular))&&null!=h.data&&(w=h.data,this.NeedSyntItalic=!0,this.NeedSyntBold=!0):(u&&null!=(h=t.Base.StiFontCollection.getBinFont(e.name,s.Regular))&&null!=h.data&&(w=h.data,this.NeedSyntBold=!0),d&&null!=(h=t.Base.StiFontCollection.getBinFont(e.name,s.Regular))&&null!=h.data&&(w=h.data,this.NeedSyntItalic=!0))}if(null==w){var S=a.dictionary.resources.getByName(e.name);null==S&&(S=a.dictionary.resources.getByAlias(e.name)),null!=S&&null!=S.content&&S.content.length>0&&(w=new Uint8Array(S.content),this.NeedSyntBold=!0,this.NeedSyntItalic=!0)}if(null!=w&&w.stimulsoft.is(Uint8Array)&&w.byteLength>0){var f=this.getCharToGlyphTable(w,e.name);if(null!=f){var v=0;"Wingdings"!=e.name&&"Wingdings 2"!=e.name&&"Wingdings 3"!=e.name||(v=61440);for(var g=0;g<i.MappedSymbolsCount;g++){var E=i.UnicodeMapBack[g];E>=128&&E<=255&&(E+=v),i.GlyphList[g]=f[E]}}}i.NeedSyntBold=this.NeedSyntBold,i.NeedSyntItalic=this.NeedSyntItalic},Object.defineProperty(g.prototype,"currentFont",{get:function(){return this._currentFont},set:function(t){this._currentFont!=t&&(this._currentFont=t,null!=this.fonts&&this.fonts.length>0&&(this.Widths=this.fonts[this._currentFont].Widths,this.CH=this.fonts[this._currentFont].CH,this.XH=this.fonts[this._currentFont].XH,this.ASC=this.fonts[this._currentFont].ASC,this.DESC=this.fonts[this._currentFont].DESC,this.tmASC=this.fonts[this._currentFont].tmASC,this.tmDESC=this.fonts[this._currentFont].tmDESC,this.tmExternal=this.fonts[this._currentFont].tmExternal,this.MacAscend=this.fonts[this._currentFont].MacAscend,this.MacDescend=this.fonts[this._currentFont].MacDescend,this.MacLineGap=this.fonts[this._currentFont].MacLineGap,this.LLX=this.fonts[this._currentFont].LLX,this.LLY=this.fonts[this._currentFont].LLY,this.URX=this.fonts[this._currentFont].URX,this.URY=this.fonts[this._currentFont].URY,this.StemV=this.fonts[this._currentFont].StemV,this.ItalicAngle=this.fonts[this._currentFont].ItalicAngle,this.LineGap=this.fonts[this._currentFont].LineGap,this.NtmFlags=this.fonts[this._currentFont].NtmFlags,this.UnderscoreSize=this.fonts[this._currentFont].UnderscoreSize,this.UnderscorePosition=this.fonts[this._currentFont].UnderscorePosition,this.StrikeoutSize=this.fonts[this._currentFont].StrikeoutSize,this.StrikeoutPosition=this.fonts[this._currentFont].StrikeoutPosition,this.UnicodeMap=this.fonts[this._currentFont].UnicodeMap,this.UnicodeMapBack=this.fonts[this._currentFont].UnicodeMapBack,this.GlyphList=this.fonts[this._currentFont].GlyphList,this.GlyphBackList=this.fonts[this._currentFont].GlyphBackList,this.GlyphRtfList=this.fonts[this._currentFont].GlyphRtfList,this.SymsToPDF=this.fonts[this._currentFont].SymsToPDF,this.CharPdfNames=this.fonts[this._currentFont].CharPdfNames,this.MappedSymbolsCount=this.fonts[this._currentFont].MappedSymbolsCount,this.NeedSyntBold=this.fonts[this._currentFont].NeedSyntBold,this.NeedSyntItalic=this.fonts[this._currentFont].NeedSyntItalic,this.GlyphWidths=this.fonts[this._currentFont].GlyphWidths,this.ChildFontsMap=this.fonts[this._currentFont].ChildFontsMap))},enumerable:!1,configurable:!0}),g.prototype.InitFontsData=function(t){if(!this.useUnicode)for(var i=this.fontList.length,n=0;n<i;n++){for(var o=this.UnicodeMapsList[n],a=this.firstMappedSymbol,s=this.firstMappedSymbol;s<65536;s++)o[s]>0&&a++;if(a>255){for(var c=this.fontList[n],p=null,g=r.create(Number,65536),h=this.fontList.length,s=0;s<this.firstMappedSymbol;s++)g[s]=h;var w=!0;a=this.firstMappedSymbol;for(var s=this.firstMappedSymbol;s<65536;s++){if(w){var u=new m;u.Name=c.Name,u.PdfName=c.PdfName,u.Bold=c.Bold,u.Italic=c.Italic,u.Number=c.Number,u.Font=c.Font,u.ParentFontNumber=n,this.fontList.push(u),p=r.create(Number,65536),r.copy(o,0,p,64),this.UnicodeMapsList.push(p),this.GlyphMapsList.push(r.create(Number,65536)),h=this.fontList.length-1,a=this.firstMappedSymbol,w=!1}o[s]>0&&(p[s]=1,g[s]=h,254==++a&&(w=!0))}c.ChildFontsMap=g,this.fontList[n]=c}}this.fonts=r.create(l,this.fontList.length);for(var n=0;n<this.fontList.length;n++){this.fonts[n]=new l;var d=this.fonts[n];d.UnicodeMap=this.UnicodeMapsList[n],d.UnicodeMapBack=r.create(Number,this.maxSymbols+1);var S=this.GlyphMapsList[n],f=r.create(Number,65536);S[65535];for(var v=this.firstMappedSymbol,E=this.firstMappedSymbol;E<65536;E++)0!=d.UnicodeMap[E]&&(d.UnicodeMap[E]=v,d.UnicodeMapBack[v]=E,++v>this.maxSymbols&&(v=this.maxSymbols),this.useUnicode||92!=v||(d.UnicodeMapBack[v]=E,v++));var b=8226;d.UnicodeMap[b]=v,d.UnicodeMapBack[v]=b,v++,d.MappedSymbolsCount=v;for(var E=0;E<this.firstMappedSymbol;E++)d.UnicodeMap[E]=E,d.UnicodeMapBack[E]=E;d.CharPdfNames=r.create(String,v),d.SymsToPDF=r.create(Number,v);for(var y=32;y<d.MappedSymbolsCount;y++){for(var x=-1,A=0;A<this.standardFontNumWidths;A++);d.SymsToPDF[y]=x;var T=e.StiPdfResources.standardFontCharsNames[d.UnicodeMapBack[y]];null==T&&(T="uni"+d.UnicodeMapBack[y].toString(16).toUpperCase().stimulsoft.padLeft(4,"0")),d.CharPdfNames[y]=T}d.GlyphList=r.create(Number,v);var P=this.fontList[n];this.fonts[n].Widths=r.create(Number,v),this.getFontMetrics(P.Font,d,S,t);for(var L=0;L<v-32;L++)this.fonts[n].Widths[L]=this.WIDTHS[32+L];this.standardPdfFonts,null!=this.fontList[n].ChildFontsMap&&(d.MappedSymbolsCount=255,d.ChildFontsMap=this.fontList[n].ChildFontsMap)}this._currentFont=-1,this.currentFont=0},g.prototype.getFontNumber=function(t){var e,i,n,o,a,s,l=-1;if(this.fontList.length>0)for(var c=0;c<this.fontList.length;c++){var p=this.fontList[c];if(p.Name==t.name&&p.Bold==t.bold&&p.Italic==t.italic){l=c;break}}if(-1==l){var g=new m;g.Name=t.name,g.Bold=t.bold,g.Italic=t.italic,g.Font=t,g.ParentFontNumber=-1,l=0;try{for(var h=__values(this.family_Helvetica),w=h.next();!w.done;w=h.next()){var u=w.value;g.Name==u&&(l=0)}}catch(t){e={error:t}}finally{try{w&&!w.done&&(i=h.return)&&i.call(h)}finally{if(e)throw e.error}}try{for(var d=__values(this.family_Times_Roman),S=d.next();!S.done;S=d.next()){var u=S.value;g.Name==u&&(l=4)}}catch(t){n={error:t}}finally{try{S&&!S.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}try{for(var f=__values(this.family_Courier),v=f.next();!v.done;v=f.next()){var u=v.value;g.Name==u&&(l=8)}}catch(t){a={error:t}}finally{try{v&&!v.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}l<12&&(1==g.Bold&&(l+=1),1==g.Italic&&(l+=2)),g.Number=l,g.PdfName=this.PdfFontName[l],this.fontList.push(g),l=this.fontList.length-1,this.UnicodeMapsList.push(r.create(Number,65536)),this.GlyphMapsList.push(r.create(Number,65536))}return this.currentFont=l,l},g.prototype.storeUnicodeSymbolsInMap=function(t){if(t.length>0&&-1!=this.currentFont)for(var e=this.UnicodeMapsList[this.currentFont],r=0;r<t.length;r++)e[t.charCodeAt(r)]=1},g.prototype.getCharToGlyphTable=function(t,e){var r=this.scanFontFile(t,e);if(null!=r)return this.getCmapTable(t,r);return null},g.prototype.reduceFontSize=function(t,e,i){var n=this.scanFontFile(t,e),o=null;if(null!=n){if(i){for(var s=r.create(Boolean,n.NumGlyphs),l=r.create(Boolean,n.NumGlyphs),m=0;m<this.GlyphList.length;m++){var c=this.GlyphList[m];c<n.NumGlyphs&&(s[c]=!0,l[c]=!0)}s[0]=!0,s[1]=!0,s[2]=!0,s[3]=!0,l[0]=!0,l[1]=!0,l[2]=!0,l[3]=!0;var p=n.Tables[n.IndexLocaTable].Offset,g=n.Tables[n.IndexGlyfTable].Offset,h=!0;while(h){h=!1;for(var m=0;m<n.NumGlyphs;m++)if(1==l[m]){l[m]=!1;var w=p+m*(1==n.IndexToLocFormat?4:2),u=0;if(u=1==n.IndexToLocFormat?this.GetUInt32(t,w):2*this.GetUInt16(t,w),u+=g,-1==this.GetInt16(t,u)){h=!0,u+=10;var d=0;do{d=this.GetUInt16(t,u);var S=this.GetUInt16(t,u+2);S<n.NumGlyphs&&(s[S]=!0,l[S]=!0),u+=4,(d&this.ARG_1_AND_2_ARE_WORDS)>0?(u+=2,u+=2):u+=2,(d&this.WE_HAVE_A_SCALE)>0?u+=2:(d&this.WE_HAVE_AN_X_AND_Y_SCALE)>0?(u+=2,u+=2):(d&this.WE_HAVE_A_TWO_BY_TWO)>0&&(u+=2,u+=2,u+=2,u+=2)}while((d&this.MORE_COMPONENTS)>0)}}}for(var f=0,v=p,m=0;m<n.NumGlyphs;m++){var E=0,b=0;1==n.IndexToLocFormat?(E=this.GetUInt32(t,v),b=this.GetUInt32(t,v+4),v+=4):(E=2*this.GetUInt16(t,v),b=2*this.GetUInt16(t,v+2),v+=2),s[m]&&(f+=b-E)}var y=new Uint8Array(f+4),x=new Uint8Array(n.Tables[n.IndexLocaTable].Length+4),A=0;v=p;for(var T=0,m=0;m<n.NumGlyphs;m++){var E=0,b=0;1==n.IndexToLocFormat?(E=this.GetUInt32(t,v),b=this.GetUInt32(t,v+4),v+=4):(E=2*this.GetUInt16(t,v),b=2*this.GetUInt16(t,v+2),v+=2);var P=b-E;if(1==s[m])for(var L=0;L<P;L++)y[A+L]=t[g+E+L];else P=0;0==n.IndexToLocFormat?this.SetUInt16(x,T,A/2):this.SetUInt32(x,T,A),A+=P,T+=1==n.IndexToLocFormat?4:2}0==n.IndexToLocFormat?this.SetUInt16(x,T,A/2):this.SetUInt32(x,T,A),n.Tables[n.IndexGlyfTable].NewLength=A,n.Tables[n.IndexGlyfTable].NewTable=y,n.Tables[n.IndexLocaTable].NewTable=x}var C=new Uint8Array(this.TtfHeaderSize+16*n.NumTablesRequired);this.copyUint8Array(t,n.HeaderOffset,C,0,C.length);var F=1;while(2<<F-1<=n.NumTablesRequired)F++;var B=16*(2<<--F-1),k=F,R=16*n.NumTablesRequired-B;this.SetUInt16(C,4,n.NumTablesRequired),this.SetUInt16(C,6,B),this.SetUInt16(C,8,k),this.SetUInt16(C,10,R);for(var I=0,D=this.TtfHeaderSize+16*n.NumTablesRequired,N=0;N<n.NumTables;N++)if(n.Tables[N].Required){var O;n.Tables[N].NewOffset=D,(O=(D+=n.Tables[N].NewLength)%4)>0&&(D+=4-O);var H=this.TtfHeaderSize+16*I;this.SetUInt32(C,H,n.Tables[N].Tag),this.SetUInt32(C,H+4,n.Tables[N].CheckSum),this.SetUInt32(C,H+8,n.Tables[N].NewOffset),this.SetUInt32(C,H+12,n.Tables[N].NewLength),I++}(o=new a).writeBytes(C,0,C.length);for(var N=0;N<n.NumTables;N++){var O;if(n.Tables[N].Required)null!=n.Tables[N].NewTable?o.writeBytes(n.Tables[N].NewTable,0,n.Tables[N].NewLength):o.writeBytes(t,n.Tables[N].Offset,n.Tables[N].NewLength),(O=n.Tables[N].NewLength%4)>0&&o.write(r.create(Number,4-O),0,4-O)}o.flush()}return o},g.prototype.scanFontFile=function(t,e){var r=null,i=this.GetUInt32(t,0);if(65536==i)r=this.getTtfInfo(t,0);else{var n=this.GetUInt32(t,4);if(1953784678==i&&(65536==n||131072==n))for(var o,a=this.GetUInt32(t,8)-1;a>=0;a--){var s=this.GetUInt32(t,12+4*a),l;if(65536==this.GetUInt32(t,s)&&(r=this.getTtfInfo(t,s)).FontName.contains(e))break}}return r},g.prototype.getCmapTable=function(t,e){for(var i=null,n=e.Tables[e.IndexCmapTable].Offset,o=this.GetUInt16(t,n+2),a=0;a<o;a++){var s=n+4+8*a,l=this.GetUInt16(t,s),m=this.GetUInt16(t,s+2),c=n+this.GetUInt32(t,s+4),p;if(3==l&&1==m)if(4==this.GetUInt16(t,c)){i=r.create(Number,65536);for(var g=0;g<65536;g++)i[g]=65535;for(var h=this.GetUInt16(t,c+6),w=0;w<h;w+=2){var u=c+14+w,d=this.GetUInt16(t,u),S=this.GetUInt16(t,u+2+h),f=this.GetInt16(t,u+2+2*h),v=this.GetUInt16(t,u+2+3*h);if(65535!=S)for(var E=S;E<=d;E++){var b=65535;if(0==v)b=f+E&65535;else{var y=v+2*(E-S)+(u+2+3*h);0!=(b=this.GetUInt16(t,y))&&(b+=f)}i[E]=b}}}}return i},g.prototype.copyUint8Array=function(t,e,r,i,n){for(var o=0;o<n;o++)r[i+o]=t[e+o]},g.prototype.getTtfInfo=function(t,e){var r=new p;r.HeaderOffset=e,r.SfntVersion=this.GetUInt32(t,r.HeaderOffset),r.NumTables=this.GetUInt16(t,r.HeaderOffset+4),r.NumTablesRequired=0,r.Tables=[];for(var n=0;n<r.NumTables;n++)r.Tables[n]=new c;for(var o=0;o<r.NumTables;o++){for(var a=r.HeaderOffset+this.TtfHeaderSize+16*o,s=new i,l=0;l<4;l++)s.append(String.fromCharCode(this.GetUInt8(t,a+l)));r.Tables[o].Tag=this.GetUInt32(t,a),r.Tables[o].TagString=s.toString(),r.Tables[o].CheckSum=this.GetUInt32(t,a+4),r.Tables[o].Offset=this.GetUInt32(t,a+8),r.Tables[o].Length=this.GetUInt32(t,a+12),r.Tables[o].NewLength=r.Tables[o].Length;for(var l=0;l<this.TablesNames.length;l++)if(r.Tables[o].TagString==this.TablesNames[l]){r.Tables[o].Required=!0,r.NumTablesRequired++;break}switch(r.Tables[o].TagString){case"head":r.IndexToLocFormat=this.GetUInt16(t,r.Tables[o].Offset+50);break;case"maxp":r.NumGlyphs=this.GetUInt16(t,r.Tables[o].Offset+4);break;case"loca":r.IndexLocaTable=o;break;case"glyf":r.IndexGlyfTable=o;break;case"cmap":r.IndexCmapTable=o;break;case"name":for(var m=r.Tables[o].Offset,g=this.GetUInt16(t,m+2),h=this.GetUInt16(t,m+4),w=0;w<g;w++){var u=m+6+12*w,d=this.GetUInt16(t,u),S=this.GetUInt16(t,u+2),f=this.GetUInt16(t,u+6),v=this.GetUInt16(t,u+8),E=this.GetUInt16(t,u+10);if(3==d&&1==S&&1==f||0==d&&3==S&&1==f){for(var b=new i,y=0;y<v/2;y++)b.append(String.fromCharCode(this.GetUInt16(t,m+h+E+2*y)));var x=b.toString();r.FontName.set(x,x)}}break}}return r},g.prototype.GetUInt8=function(t,e){return t[e]},g.prototype.GetUInt16=function(t,e){return(t[e]<<8)+t[e+1]},g.prototype.GetUInt32=function(t,e){return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3]},g.prototype.GetInt16=function(t,e){var r=(t[e]<<8)+t[e+1];return r>32767?r-65536:r},g.prototype.SetUInt16=function(t,e,r){t[e+0]=r>>>8&255,t[e+1]=255&r},g.prototype.SetUInt32=function(t,e,r){t[e+0]=r>>>24&255,t[e+1]=r>>>16&255,t[e+2]=r>>>8&255,t[e+3]=255&r},g.prototype.clear=function(){this.fonts=null,this.fontList=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.Widths=null,this.CharPdfNames=null,this.UnicodeMap=null,this.UnicodeMapBack=null,this.GlyphList=null,this.GlyphBackList=null,this.GlyphRtfList=null,this.SymsToPDF=null,this.GlyphWidths=null,this.fontsInfoStore.clear()},g}(l);e.PdfFonts=g;var h=function(){function t(){}return t.prototype.clear=function(){},t}();e.FontsInfoStore=h}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.Report.Components.StiImage,i=t.System.StiArray,n=t.System.StiString,o=t.System.Drawing.Point,a=t.System.Drawing.Rectangle,s=t.System.Text.StringBuilder,l=t.Base.Context.StiPenGeom,m=t.System.Drawing.Color,c=t.Base.Drawing.StiBrush,p=t.Base.Drawing.StiGradientBrush,g=t.Base.Drawing.StiGlareBrush,h=t.Base.Drawing.StiHatchBrush,w=t.Base.Drawing.StiGlassBrush,u=t.Base.Drawing.StiPenStyle,d=t.Base.Drawing.StiPenUtils,S=t.System.Drawing.Drawing2D.DashStyle,f=t.System.Drawing.StringFormat,v=t.Report.Components.StiText,E=t.System.Drawing.Rectangle,b=t.System.Drawing.StringAlignment,y=t.Base.Drawing.StiTextHorAlignment,x=t.Base.Drawing.StiVertAlignment,A=t.System.Drawing.StringFormatFlags,T=t.System.Drawing.Size,P=function(){function P(t,e,r){void 0===r&&(r=!1),this.penWidthDefault=.1,this.precision_digits=3,this.hiToTwips=.72,this.pdfCKT=.55228,this.makepath=!1,this.pathClosed=!1,this.path=null,this.pageStream=null,this.pdfService=null,this.assembleData=!1,this.pageNumber=0,this.matrixCache=null,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,this.pageStream=t,this.pdfService=e,this.assembleData=r,this.matrixCache=new Array}return P.prototype.calculateMinMax=function(t){null==this.xmin?this.xmin=t.x:this.xmin=Math.min(this.xmin,t.x),null==this.xmax?this.xmax=t.x:this.xmax=Math.max(this.xmax,t.x),null==this.ymin?this.ymin=t.y:this.ymin=Math.min(this.ymin,t.y),null==this.ymax?this.ymax=t.y:this.ymax=Math.max(this.ymax,t.y)},P.prototype.convertToString=function(e){return Math.round2(e,this.precision_digits).toString().stimulsoft.replaceAll(",",t.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)},P.prototype.setPen=function(e,r){if(void 0===r&&(r=!1),null==e)return!1;var i=!1;if(e.stimulsoft.is(t.Base.Context.StiPenGeom)){var n=e.stimulsoft.as(l),o=m.transparent;n.brush.stimulsoft.is(m)&&(o=n.brush.stimulsoft.as(m)),n.brush.stimulsoft.is(c)&&(o=c.toColor(n.brush.stimulsoft.as(c))),this.pdfService.setStrokeColor(o);var a=n.thickness>1?n.thickness:n.thickness*this.hiToTwips;0==a&&(a=this.penWidthDefault),this.pageStream.writeLine1("{0} w",this.convertToString(a)),(i=r&&n.penStyle!=u.Solid)&&this.pageStream.writeLine("q");var s=this.getPenStyleDashString(d.getPenStyle(n.penStyle),.025*n.thickness);null!=s&&this.pageStream.writeLine(s)}return i},P.prototype.setBrush=function(t,e,r){if(void 0===r&&(r=!1),null==t)return!1;if(this.assembleData)return(t.stimulsoft.is(p)||t.stimulsoft.is(g)||t.stimulsoft.is(h)||t.stimulsoft.is(w))&&(this.pdfService.storeShadingData1(t.stimulsoft.as(c),this.pageNumber),this.pdfService.storeHatchData(t.stimulsoft.as(c))),!1;var i=!1,n=m.transparent;if(t.stimulsoft.is(m)&&(n=t.stimulsoft.as(m)),t.stimulsoft.is(c)&&(n=c.toColor(t.stimulsoft.as(c))),this.pdfService.setNonStrokeColor(n),t.stimulsoft.is(p)||t.stimulsoft.is(g)||t.stimulsoft.is(h)||t.stimulsoft.is(w)){var s=this.matrixCache.stimulsoft.peek(),l,u,d=[new o(e.x,e.bottom),new o(e.right,e.y)];s.transformPoints(d);var S=new a(d[0].x,d[0].y,d[1].x-d[0].x,d[1].y-d[0].y),f=this.pdfService.storeShadingData2(S.x,S.y,S.width,S.height,t.stimulsoft.as(c));if((t.stimulsoft.is(p)||t.stimulsoft.is(g))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+f),t.stimulsoft.is(h)){var v=t.stimulsoft.as(h);this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.pdfService.getHatchNumber(v)+1)}i=!0}return(i=i&&r)&&this.pageStream.writeLine("q"),i},P.prototype.outputLineString=function(t,e){if(null!=e){var r=this.setPen(e,!0);this.pageStream.writeLine(t),r&&this.pageStream.writeLine("Q")}},P.prototype.convertArcToBezierPoints=function(t,e,r){var n=t.x+t.width/2,a=t.y+t.height/2,s=t.width/2;e*=Math.PI/180,r*=Math.PI/180;var l=Math.ceil(Math.abs(r)/(Math.PI/2)),m=i.create(o,3*l+1,!0),c=r/l,p=Math.sin(c/2),g=Math.cos(c/2),h=4*(1-g)/3,w=p-h*g/(p+1e-4),u=[],d=[];u[0]=g,d[0]=-p,u[1]=g+h,d[1]=-w,u[2]=g+h,d[2]=w,u[3]=g,d[3]=p;var S=Math.sin(e+c/2),f=Math.cos(e+c/2);m[0].x=n+s*(u[0]*f-d[0]*S),m[0].y=a+s*(u[0]*S+d[0]*f);for(var v=0;v<l;v++){var E=e+c*v;S=Math.sin(E+c/2),f=Math.cos(E+c/2);for(var b=1;b<=3;b++)m[b+3*v].x=n+s*(u[b]*f-d[b]*S),m[b+3*v].y=a+s*(u[b]*S+d[b]*f)}return m},P.prototype.convertSplineToCubicBezier=function(t,e){var r=t.length,i=3*r-2,n=[];e*=.3,n[0]=t[0],n[1]=this.calculateCurveBezierEndPoints(t[0],t[1],e);for(var o=0;o<r-2;o++){var a=this.calculateCurveBezier(t,o,e);n[3*o+2]=a[0],n[3*o+3]=t[o+1],n[3*o+4]=a[1]}return n[i-2]=this.calculateCurveBezierEndPoints(t[r-1],t[r-2],e),n[i-1]=t[r-1],n},P.prototype.calculateCurveBezier=function(t,e,r){var i=t[e+2].x-t[e+0].x,n=t[e+2].y-t[e+0].y,a,s;return[new o(t[e+1].x-r*i,t[e+1].y-r*n),new o(t[e+1].x+r*i,t[e+1].y+r*n)]},P.prototype.calculateCurveBezierEndPoints=function(t,e,r){return new o(r*(e.x-t.x)+t.x,r*(e.y-t.y)+t.y)},P.prototype.getPointString=function(t){return this.calculateMinMax(t),n.format("{0} {1} {2} ",this.convertToString(t.x),this.convertToString(t.y),this.makepath&&this.path.length>0?"l":"m")},P.prototype.getLineToString=function(t){return this.calculateMinMax(t),n.format("{0} {1} l ",this.convertToString(t.x),this.convertToString(t.y))},P.prototype.getRectString4=function(t,e,r,i){return this.getRectString(new a(t,e,r,i))},P.prototype.getRectString=function(t){return n.format("{0} {1} {2} {3} re ",this.convertToString(t.x),this.convertToString(t.top),this.convertToString(t.right-t.x),this.convertToString(t.bottom-t.y))},P.prototype.getBezierString=function(t,e,r){return this.calculateMinMax(t),this.calculateMinMax(e),this.calculateMinMax(r),n.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t.x),this.convertToString(t.y),this.convertToString(e.x),this.convertToString(e.y),this.convertToString(r.x),this.convertToString(r.y))},P.prototype.getBezierString2=function(t,e,r,i,a,s){return this.calculateMinMax(new o(t,e)),this.calculateMinMax(new o(r,i)),this.calculateMinMax(new o(a,s)),n.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t),this.convertToString(e),this.convertToString(r),this.convertToString(i),this.convertToString(a),this.convertToString(s))},P.prototype.getPolylineString=function(t,e,r){var i=new s;r||i.append(this.getPointString(t[0]));for(var n=r?0:1;n<t.length;n++)i.append(this.getLineToString(t[n]));return e&&i.append("h "),i.toString()},P.prototype.getEllipseString4=function(t,e,r,i){return this.getEllipseString(new a(t,e,r,i))},P.prototype.getEllipseString=function(t){var e=t.width/2*(1-this.pdfCKT),r=t.height/2*(1-this.pdfCKT),i=new s;return i.appendFormat("{0} {1} m ",this.convertToString(t.x),this.convertToString(t.y+t.height/2)),i.append(this.getBezierString2(t.x,t.y+t.height-r,t.x+e,t.y+t.height,t.x+t.width/2,t.y+t.height)),i.append(this.getBezierString2(t.x+t.width-e,t.y+t.height,t.x+t.width,t.y+t.height-r,t.x+t.width,t.y+t.height/2)),i.append(this.getBezierString2(t.x+t.width,t.y+r,t.x+t.width-e,t.y,t.x+t.width/2,t.y)),i.append(this.getBezierString2(t.x+e,t.y,t.x,t.y+r,t.x,t.y+t.height/2)),i.toString()},P.prototype.getPenStyleDashString=function(t,e){switch(t){case S.Dot:return n.format("[{0} {1}] 0 d",this.convertToString(e),this.convertToString(58*e));case S.Dash:return n.format("[{0} {1}] 0 d",this.convertToString(49.5*e),this.convertToString(62*e));case S.DashDot:return n.format("[{0} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e));case S.DashDotDot:return n.format("[{0} {1} {2} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e))}return null},P.prototype.beginPath=function(){if(this.assembleData)return;this.path=new s,this.makepath=!0,this.pathClosed=!1,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null},P.prototype.closeFigure=function(){if(this.assembleData)return;this.path.append("h "),this.pathClosed=!0},P.prototype.endPath=function(){if(this.assembleData)return;this.makepath=!1},P.prototype.fillPath=function(t){var e=this.assembleData?new a:new a(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r=this.setBrush(t,e,!0);if(this.assembleData)return;this.pathClosed||this.endPath(),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("f"),r&&this.pageStream.writeLine("Q")},P.prototype.strokePath=function(t){if(this.assembleData)return;this.setPen(t),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("S")},P.prototype.moveTo=function(t){if(this.assembleData)return;this.lastPoint=t;var e=this.getPointString(t);this.makepath?this.path.appendLine(e):this.pageStream.writeLine(e)},P.prototype.drawLine=function(t,e,r){if(this.assembleData)return;var i=this.getPointString(t)+this.getLineToString(e);this.makepath?this.path.appendLine(i):this.outputLineString(i+"S",r),this.lastPoint=e},P.prototype.drawLineTo=function(t,e){if(this.assembleData)return;var r=this.getLineToString(t);this.makepath?this.path.appendLine(r):this.outputLineString(r+"S",e),this.lastPoint=t},P.prototype.drawRectangle=function(t,e){if(this.assembleData)return;this.outputLineString(this.getRectString(t)+"S",e)},P.prototype.fillRectangle=function(t,e){var r=this.setBrush(e,t,!0);if(this.assembleData)return;null!=e&&this.pageStream.writeLine(this.getRectString(t)+"f"),r&&this.pageStream.writeLine("Q")},P.prototype.drawPolygon=function(t,e){this.drawPolyline(t,e,!0)},P.prototype.drawPolyline=function(t,e,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.assembleData)return;var n=this.getPolylineString(t,r,i);this.makepath?this.path.appendLine(n):this.outputLineString(n+"S",e),this.lastPoint=t[t.length-1]},P.prototype.drawPolylineTo=function(t,e){this.drawPolyline(t,e,!1,!0)},P.prototype.fillPolygon=function(t,e){var r,i;try{for(var n=__values(t),o=n.next();!o.done;o=n.next()){var s=o.value;this.calculateMinMax(s)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}var l=new a(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),m=this.setBrush(e,l,!0);if(this.assembleData)return;if(null!=e){var c=this.getPolylineString(t,!0,!1);this.pageStream.writeLine(c+"f")}m&&this.pageStream.writeLine("Q")},P.prototype.drawBezier=function(t,e,r,i,n){if(this.assembleData)return;var o=this.getPointString(t)+this.getBezierString(e,r,i);this.makepath?this.path.appendLine(o):this.outputLineString(o+"S",n),this.lastPoint=i},P.prototype.drawBezierTo=function(t,e,r,i){if(this.assembleData)return;var n=this.getBezierString(t,e,r);this.makepath?this.path.appendLine(n):this.outputLineString(n+"S",i),this.lastPoint=r},P.prototype.drawSpline=function(t,e,r){if(this.assembleData)return;var i=this.convertSplineToCubicBezier(t,e),n=(i.length-1)/3,o=new s;o.append(this.getPointString(i[0])+this.getBezierString(i[1],i[2],i[3]));for(var a=1;a<n;a++)o.append(this.getBezierString(i[3*a+1],i[3*a+2],i[3*a+3]));this.makepath?this.path.appendLine(o.toString()):this.outputLineString(o.toString()+"S",r),this.lastPoint=i[i.length-1]},P.prototype.drawArc=function(t,e,r){if(this.assembleData)return;var i=this.convertArcToBezierPoints(t,e,r),n=(i.length-1)/3;this.drawBezier(i[0],i[1],i[2],i[3],null);for(var o=1;o<n;o++)this.drawBezierTo(i[3*o+1],i[3*o+2],i[3*o+3],null)},P.prototype.drawEllipse=function(t,e){if(this.assembleData)return;this.outputLineString(this.getEllipseString(t)+"S",e)},P.prototype.fillEllipse=function(t,e){var r=this.setBrush(e,t,!0);if(this.assembleData)return;null!=e&&this.pageStream.writeLine(this.getEllipseString(t)+"f"),r&&this.pageStream.writeLine("Q")},P.prototype.drawPie=function(t,e,r){if(this.assembleData)return;var i=this.convertArcToBezierPoints(t,e,r),n=(i.length-1)/3,a=t.x+t.width/2,s=t.y+t.height/2;this.drawBezier(i[0],i[1],i[2],i[3],null);for(var l=1;l<n;l++)this.drawBezierTo(i[3*l+1],i[3*l+2],i[3*l+3],null);this.drawLineTo(new o(a,s),null),this.drawLineTo(i[0],null)},P.prototype.drawString=function(t,r,i,n,o){if(this.assembleData){if(null!=r)var a=this.pdfService.pdfFont.getFontNumber(r);return void this.pdfService.pdfFont.storeUnicodeSymbolsInMap(t)}var s=new v;s.clientRectangle=new E(n.x,n.y,n.width,n.height),s.text=t,s.font=r,s.textBrush=i,o||(o=new f),o.alignment==b.Center&&(s.horAlignment=y.Center),o.alignment==b.Far&&(s.horAlignment=y.Right),o.lineAlignment==b.Center&&(s.vertAlignment=x.Center),o.lineAlignment==b.Far&&(s.vertAlignment=x.Bottom),0==(o.formatFlags&A.NoWrap)&&(s.wordWrap=!0);var l=new e.StiPdfData(this.pdfService);l.Component=s,l.Width=n.width*this.hiToTwips,l.Height=n.height*this.hiToTwips,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(n.x),this.convertToString(n.y+n.height)),this.pageStream.writeLine("1.39 0 0 -1.39 0 0 cm"),e.StiPdfRenderText.renderTextFont(l),e.StiPdfRenderText.renderText(l),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()},P.prototype.saveState=function(){if(this.assembleData)return;this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.matrixCache.length>0&&this.matrixCache.push(this.matrixCache.stimulsoft.peek().clone())},P.prototype.restoreState=function(){if(this.assembleData)return;this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack(),this.matrixCache.length>0&&this.matrixCache.pop()},P.prototype.translateTransform=function(t,e){if(this.assembleData)return;this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(t),this.convertToString(e)),this.matrixCache.length>0&&this.matrixCache.stimulsoft.peek().translate(t,e)},P.prototype.rotateTransform=function(t){if(this.assembleData)return;var e=t*Math.PI/180;this.pageStream.writeLine1("{0} {1} {2} {3} 0 0 cm",this.convertToString(Math.cos(e)),this.convertToString(Math.sin(e)),this.convertToString(-Math.sin(e)),this.convertToString(Math.cos(e))),this.matrixCache.length>0&&this.matrixCache.stimulsoft.peek().rotate(t)},P.prototype.setClip=function(t){if(this.assembleData)return;this.pageStream.writeLine(this.getRectString(t)+"W n")},P.prototype.drawArc2=function(t,e,r,i){},P.prototype.drawText=function(t,e,r,i,n,o,a){},P.prototype.setPixel=function(t,e){},P.prototype.measureString=function(t,e){return new T(0,0)},P.prototype.drawImage=function(t,i){var n=new r;if(n.clientRectangle=i,n.imageToDraw=t,n.smoothing=!0,n.stretch=!0,this.assembleData)return void this.pdfService.storeImageDataForGeom(n);var o=new e.StiPdfData(this.pdfService);o.Component=n,o.Width=i.width,o.Height=i.height,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(i.x),this.convertToString(i.y+i.height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pdfService.renderImage(o,100),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()},P}();e.StiPdfGeomWriter=P}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.System.Drawing.Color,i=t.System.Drawing.Graphics,n=t.Base.Context.StiContext,o=t.Base.Context.StiContextPainter,a=t.System.Drawing.Point,s=t.System.Drawing.Point,l=t.System.Drawing.Rectangle,m=t.System.Drawing.Rectangle,c=t.System.Drawing.StringFormat,p=t.Base.Drawing.StiRotationMode,g=t.Base.Context.StiPushTranslateTransformGeom,h=t.Base.Context.StiPushRotateTransformGeom,w=t.Base.Context.StiPopTransformGeom,u=t.Base.Context.StiBorderGeom,d=t.Base.Context.StiLineGeom,S=t.Base.Context.StiLinesGeom,f=t.Base.Context.StiPushClipGeom,v=t.Base.Context.StiPopClipGeom,E=t.Base.Context.StiPushSmothingModeToAntiAliasGeom,b=t.Base.Context.StiPopSmothingModeGeom,y=t.Base.Context.StiPushTextRenderingHintToAntiAliasGeom,x=t.Base.Context.StiPopTextRenderingHintGeom,A=t.Base.Context.StiCurveGeom,T=t.Base.Context.StiEllipseGeom,P=t.Base.Context.StiCachedShadowGeom,L=t.Base.Drawing.StiShadowSides,C=t.Base.Drawing.StiSolidBrush,F=t.Base.Context.StiShadowGeom,B=t.Base.Context.StiTextGeom,k=t.Base.Context.StiPathGeom,R=t.Base.Context.StiPieSegmentGeom,I=t.Base.Context.StiArcSegmentGeom,D=t.Base.Context.StiLineSegmentGeom,N=t.Base.Context.StiLinesSegmentGeom,O=t.Base.Context.StiCurveSegmentGeom,H=t.Base.Context.StiCloseFigureSegmentGeom,M=t.System.Drawing.Drawing2D.Matrix,W=t.Report.Chart.IStiChart,U=t.Base.Drawing.StiPenStyle,X=t.System.Drawing.Font,z=t.Base.Drawing.StiBrush,V=t.Report.Components.StiImageRotation,G=function(){function G(){}return G.renderChart=function(p,U,z){var G,Y,j,_,q=p.Component.stimulsoft.as(W),K=.96,Q=p.service.report.unit.convertToHInches(p.Component.width)*K,J=p.service.report.unit.convertToHInches(p.Component.height)*K,Z=0,$=0,tt=0,et=1,rt=1;switch(q.rotation){case V.Rotate90CCW:Z=-90,tt=J;break;case V.Rotate90CW:Z=90,$=Q;break;case V.Rotate180:Z=-180,$=Q,tt=J;break;case V.FlipVertical:rt=-1,tt=J;break;case V.FlipHorizontal:et=-1,$=Q;break}switch(q.rotation){case V.Rotate90CCW:case V.Rotate90CW:var it=Q;Q=J,J=it;break}if(!U&&q.rotation!=V.None){var nt=new M(1,0,0,1,0,0);nt.translate($,tt),nt.scale(et,rt),nt.rotate(Z),p.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",p.service.convertToString(nt.elements[0]),p.service.convertToString(nt.elements[1]),p.service.convertToString(nt.elements[2]),p.service.convertToString(nt.elements[3]),p.service.convertToString(nt.elements[4]),p.service.convertToString(nt.elements[5]))}var ot=new o,at=new n(ot,!0,!1,!1,1),st=q.isAnimation,lt;q.isAnimation=!1,q.core.render(at,new m(0,0,Q,J),!0).drawGeom(at),q.isAnimation=st;var mt=new M(1,0,0,1,0,0),ct=p.service.hiToTwips/.96;mt.translate(p.X,p.Y+p.Height),mt.scale(1,-1),mt.scale(ct,ct);var pt=new e.StiPdfGeomWriter(p.service.pageStream,p.service,U);pt.pageNumber=z,pt.matrixCache.push(mt);try{for(var gt=__values(at.geoms),ht=gt.next();!ht.done;ht=gt.next()){var wt=ht.value;if(wt.stimulsoft.is(g)){var ut=wt.stimulsoft.as(g);pt.saveState(),pt.translateTransform(ut.x,ut.y)}if(wt.stimulsoft.is(h)){var dt=wt.stimulsoft.as(h);pt.saveState(),pt.rotateTransform(dt.angle)}if(wt.stimulsoft.is(w)&&pt.restoreState(),wt.stimulsoft.is(f)){var St=wt.stimulsoft.as(f);pt.saveState(),pt.setClip(St.clipRectangle)}if(wt.stimulsoft.is(v)&&pt.restoreState(),wt.stimulsoft.is(E)&&pt.saveState(),wt.stimulsoft.is(b)&&pt.restoreState(),wt.stimulsoft.is(y)&&pt.saveState(),wt.stimulsoft.is(x)&&pt.restoreState(),wt.stimulsoft.is(u)){var ft=wt.stimulsoft.as(u);null!=ft.background&&pt.fillRectangle(this.rectToRectangle(ft.rect),ft.background),this.checkPenGeom(ft.borderPen)&&pt.drawRectangle(this.rectToRectangle(ft.rect),ft.borderPen)}if(wt.stimulsoft.is(d)){var vt=wt.stimulsoft.as(d);this.checkPenGeom(vt.pen)&&pt.drawLine(new a(vt.x1,vt.y1),new a(vt.x2,vt.y2),vt.pen)}if(wt.stimulsoft.is(S)){var Et=wt.stimulsoft.as(S);this.checkPenGeom(Et.pen)&&pt.drawPolyline(Et.points,Et.pen)}if(wt.stimulsoft.is(A)){var bt=wt.stimulsoft.as(A);this.checkPenGeom(bt.pen)&&pt.drawSpline(bt.points,bt.tension,bt.pen)}if(wt.stimulsoft.is(T)){var yt=wt.stimulsoft.as(T);null!=yt.background&&pt.fillEllipse(this.rectToRectangle(yt.rect),yt.background),this.checkPenGeom(yt.borderPen)&&pt.drawEllipse(this.rectToRectangle(yt.rect),yt.borderPen)}if(wt.stimulsoft.is(P)){var xt=wt.stimulsoft.as(P),At=xt.rect,Tt=xt.sides,Pt=At.y+8,Lt=At.x+8,Ct=(Tt&L.Edge)>0?4:0;(Tt&L.Top)>0&&(Pt=At.y+4),(Tt&L.Left)>0&&(Lt=At.x+4);for(var Ft=0;Ft<3;Ft++){var Bt=new Array;(Tt&L.Right)>0?(Bt.push(new a(At.right,Pt)),(Tt&L.Bottom)>0?(Bt.push(new a(At.right,At.bottom)),Bt.push(new a(Lt,At.bottom)),Bt.push(new a(Lt,At.bottom+Ft+1)),Bt.push(new a(At.right+Ft+1,At.bottom+Ft+1))):(Bt.push(new a(At.right,At.bottom+Ct)),Bt.push(new a(At.right+Ft+1,At.bottom+Ct))),Bt.push(new a(At.right+Ft+1,Pt))):(Bt.push(new a(Lt,At.bottom)),Bt.push(new a(At.right+Ct,At.bottom)),Bt.push(new a(At.right+Ct,At.bottom+Ft+1)),Bt.push(new a(Lt,At.bottom+Ft+1)));var kt=new C(r.fromArgb(40-10*Ft,r.black));pt.fillPolygon(Bt,kt)}}if(wt.stimulsoft.is(F))var Rt=wt.stimulsoft.as(F);if(wt.stimulsoft.is(B)){var It=wt.stimulsoft.as(B),Dt=new X(It.font.fontName,It.font.fontSize,It.font.fontStyle,It.font.unit),Nt=new c;Nt.alignment=It.stringFormat.alignment,Nt.formatFlags=It.stringFormat.formatFlags,Nt.hotkeyPrefix=It.stringFormat.hotkeyPrefix,Nt.lineAlignment=It.stringFormat.lineAlignment,Nt.trimming=It.stringFormat.trimming;var Ot=this.brushToStiBrush(It.brush);if(It.isRotatedText){var Ht=new a;if(It.location.stimulsoft.is(a))Ht=It.location.stimulsoft.as(a);else if(It.location.stimulsoft.is(s)){var Mt=It.location.stimulsoft.as(s);Ht=new a(Mt.x,Mt.y)}else{var Wt=this.rectToRectangle(It.location);Ht=new a(Wt.x+Wt.width/2,Wt.y+Wt.height/2)}var Ut=i.measureString(It.text,Dt,It.maximalWidth),Xt=new l(0,0,Ut.width,Ut.height),zt=this.getStartPoint(It.rotationMode,Xt);Xt.x-=zt.x,Xt.y-=zt.y,Nt.alignment==t.System.Drawing.StringAlignment.Center&&(Xt.x-=1),Nt.alignment==t.System.Drawing.StringAlignment.Far&&(Xt.x-=2),Xt.width+=2.5,pt.saveState(),pt.translateTransform(Ht.x,Ht.y),0!=It.angle&&pt.rotateTransform(It.angle),pt.drawString(It.text,Dt,Ot,Xt,Nt),pt.restoreState()}else pt.drawString(It.text,Dt,Ot,this.rectToRectangle(It.location),Nt)}if(wt.stimulsoft.is(k)){var Vt=wt.stimulsoft.as(k);pt.beginPath();try{for(var Gt=(j=void 0,__values(Vt.geoms)),Yt=Gt.next();!Yt.done;Yt=Gt.next()){var jt=Yt.value;if(jt.stimulsoft.is(R)){var _t=jt.stimulsoft.as(R);pt.drawPie(_t.rect,_t.startAngle,_t.sweepAngle)}if(jt.stimulsoft.is(I)){var qt=jt.stimulsoft.as(I);pt.drawArc(qt.rect,qt.startAngle,qt.sweepAngle)}if(jt.stimulsoft.is(D)){var Kt=jt.stimulsoft.as(D);pt.drawLine(new a(Kt.x1,Kt.y1),new a(Kt.x2,Kt.y2),null)}if(jt.stimulsoft.is(N)){var Qt=jt.stimulsoft.as(N);pt.drawPolyline(Qt.points,null)}if(jt.stimulsoft.is(O)){var Jt=jt.stimulsoft.as(O);pt.drawSpline(Jt.points,Jt.tension,null)}jt.stimulsoft.is(H)&&pt.closeFigure()}}catch(t){j={error:t}}finally{try{Yt&&!Yt.done&&(_=Gt.return)&&_.call(Gt)}finally{if(j)throw j.error}}pt.closeFigure(),pt.endPath(),null!=Vt.background&&pt.fillPath(Vt.background),this.checkPenGeom(Vt.pen)&&pt.strokePath(Vt.pen)}}}catch(t){G={error:t}}finally{try{ht&&!ht.done&&(Y=gt.return)&&Y.call(gt)}finally{if(G)throw G.error}}},G.getStartPoint=function(t,e){var r=new a(e.x+e.width/2,e.y+e.height/2);switch(t){case p.LeftCenter:return new a(e.x,r.y);case p.LeftBottom:return new a(e.x,e.bottom);case p.CenterTop:return new a(r.x,e.top);case p.CenterCenter:return r;case p.CenterBottom:return new a(r.x,e.bottom);case p.RightTop:return new a(e.right,e.top);case p.RightCenter:return new a(e.right,r.y);case p.RightBottom:return new a(e.right,e.bottom);default:return new a(e.x,e.y)}},G.rectToRectangle=function(t){if(null==t)return new l;if(t.stimulsoft.is(l))return t.stimulsoft.as(l);if(t.stimulsoft.is(m)){var e=t.stimulsoft.as(m);return new l(e.x,e.y,e.width,e.height)}return new l},G.brushToStiBrush=function(t){if(null==t)return null;if(t.stimulsoft.is(r))return new C(t.stimulsoft.as(r));if(t.stimulsoft.is(z))return t.stimulsoft.as(z);return null},G.checkPenGeom=function(t){return!(null==t||null==t.brush||t.penStyle==U.None)},G}();e.StiPdfRenderChart=G}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.Base.Drawing.StiSolidBrush,i=t.Base.Drawing.StiGradientBrush,n=t.Base.Drawing.StiColorUtils,o=t.Report.Components.StiDataBarDirection,a=t.Report.Components.StiDataBarIndicator,s=t.System.Drawing.ContentAlignment,l=t.Report.Components.StiIcon,m=t.Report.Components.StiIconSetIndicator,c=t.Report.Components.StiText,p=function(){function p(){}return p.renderIndicators=function(p){var g=p.Component.as(c);if(null==g||null==g.indicator)return p;var h=new Rectangle(p.X,p.Y,p.Width,p.Height),w=g.indicator.stimulsoft.as(m);if(null!=w&&(w.icon!=l.None||null!=w.customIcon)){var u=p.service.imageList[p.service.imagesCurrent],d=u.Width*p.service.hiToTwips,S=u.Height*p.service.hiToTwips,f=h.clone(),v=p.service.hiToTwips;switch(f.inflate(-v,-v),w.alignment){case s.TopLeft:f=new Rectangle(f.x,f.bottom-S,d,S),h.x+=f.width+1,h.width-=f.width+1;break;case s.TopCenter:f=new Rectangle(f.x+(f.width-d)/2,f.bottom-S,d,S);break;case s.TopRight:f=new Rectangle(f.right-d,f.bottom-S,d,S),h.width-=f.width+1;break;case s.MiddleLeft:f=new Rectangle(f.x,f.y+(f.height-S)/2,d,S),h.x+=f.width+1,h.width-=f.width+1;break;case s.MiddleCenter:f=new Rectangle(f.x+(f.width-d)/2,f.y+(f.height-S)/2,d,S);break;case s.MiddleRight:f=new Rectangle(f.right-d,f.y+(f.height-S)/2,d,S),h.width-=f.width+1;break;case s.BottomLeft:f=new Rectangle(f.x,f.y,d,S),h.x+=f.width+1,h.width-=f.width+1;break;case s.BottomCenter:f=new Rectangle(f.x+(f.width-d)/2,f.y,d,S);break;case s.BottomRight:f=new Rectangle(f.right-d,f.y,d,S),h.width-=f.width+1;break}var E=new e.StiPdfData(p.service);E.X=f.x,E.Y=f.y,E.Width=f.width,E.Height=f.height,p.service.writeImageInfo2(E,1,1)}var b=g.indicator.stimulsoft.as(a);if(null!=b&&0!=b.value){var y=h.clone(),v=p.service.hiToTwips;y.inflate(-2*v,-2*v);var x=b.maximum+Math.abs(b.minimum),A=y.width*Math.abs(b.minimum)/x,T=y.width*b.maximum/x,P=y.width*Math.abs(b.value)/x,L=b.direction;L==o.Default&&(L=null!=g.textOptions&&g.textOptions.rightToLeft?o.RighToLeft:o.LeftToRight);var C=0;L==o.LeftToRight?(b.value<0?y.x+=A-P:y.x+=A,y.width=P):(C=180,b.value<0?y.x=y.right-A:y.x=y.right-A-P,y.width=P),b.value<0&&(C+=180);var F=!1;if(y.width>0&&y.height>0){if(b.brushType==t.Report.Components.StiBrushType.Gradient){var B=void 0;if(B=L==o.LeftToRight?b.value>0?new Rectangle(h.left+A,h.top,T,h.height):new Rectangle(h.left,h.top,A,h.height):b.value<0?new Rectangle(h.left+T,h.top,A,h.height):new Rectangle(h.left,h.top,T,h.height),y.width>0&&y.width<1&&(y.width=1),B.width>0&&B.width<1&&(B.width=1),B.width>0&&y.width>0){var k=b.value<0?b.negativeColor:b.positiveColor,R=n.light(k,200);B.x-=.1*B.width,B.width+=.2*B.width;var I=new i(k,R,C);p.service.fillRectBrush(I,y);var D=p.service.shadingArray[p.service.shadingCurrent-1];D.Angle=C,D.X=B.x,D.Y=B.y,D.Width=B.width,D.Height=B.height,D.FunctionIndex=p.service.getShadingFunctionNumber(k,R,!1),p.service.shadingArray[p.service.shadingCurrent-1]=D,F=!0}}else{var I=new r(b.value<0?b.negativeColor:b.positiveColor);p.service.fillRectBrush(I,y)}b.showBorder&&(p.service.pageStream.writeLine("q"),p.service.pushColorToStack(),p.service.setStrokeColor(b.value<0?b.negativeBorderColor:b.positiveBorderColor),p.service.pageStream.writeLine1("{0} {1} {2} {3} re S",p.service.convertToString(y.x),p.service.convertToString(y.y),p.service.convertToString(y.width),p.service.convertToString(y.height)),p.service.pageStream.writeLine("Q"),p.service.popColorFromStack())}F||b.brushType!=t.Report.Components.StiBrushType.Gradient||p.service.shadingCurrent++}var N=new e.StiPdfData(p.service);return N.X=h.x,N.Y=p.Y,N.Width=h.width,N.Height=p.Height,N.Component=p.Component,N},p}();e.StiPdfRenderIndicators=p}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.System.Drawing.Color,i=t.Base.Drawing.StiBrush,n=t.Base.Drawing.StiGradientBrush,o=t.Base.Drawing.StiGlareBrush,a=t.Base.Drawing.StiHatchBrush,s=t.Report.Components.IStiBrush,l=t.Base.Drawing.StiBorderSides,m=t.Report.Components.IStiBorder,c=t.Base.Drawing.StiBorderSide,p=t.Base.Drawing.StiAdvancedBorder,g=t.Base.Drawing.StiPenStyle,h=t.Report.Components.StiShape,w=t.Report.Components.StiVerticalLineShapeType,u=t.Report.Components.StiHorizontalLineShapeType,d=t.Report.Components.StiTopAndBottomLineShapeType,S=t.Report.Components.StiLeftAndRightLineShapeType,f=t.Report.Components.StiRectangleShapeType,v=t.Report.Components.StiRoundedRectangleShapeType,E=t.Report.Components.StiDiagonalDownLineShapeType,b=t.Report.Components.StiDiagonalUpLineShapeType,y=t.Report.Components.StiTriangleShapeType,x=t.Report.Components.StiOvalShapeType,A=t.Report.Components.StiArrowShapeType,T=t.Report.Components.StiOctagonShapeType,P=t.Report.Components.StiComplexArrowShapeType,L=t.Report.Components.StiBentArrowShapeType,C=t.Report.Components.StiChevronShapeType,F=t.Report.Components.StiDivisionShapeType,B=t.Report.Components.StiEqualShapeType,k=t.Report.Components.StiFlowchartCardShapeType,R=t.Report.Components.StiFlowchartCollateShapeType,I=t.Report.Components.StiFlowchartDecisionShapeType,D=t.Report.Components.StiFlowchartManualInputShapeType,N=t.Report.Components.StiFlowchartOffPageConnectorShapeType,O=t.Report.Components.StiFlowchartPreparationShapeType,H=t.Report.Components.StiFlowchartSortShapeType,M=t.Report.Components.StiFrameShapeType,W=t.Report.Components.StiMinusShapeType,U=t.Report.Components.StiMultiplyShapeType,X=t.Report.Components.StiParallelogramShapeType,z=t.Report.Components.StiPlusShapeType,V=t.Report.Components.StiRegularPentagonShapeType,G=t.Report.Components.StiTrapezoidShapeType,Y=t.Report.Components.StiSnipSameSideCornerRectangleShapeType,j=t.Report.Components.StiSnipDiagonalSideCornerRectangleShapeType,_=t.Report.Components.StiShapeDirection,q=t.System.Drawing.Rectangle,K=t.Report.Components.StiCheckBox,Q=t.Report.Components.StiCheckStyle,J=t.Report.Components.StiRoundedRectanglePrimitive,Z=t.System.StiString,$=function(){function t(){}return t.renderBorder1=function(t){var e=null,r=t.Component.stimulsoft.as(s);null!=r&&null!=r.brush&&(e=r.brush),null!=e&&t.service.fillRectBrush(e,new q(t.X,t.Y,t.Width,t.Height))},t.renderBorder2=function(t){var e=t.Component.stimulsoft.as(m);if(null!=e){var n=r.transparent;if(e.border.dropShadow&&null!=e.border.shadowBrush&&0!=(n=i.toColor(e.border.shadowBrush)).a){var o=.8*e.border.shadowSize;t.service.setNonStrokeColor(n),t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X+o),t.service.convertToString(t.Y-o),t.service.convertToString(t.Width-o),t.service.convertToString(o)),t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y-o),t.service.convertToString(o),t.service.convertToString(t.Height))}var a=new c(e.border.color,e.border.size,e.border.style),s=e.border.stimulsoft.as(p),h=null!=s,w=e.border.isLeftBorderSidePresent,u=e.border.isRightBorderSidePresent,d=e.border.isTopBorderSidePresent,S=e.border.isBottomBorderSidePresent,f=e.border.style!=g.None&&e.border.style!=g.Solid,v=e.border.side!=l.None&&e.border.style!=g.None;if(h&&(v=s.side!=l.None),v){var E=0;h||(f&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),E=this.storeBorderSideData(a,t)),h||e.border.side!=l.All?(w&&(h&&((a=s.leftSide).style!=g.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),E=this.storeBorderSideData(a,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-E),t.service.convertToString(t.Y-E)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X-E),t.service.convertToString(t.Y+t.Height+E)),a.style==g.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+E),t.service.convertToString(t.Y+(S?E:-E))),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+E),t.service.convertToString(t.Y+t.Height+(d?-E:E)))),h&&a.style!=g.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),u&&(h&&((a=s.rightSide).style!=g.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),E=this.storeBorderSideData(a,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width+E),t.service.convertToString(t.Y-E)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+E),t.service.convertToString(t.Y+t.Height+E)),a.style==g.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width-E),t.service.convertToString(t.Y+(S?E:-E))),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width-E),t.service.convertToString(t.Y+t.Height+(d?-E:E)))),h&&a.style!=g.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),d&&(h&&((a=s.topSide).style!=g.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),E=this.storeBorderSideData(a,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-E),t.service.convertToString(t.Y+t.Height+E)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+E),t.service.convertToString(t.Y+t.Height+E)),a.style==g.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+(w?E:-E)),t.service.convertToString(t.Y+t.Height-E)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+(u?-E:E)),t.service.convertToString(t.Y+t.Height-E))),h&&a.style!=g.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),S&&(h&&((a=s.bottomSide).style!=g.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),E=this.storeBorderSideData(a,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-E),t.service.convertToString(t.Y-E)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+E),t.service.convertToString(t.Y-E)),a.style==g.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+(w?E:-E)),t.service.convertToString(t.Y+E)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+(u?-E:E)),t.service.convertToString(t.Y+E))),h&&a.style!=g.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()))):(t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(t.X-E),t.service.convertToString(t.Y-E),t.service.convertToString(t.Width+2*E),t.service.convertToString(t.Height+2*E)),e.border.style==g.Double&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(t.X+E),t.service.convertToString(t.Y+E),t.service.convertToString(t.Width-2*E),t.service.convertToString(t.Height-2*E))),!h&&f&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())}}},t.storeBorderSideData=function(t,e){var r=t.size;r<1&&(r=1),t.style==g.Double&&(r=1);var i=r*e.service.hiToTwips*.955;e.service.pageStream.writeLine1("{0} w",e.service.convertToString(i));var n=this.getPenStyleDashString(t.style,.04*i,e);return null!=n&&e.service.pageStream.writeLine(n),e.service.setStrokeColor(t.color),t.style==g.Double?i:0},t.getPenStyleDashString=function(t,e,r){switch(t){case g.Dot:return Z.format("[{0} {1}] 0 d",r.service.convertToString(e),r.service.convertToString(58*e));case g.Dash:return Z.format("[{0} {1}] 0 d",r.service.convertToString(49.5*e),r.service.convertToString(62*e));case g.DashDot:return Z.format("[{0} {1} {2} {1}] 0 d",r.service.convertToString(50*e),r.service.convertToString(55*e),r.service.convertToString(e));case g.DashDotDot:return Z.format("[{0} {1} {2} {1} {2} {1}] 0 d",r.service.convertToString(50*e),r.service.convertToString(55*e),r.service.convertToString(e))}return null},t.checkShape=function(t){if(t.shapeType.stimulsoft.is(w)||t.shapeType.stimulsoft.is(u)||t.shapeType.stimulsoft.is(d)||t.shapeType.stimulsoft.is(S)||t.shapeType.stimulsoft.is(f)||t.shapeType.stimulsoft.is(v)||t.shapeType.stimulsoft.is(E)||t.shapeType.stimulsoft.is(b)||t.shapeType.stimulsoft.is(y)||t.shapeType.stimulsoft.is(x)||t.shapeType.stimulsoft.is(A)||t.shapeType.stimulsoft.is(T)||t.shapeType.stimulsoft.is(P)||t.shapeType.stimulsoft.is(L)||t.shapeType.stimulsoft.is(C)||t.shapeType.stimulsoft.is(F)||t.shapeType.stimulsoft.is(B)||t.shapeType.stimulsoft.is(k)||t.shapeType.stimulsoft.is(R)||t.shapeType.stimulsoft.is(I)||t.shapeType.stimulsoft.is(D)||t.shapeType.stimulsoft.is(N)||t.shapeType.stimulsoft.is(O)||t.shapeType.stimulsoft.is(H)||t.shapeType.stimulsoft.is(M)||t.shapeType.stimulsoft.is(W)||t.shapeType.stimulsoft.is(U)||t.shapeType.stimulsoft.is(X)||t.shapeType.stimulsoft.is(z)||t.shapeType.stimulsoft.is(V)||t.shapeType.stimulsoft.is(G)||t.shapeType.stimulsoft.is(Y)||t.shapeType.stimulsoft.is(j))return!0;return!1},t.renderShape=function(t,l){var m=t.Component.stimulsoft.as(h);if(null!=m)if(1==this.checkShape(m)){var c=t.Component.stimulsoft.as(s),p=new e.StiPdfGeomWriter(t.service.pageStream,t.service,!1),K=r.transparent;if(null!=c&&(K=i.toColor(c.brush)),0!=K.a&&t.service.setNonStrokeColor(K),null!=c&&((c.brush.stimulsoft.is(n)||c.brush.stimulsoft.is(o))&&(t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,c.brush),t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent)),c.brush.stimulsoft.is(a))){var Q=c.brush.stimulsoft.as(a);t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(Q)+1)}var J=m.borderColor;t.service.setStrokeColor(J);var Z=K.a>0,$=m.style!=g.None;if(!Z&&!$)return;var tt=Z?$?"B":"f":$?"S":"n";t.service.pageStream.writeLine1("{0} w",t.service.convertToString(m.size*t.service.hiToTwips)),t.service.pageStream.writeLine("q");var et=m.size*t.service.hiToTwips*.04,rt;switch(m.style){case g.Dot:t.service.pageStream.writeLine1("[{0} {1}] 0 d",t.service.convertToString(et),t.service.convertToString(55*et));break;case g.Dash:t.service.pageStream.writeLine1("[{0} {1}] 0 d",t.service.convertToString(50*et),t.service.convertToString(55*et));break;case g.DashDot:t.service.pageStream.writeLine1("[{0} {1} {2} {1}] 0 d",t.service.convertToString(50*et),t.service.convertToString(55*et),t.service.convertToString(et));break;case g.DashDotDot:t.service.pageStream.writeLine1("[{0} {1} {2} {1} {2} {1}] 0 d",t.service.convertToString(50*et),t.service.convertToString(55*et),t.service.convertToString(et));break}if(m.shapeType.stimulsoft.is(w)&&(Z&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),$&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)))),m.shapeType.stimulsoft.is(u)&&(Z&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),$&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)))),m.shapeType.stimulsoft.is(d)&&(Z&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),$&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)))),m.shapeType.stimulsoft.is(S)&&(Z&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),$&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)))),m.shapeType.stimulsoft.is(f)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y))),m.shapeType.stimulsoft.is(E)&&(Z&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),$&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)))),m.shapeType.stimulsoft.is(b)&&(Z&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),$&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)))),m.shapeType.stimulsoft.is(y))(rt=m.shapeType.stimulsoft.as(y).direction)==_.Up&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y))),rt==_.Down&&(tt=Z?$?"B*":"f*":$?"S":"n",t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height))),rt==_.Left&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y))),rt==_.Right&&(tt=Z?$?"B*":"f*":$?"S":"n",t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y)));if(m.shapeType.stimulsoft.is(x)&&t.service.pageStream.writeLine1(p.getEllipseString(new q(t.X,t.Y,t.Width,t.Height))+tt),m.shapeType.stimulsoft.is(v)){var it=m.shapeType.stimulsoft.as(v).round,nt=t.Width;nt>t.Height&&(nt=t.Height);var ot=Math.min(nt,70)*it,at=ot*(1-t.service.pdfCKT);t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+ot)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-ot)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-at),t.service.convertToString(t.X+at),t.service.convertToString(t.Y+t.Height),t.service.convertToString(t.X+ot),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-ot),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X+t.Width-at),t.service.convertToString(t.Y+t.Height),t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-at),t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-ot)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+ot)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+at),t.service.convertToString(t.X+t.Width-at),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width-ot),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ot),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c "+tt,t.service.convertToString(t.X+at),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+at),t.service.convertToString(t.X),t.service.convertToString(t.Y+ot))}if(m.shapeType.stimulsoft.is(A)){var rt=m.shapeType.stimulsoft.as(A).direction,st=m.shapeType.stimulsoft.as(A).arrowWidth,lt=m.shapeType.stimulsoft.as(A).arrowHeight,mt=t.Width*st,ct=t.Height*lt;rt!=_.Left&&rt!=_.Right||(mt=t.Height*st,ct=t.Width*lt),0==lt&&(ct=Math.min(t.Width/2,t.Height/2)),rt==_.Up&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+mt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+mt),t.service.convertToString(t.Y+t.Height-ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-mt),t.service.convertToString(t.Y+t.Height-ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-mt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X+mt),t.service.convertToString(t.Y))),rt==_.Down&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width-mt),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-mt),t.service.convertToString(t.Y+ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+mt),t.service.convertToString(t.Y+ct)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+mt),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X+t.Width-mt),t.service.convertToString(t.Y+t.Height))),rt==_.Left&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+mt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ct),t.service.convertToString(t.Y+mt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ct),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ct),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ct),t.service.convertToString(t.Y+t.Height-mt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-mt)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+mt))),rt==_.Right&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-mt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-ct),t.service.convertToString(t.Y+t.Height-mt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-ct),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-ct),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-ct),t.service.convertToString(t.Y+mt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+mt)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-mt)))}if(m.shapeType.stimulsoft.is(T)){var pt=m.shapeType.stimulsoft.as(T),gt=(null!=m.report?m.report.unit.convertToHInches(pt.bevel):pt.bevel)*t.service.hiToTwips,ht=gt;pt.autoSize&&(gt=t.Width/(2.414*1.414),ht=t.Height/(2.414*1.414)),gt>t.Width/2&&(gt=t.Width/2),ht>t.Height/2&&(ht=t.Height/2),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+gt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-gt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+ht)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-ht)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-gt),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+gt),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-ht)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+ht)),t.service.pageStream.writeLine1("{0} {1} l "+tt,t.service.convertToString(t.X+gt),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(P)){var wt=t.Width<t.Height?t.Width/2:t.Height/2,ut=t.Height/3.8,dt=t.Width/3.8,St=t.Height<t.Width?t.Height/2:t.Width/2;switch(m.shapeType.stimulsoft.as(P).direction){case _.Left:case _.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+wt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+wt),t.service.convertToString(t.Y+ut)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-wt),t.service.convertToString(t.Y+ut)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-wt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-wt),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-wt),t.service.convertToString(t.Top-ut)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+wt),t.service.convertToString(t.Top-ut)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+wt),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2));break;case _.Down:case _.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-dt),t.service.convertToString(t.Y+St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-dt),t.service.convertToString(t.Top-St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+dt),t.service.convertToString(t.Top-St)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+dt),t.service.convertToString(t.Y+St)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y+St));break}}if(m.shapeType.stimulsoft.is(L)){var ft=0,vt=0,Et=0;switch(t.Height>t.Width?(ft=vt=t.Width/4,Et=vt/2):Et=(vt=ft=Math.floor(t.Height/4))/2,m.shapeType.stimulsoft.as(L).direction){case _.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+ft)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-(Et+ft)),t.service.convertToString(t.Y+ft)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-(Et+ft)),t.service.convertToString(t.Top-vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-2*vt),t.service.convertToString(t.Top-vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-vt),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-Et),t.service.convertToString(t.Top-vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-Et),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y));break;case _.Left:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt),t.service.convertToString(t.Top-Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt),t.service.convertToString(t.Top-2*vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt),t.service.convertToString(t.Top-vt-Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-ft),t.service.convertToString(t.Top-vt-Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-ft),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Y));break;case _.Down:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+Et),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+Et),t.service.convertToString(t.Y+vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+2*vt),t.service.convertToString(t.Y+vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt+Et),t.service.convertToString(t.Y+vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+vt+Et),t.service.convertToString(t.Top-ft)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-ft)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top));break;case _.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-vt),t.service.convertToString(t.Y+Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-vt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-vt),t.service.convertToString(t.Y+2*vt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-vt),t.service.convertToString(t.Y+vt+Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ft),t.service.convertToString(t.Y+vt+Et)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+ft),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(C)){var bt=t.Width>t.Height?t.Height/2:t.Width/2;switch(m.shapeType.stimulsoft.as(C).direction){case _.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+bt),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-bt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-bt),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Top));break;case _.Left:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+bt),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+bt),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-bt),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top));break;case _.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-bt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-bt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+bt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Top-bt));break;case _.Down:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top-bt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+bt)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+bt)),t.service.pageStream.writeLine1("{0} {1} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(F)){var wt=t.Height/3,yt=4*t.service.hiToTwips;t.service.pageStream.writeLine1(p.getRectString4(t.X,t.Y+wt+yt,t.Width,wt-2*yt)+tt),t.service.pageStream.writeLine1(p.getEllipseString4(t.X+t.Width/2-wt/2,t.Top-t.service.hiToTwips-wt,wt,wt)+tt),t.service.pageStream.writeLine1(p.getEllipseString4(t.X+t.Width/2-wt/2,t.Y+2*t.service.hiToTwips,wt,wt)+tt)}if(m.shapeType.stimulsoft.is(B)){var xt=(t.Height-t.Height/6)/2;t.service.pageStream.writeLine1(p.getRectString4(t.X,t.Top-xt,t.Width,xt)+tt),t.service.pageStream.writeLine1(p.getRectString4(t.X,t.Y,t.Width,xt)+tt)}if(m.shapeType.stimulsoft.is(k)&&(t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5),t.service.convertToString(t.X+t.Width/5),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top))),m.shapeType.stimulsoft.is(R))switch(m.shapeType.stimulsoft.as(R).direction){case _.Down:case _.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Y));break;case _.Left:case _.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Top));break}if(m.shapeType.stimulsoft.is(I)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2))),m.shapeType.stimulsoft.is(D)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5))),m.shapeType.stimulsoft.is(N)){var wt=t.Height/5,St=t.Width/5;switch(m.shapeType.stimulsoft.as(N).direction){case _.Down:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Y+wt),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+wt),t.service.convertToString(t.X),t.service.convertToString(t.Top));break;case _.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-wt),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y));break;case _.Left:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X+St),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+St),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+St),t.service.convertToString(t.Top));break;case _.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right-St),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(O)){var St=t.Width/5,wt=t.Height/5,At=t.Width/2,Tt=t.Height/2;switch(m.shapeType.stimulsoft.as(O).direction){case _.Left:case _.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-Tt),t.service.convertToString(t.X+St),t.service.convertToString(t.Top),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top-Tt),t.service.convertToString(t.Right-St),t.service.convertToString(t.Y),t.service.convertToString(t.X+St),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-Tt));break;case _.Down:case _.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X+At),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-wt),t.service.convertToString(t.Right),t.service.convertToString(t.Y+wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X+At),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+wt),t.service.convertToString(t.X),t.service.convertToString(t.Top-wt),t.service.convertToString(t.X+At),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(H)&&(t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2))),m.shapeType.stimulsoft.is(M)){var St=t.Width/7,wt=t.Height/7;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X+St),t.service.convertToString(t.Top-wt),t.service.convertToString(t.X+St),t.service.convertToString(t.Y+wt),t.service.convertToString(t.Right-St),t.service.convertToString(t.Y+wt),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top-wt))}if(m.shapeType.stimulsoft.is(W)){var wt=t.Height/3;t.service.pageStream.writeLine1(p.getRectString4(t.X,t.Y+wt,t.Width,wt)+tt)}if(m.shapeType.stimulsoft.is(U)){var St=t.Width/4,wt=t.Height/4;t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.X+St),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top-wt),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-St),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Y+wt),t.service.convertToString(t.Right-St),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.X+St),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+wt),t.service.convertToString(t.X+St),t.service.convertToString(t.Top-t.Height/2))}if(m.shapeType.stimulsoft.is(X)){var St=t.Width/7,wt=t.Height/7;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/5),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right-t.Width/5),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(z)){var St=t.Width/3,wt=t.Height/3;t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+St),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-St),t.service.convertToString(t.Top),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top-wt),t.service.convertToString(t.Right),t.service.convertToString(t.Top-wt),t.service.convertToString(t.Right),t.service.convertToString(t.Y+wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-St),t.service.convertToString(t.Y+wt),t.service.convertToString(t.Right-St),t.service.convertToString(t.Y),t.service.convertToString(t.X+St),t.service.convertToString(t.Y),t.service.convertToString(t.X+St),t.service.convertToString(t.Y+wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y+wt),t.service.convertToString(t.X),t.service.convertToString(t.Top-wt),t.service.convertToString(t.X+St),t.service.convertToString(t.Top-wt),t.service.convertToString(t.X+St),t.service.convertToString(t.Top))}if(m.shapeType.stimulsoft.is(V)){var Pt=t.Height/2.6,Lt=t.Width/5.5;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-Pt),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top-Pt),t.service.convertToString(t.Right-Lt),t.service.convertToString(t.Y),t.service.convertToString(t.X+Lt),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-Pt))}if(m.shapeType.stimulsoft.is(G)){var bt=t.Width/4.75;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+tt,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+bt),t.service.convertToString(t.Top),t.service.convertToString(t.Right-bt),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(Y)){var St=t.Width/7.2,wt=t.Height/4.6;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-wt),t.service.convertToString(t.X+St),t.service.convertToString(t.Top),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Top-wt),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(j)){var St=t.Width/7.2,wt=t.Height/4.6;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right-St),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-wt)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+tt,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+St),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+wt))}t.service.pageStream.writeLine("Q")}else var Ct=l},t.renderRoundedRectanglePrimitive=function(t){var e=t.Component.stimulsoft.as(m);if(null!=e){var r=new c(e.border.color,e.border.size,e.border.style),i=t.Component.stimulsoft.as(J);if(i.style==g.None)return;var n=e.border.style!=g.None&&e.border.style!=g.Solid;n&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack());var o=this.storeBorderSideData(r,t),a=Math.min(t.Width<t.Height?t.Width:t.Height,100*t.Component.page.zoom)*i.round,s=a*(1-t.service.pdfCKT),l=t.X-o,p=t.X+t.Width+o,h=t.X+t.Width/2,w=t.Y-o,u=t.Y+t.Height+o;if(i.leftSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.rightSide?h:p),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(l+a),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(l+s),t.service.convertToString(w),t.service.convertToString(l),t.service.convertToString(w+s),t.service.convertToString(l),t.service.convertToString(w+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(w)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(l),t.service.convertToString(u-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(l),t.service.convertToString(u-s),t.service.convertToString(l+s),t.service.convertToString(u),t.service.convertToString(l+a),t.service.convertToString(u)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.rightSide?h:p),t.service.convertToString(u))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(l),t.service.convertToString(u))),i.rightSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.leftSide?h:l),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(p-a),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(p-s),t.service.convertToString(w),t.service.convertToString(p),t.service.convertToString(w+s),t.service.convertToString(p),t.service.convertToString(w+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(p),t.service.convertToString(w)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(p),t.service.convertToString(u-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(p),t.service.convertToString(u-s),t.service.convertToString(p-s),t.service.convertToString(u),t.service.convertToString(p-a),t.service.convertToString(u)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.leftSide?h:l),t.service.convertToString(u))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(p),t.service.convertToString(u))),!i.topSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(u)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(p),t.service.convertToString(u))),!i.bottomSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(p),t.service.convertToString(w))),r.style==g.Double){s=(a-=2*o)*(1-t.service.pdfCKT);var d=t.X+o,S=t.X+t.Width-o,f=t.Y+o,v=t.Y+t.Height-o;i.leftSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.rightSide?h:p),t.service.convertToString(f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(d+a),t.service.convertToString(f)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(d+s),t.service.convertToString(f),t.service.convertToString(d),t.service.convertToString(f+s),t.service.convertToString(d),t.service.convertToString(f+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(d),t.service.convertToString(w)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(d),t.service.convertToString(v-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(d),t.service.convertToString(v-s),t.service.convertToString(d+s),t.service.convertToString(v),t.service.convertToString(d+a),t.service.convertToString(v)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.rightSide?h:p),t.service.convertToString(v))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(d),t.service.convertToString(u))),i.rightSide&&(i.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i.leftSide?h:l),t.service.convertToString(f)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(S-a),t.service.convertToString(f)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(S-s),t.service.convertToString(f),t.service.convertToString(S),t.service.convertToString(f+s),t.service.convertToString(S),t.service.convertToString(f+a))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(S),t.service.convertToString(w)),i.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(S),t.service.convertToString(v-a)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(S),t.service.convertToString(v-s),t.service.convertToString(S-s),t.service.convertToString(v),t.service.convertToString(S-a),t.service.convertToString(v)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i.leftSide?h:l),t.service.convertToString(v))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(S),t.service.convertToString(u))),!i.topSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(v)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(p),t.service.convertToString(v))),!i.bottomSide||i.leftSide||i.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(f)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(p),t.service.convertToString(f)))}n&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())}},t.renderCheckbox=function(t,e,r){void 0===r&&(r=!0);var s=t.Component.stimulsoft.as(K);if(null!=s){var l=null;switch(e?s.checkStyleForTrue:s.checkStyleForFalse){case Q.Cross:l="62.568 52.024 m 62.018 52.166 60.405 52.537 58.984 52.848 c 55.336 53.645 49.313 58.685 44.741 64.767 c 40.839 69.958 l 45.919 71.092 l \r\n"+"53.272 72.735 59.559 76.81 67.746 85.239 c 74.954 92.661 l 68.543 100.174 l 56.77 113.972 54.196 123.193 59.915 131.088 c 62.809 135.083 71.734 143.458 73.097 143.458 c \r\n"+"73.509 143.458 74.16 141.77 74.546 139.708 c 75.526 134.457 81.002 122.942 85.482 116.708 c 87.557 113.82 89.473 111.458 89.74 111.458 c \r\n"+"90.006 111.458 93.515 114.945 97.537 119.208 c 113.934 136.584 127.211 138.972 135.818 126.095 c 139.973 119.877 140.004 118.024 135.958 117.739 c \r\n"+"130.11 117.329 118.795 109.205 110.443 99.42 c 105.812 93.994 l 110.69 89.679 l 117.241 83.884 129.589 77.786 136.531 76.919 c \r\n"+"139.576 76.539 142.068 75.813 142.068 75.307 c 142.068 72.526 132.802 60.889 129.038 58.942 c 121.077 54.825 112.668 58.23 96.273 72.209 c \r\n"+"91.287 76.46 l 84.2 67.488 l 80.303 62.554 75.379 57.368 73.259 55.965 c 69.353 53.38 64.393 51.552 62.568 52.024 c h";break;case Q.Check:l="60.972 37.503 m 51.173 63.277 43.562 76.623 35.37 82.397 c 30.912 85.54 l 33.664 88.435 l 37.539 92.513 43.698 95.935 48.566 96.713 c \r\n"+"52.426 97.33 53.024 97.093 57.102 93.334 c 59.763 90.882 63.368 85.726 66.269 80.223 c 68.899 75.234 71.18 71.153 71.337 71.153 c \r\n"+"71.493 71.153 73.65 74.19 76.13 77.903 c 96.259 108.044 129.683 141.214 157.565 158.718 c 166.414 164.274 l 168.677 161.643 l \r\n"+"170.941 159.012 l 163.178 152.717 l 139.859 133.81 108.017 94.486 89.043 61.164 c 82.362 49.432 81.87 48.851 73.952 43.345 c \r\n"+"69.45 40.214 64.908 37.04 63.858 36.292 c 62.149 35.074 61.848 35.2 60.972 37.503 c h";break;case Q.CrossRectangle:l="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h \r\n"+"67.337 54.521 m 65.513 54.912 62.41 56.378 60.442 57.778 c 57.123 60.14 48.153 70.186 48.153 71.541 c 48.153 71.87 50.57 72.68 53.525 73.342 c \r\n"+"60.71 74.95 67.272 79.277 75.328 87.718 c 82.003 94.713 l 75.624 102.027 l 64.931 114.288 61.644 123.705 65.472 131.108 c \r\n"+"67.054 134.168 78.562 145.458 80.098 145.458 c 80.556 145.458 81.245 143.77 81.63 141.708 c 82.611 136.457 88.086 124.942 92.567 118.708 c \r\n"+"94.642 115.82 96.558 113.458 96.824 113.458 c 97.091 113.458 100.6 116.945 104.622 121.208 c 121.019 138.584 134.296 140.972 142.903 128.095 c \r\n"+"147.058 121.877 147.089 120.024 143.043 119.739 c 137.213 119.33 124.806 110.39 117.127 101.066 c 113.226 96.33 113.155 96.112 114.876 94.198 c \r\n"+"118.066 90.648 128.579 83.654 133.847 81.578 c 136.682 80.461 141.285 79.244 144.077 78.873 c 146.868 78.503 149.153 77.878 149.153 77.484 c \r\n"+"149.153 75.37 140.777 64.275 137.501 62.048 c 129.107 56.344 120.869 59.278 103.358 74.209 c 98.372 78.46 l 91.285 69.488 l \r\n"+"81.563 57.18 74.76 52.928 67.337 54.521 c h";break;case Q.CheckRectangle:l="19.915 96.5 m 19.915 169 l 91.857 169 l 163.8 169 l 170.357 173.111 l 176.914 177.223 l 178.882 174.861 l 179.963 173.563 180.864 172.217 180.882 171.872 c \r\n"+"180.9 171.526 178.44 169.334 175.415 167 c 169.915 162.757 l 169.915 93.378 l 169.915 24 l 94.915 24 l 19.915 24 l 19.915 96.5 l h \r\n"+"153.915 92.622 m 153.915 141.962 153.786 146.137 152.294 144.899 c 149.513 142.592 136.609 126.998 127.965 115.5 c 117.473 101.544 104.486 81.963 98.451 71 c \r\n"+"93.993 62.903 93.316 62.192 84.16 56 c 78.873 52.425 74.256 49.375 73.9 49.223 c 73.544 49.07 71.988 52.22 70.441 56.223 c \r\n"+"68.895 60.225 65.183 68.635 62.192 74.911 c 57.906 83.903 55.515 87.56 50.914 92.161 c 47.703 95.372 44.364 98 43.495 98 c \r\n"+"40.697 98 41.79 99.66 47.479 104.049 c 53.073 108.365 60.662 111.14 64.28 110.194 c 67.84 109.263 73.689 102.039 78.2 93.002 c \r\n"+"82.663 84.062 l 87.207 90.895 l 95.518 103.394 108.214 118.311 125.807 136.25 c 143.215 154 l 89.565 154 l 35.915 154 l 35.915 96.5 l \r\n"+"35.915 39 l 94.915 39 l 153.915 39 l 153.915 92.622 l h";break;case Q.CrossCircle:l="83.347 26.864 m 61.07 31.95 42.193 47.128 32.202 67.986 c 23.401 86.36 23.68 110.034 32.919 128.958 c 41.882 147.315 60.868 162.86 80.847 168.201 c \r\n"+"91.083 170.936 112.112 170.628 121.812 167.6 c 147.999 159.425 167.881 138.673 173.432 113.721 c 175.869 102.768 175 85.662 171.452 74.743 c \r\n"+"164.795 54.256 145.804 35.792 124.126 28.729 c 117.735 26.647 113.94 26.133 102.847 25.845 c 93.814 25.61 87.363 25.947 83.347 26.864 c h \r\n"+"112.414 41.542 m 129.545 44.672 146.131 57.503 153.827 73.579 c 168.725 104.698 152.719 141.239 119.425 152.119 c 112.712 154.313 109.49 154.763 100.347 154.781 c \r\n"+"90.993 154.8 88.185 154.404 81.579 152.131 c 64.423 146.231 51.91 134.6 45.14 118.265 c 42.988 113.072 42.446 109.911 42.069 100.368 c \r\n"+"41.551 87.229 42.811 81.166 48.181 70.958 c 52.288 63.15 63.613 51.864 71.549 47.67 c 83.611 41.295 98.688 39.034 112.414 41.542 c h \r\n"+"69.097 66.583 m 66.21 69.342 63.847 71.942 63.847 72.361 c 63.847 72.78 69.506 78.671 76.422 85.451 c 88.996 97.78 l 76.198 110.607 l 63.4 123.434 l \r\n"+"68.336 128.446 l 71.051 131.202 73.641 133.458 74.091 133.458 c 74.542 133.458 80.666 127.846 87.7 120.988 c 100.49 108.517 l 104.919 113.071 l \r\n"+"107.354 115.575 113.31 121.259 118.154 125.701 c 126.961 133.777 l 132.308 128.496 l 137.656 123.215 l 124.694 110.658 l 111.733 98.1 l 124.866 84.939 l \r\n"+"137.999 71.779 l 132.815 67.118 l 129.964 64.555 127.11 62.458 126.474 62.458 c 125.837 62.458 119.93 67.858 113.347 74.458 c \r\n"+"106.765 81.058 100.96 86.458 100.449 86.458 c 99.938 86.458 93.856 80.857 86.933 74.013 c 74.347 61.567 l 69.097 66.583 l h";break;case Q.DotCircle:l="81.653 29.406 m 59.375 34.493 40.499 49.67 30.507 70.529 c 21.706 88.903 21.985 112.576 31.224 131.5 c 40.187 149.857 59.173 165.402 79.153 170.743 c \r\n"+"89.388 173.479 110.417 173.17 120.117 170.142 c 146.304 161.968 166.186 141.215 171.737 116.263 c 174.174 105.311 173.305 88.205 169.757 77.285 c \r\n"+"163.1 56.798 144.109 38.334 122.431 31.271 c 116.04 29.189 112.245 28.675 101.153 28.387 c 92.119 28.152 85.668 28.49 81.653 29.406 c h \r\n"+"111.653 44.504 m 132.341 48.848 149.671 64.959 155.751 85.5 c 158.113 93.481 158.113 107.519 155.751 115.5 c 150.089 134.629 134.635 149.703 114.653 155.588 c \r\n"+"106.553 157.973 90.741 157.974 82.695 155.589 c 62.46 149.592 46.687 133.961 41.605 114.869 c 39.656 107.547 39.74 91.753 41.764 84.932 c \r\n"+"50.494 55.507 80.736 38.013 111.653 44.504 c h \r\n"+"90.005 77.33 m 76.55 82.362 69.825 98.176 75.898 110.5 c 78.035 114.836 83.045 119.856 87.653 122.277 c 93.231 125.208 104.066 125.204 109.705 122.27 c \r\n"+"127.735 112.887 128.781 89.485 111.62 79.428 c 106.047 76.162 95.789 75.166 90.005 77.33 c h";break;case Q.DotRectangle:l="23.847 98.805 m 23.847 171.305 l 98.347 171.305 l 172.847 171.305 l 172.847 98.805 l 172.847 26.305 l 98.347 26.305 l 23.847 26.305 l 23.847 98.805 l h \r\n"+"157.847 98.813 m 157.847 156.321 l 98.597 156.063 l 39.347 155.805 l 39.089 98.555 l 38.831 41.305 l 98.339 41.305 l 157.847 41.305 l 157.847 98.813 l h \r\n"+"63.527 64.959 m 63.153 65.333 62.847 80.638 62.847 98.972 c 62.847 132.305 l 98.361 132.305 l 133.874 132.305 l 133.611 98.555 l 133.347 64.805 l \r\n"+"98.777 64.542 l 79.763 64.398 63.901 64.585 63.527 64.959 c h";break;case Q.NoneCircle:l="83.5 29.406 m 61.222 34.493 42.346 49.67 32.355 70.529 c 23.554 88.903 23.832 112.576 33.071 131.5 c 42.034 149.857 61.02 165.402 81 170.743 c \r\n"+"91.235 173.479 112.265 173.17 121.965 170.142 c 148.151 161.968 168.034 141.215 173.585 116.263 c 176.022 105.311 175.152 88.205 171.605 77.285 c \r\n"+"164.948 56.798 145.957 38.334 124.278 31.271 c 117.887 29.189 114.092 28.675 103 28.387 c 93.966 28.152 87.515 28.49 83.5 29.406 c h \r\n"+"113.5 44.504 m 134.189 48.848 151.519 64.959 157.598 85.5 c 159.961 93.481 159.961 107.519 157.598 115.5 c 151.937 134.629 136.483 149.703 116.5 155.588 c \r\n"+"108.401 157.973 92.589 157.974 84.543 155.589 c 64.308 149.592 48.534 133.961 43.453 114.869 c 41.504 107.547 41.588 91.753 43.612 84.932 c \r\n"+"52.342 55.507 82.583 38.013 113.5 44.504 c h";break;case Q.NoneRectangle:l="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h";break}t.service.pageStream.writeLine("q"),t.service.pushColorToStack();var m=i.toColor(s.textBrush);if(0!=m.a&&t.service.setNonStrokeColor(m),(s.textBrush.stimulsoft.is(n)||s.textBrush.stimulsoft.is(o))&&(r&&t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,s.textBrush),t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent)),s.textBrush.stimulsoft.is(a)){var c=s.textBrush.stimulsoft.as(a);t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(c)+1)}t.service.setStrokeColor(s.contourColor),t.service.pageStream.writeLine1("{0} w",t.service.convertToString(s.size)),t.service.pageStream.writeLine1("1 0 0 1 {0} {1} cm",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2));var p,g=Math.min(t.Width,t.Height)/200;t.service.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",t.service.convertToString(g)),t.service.pageStream.writeLine("1 0 0 1 -98 -98 cm"),t.service.pageStream.writeLine(l),t.service.pageStream.writeLine("B"),t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()}},t.getCheckBoxValue=function(t){var e=null;if(null!=t&&null!=t.checkedValue){e=!1;var r=t.checkedValue.toString().trim().toLowerCase(),i=t.values.split("/"),n;if(1==i.length&&(i=t.values.split(";")),1==i.length&&(i=t.values.split(",")),null!=i&&i.length>0)e=r==i[0].trim().toLowerCase()}return e},t}();e.StiPdfRenderPrimitives=$}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.Base.Drawing.StiPenStyle,i=t.Base.Drawing.StiAdvancedBorder,n=t.System.StiArray,o=t.System.StiString,a=t.Report.Components.IStiTextBrush,s=t.Report.Components.IStiText,l=t.Report.Components.IStiTextHorAlignment,m=t.Report.Components.IStiVertAlignment,c=t.Report.Components.IStiTextOptions,p=t.Report.Components.IStiFont,g=t.Report.Components.StiText,h=t.Base.Drawing.StiTextHorAlignment,w=t.Base.Drawing.StiVertAlignment,u=t.System.Drawing.Color,d=t.Base.Drawing.StiBrush,S=t.Base.Drawing.StiGradientBrush,f=t.Base.Drawing.StiGlareBrush,v=t.Base.Drawing.StiHatchBrush,E=t.System.Text.StringBuilder,b=t.System.Char,y=t.System.Drawing.Drawing2D.Matrix,x=function(){function x(){}return x.renderText=function(x){var A=x.Component.as(a),T=x.Component.as(s),P=x.Component.as(c),L=x.Component.as(l),C=x.Component.as(m),F=x.Component.as(g),B=null!=P&&P.textOptions.wordWrap,k=null!=L&&L.horAlignment==h.Width,R=x.service.haveAnnots&&F.editable,I=null!=P&&null!=P.textOptions&&P.textOptions.rightToLeft,D=null,N=0,O=0,H=F.textQuality==t.Report.Components.StiTextQuality.Wysiwyg;if(k&&(B=!0),null!=T){var M=F.margins,W=this.hiToTwips*M.left,U=this.hiToTwips*M.right,X=this.hiToTwips*M.top,z=this.hiToTwips*M.bottom,V=x.X+W,G=x.Y+z,Y=x.Width-W-U,j=x.Height-X-z,_=0,q=0,K=0,Q=0;if(F.border.style!=r.None){var J=F.border.getSizeOffset();F.border.isLeftBorderSidePresent&&(_=J),F.border.isRightBorderSidePresent&&(q=J),F.border.isTopBorderSidePresent&&(K=J),F.border.isBottomBorderSidePresent&&(Q=J)}var Z=F.border.stimulsoft.as(i);null!=Z&&(_=Z.leftSide.getSizeOffset(),q=Z.rightSide.getSizeOffset(),K=Z.topSide.getSizeOffset(),Q=Z.bottomSide.getSizeOffset());var $=.94;V+=this.hiToTwips*$*_,G+=this.hiToTwips*$*Q,Y-=this.hiToTwips*$*(_+q),j-=this.hiToTwips*$*(K+Q),R||(x.service.pageStream.writeLine("q"),x.service.pushColorToStack(),x.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",x.service.convertToString(x.X),x.service.convertToString(x.Y),x.service.convertToString(x.Width),x.service.convertToString(x.Height)));var tt=u.transparent;if(null!=A){if(tt=d.toColor(A.textBrush),x.service.setNonStrokeColor(tt),x.service.storeShadingData2(x.X,x.Y,x.Width,x.Height,A.textBrush),(A.textBrush.is(S)||A.textBrush.is(f))&&x.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+x.service.shadingCurrent),A.textBrush.is(v)){var et=A.textBrush.as(v);x.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",x.service.getHatchNumber(et)+1)}var rt;if(R)(rt=x.service.annotsArray[x.service.annotsCurrent]).FontColor=tt}var it=1,nt=x.Component.as(p);null!=nt&&(it=nt.font.sizeInPoints);var ot=1,at=it*this.fontCorrectValue*x.service.pdfFont.tmASC/1e3*ot,st=it*this.fontCorrectValue*x.service.pdfFont.tmDESC/1e3*-1*ot,lt=it*this.fontCorrectValue*x.service.pdfFont.tmExternal/1e3*ot,mt=it*this.fontCorrectValue*x.service.pdfFont.UnderscoreSize/1e3*ot,ct=it*this.fontCorrectValue*x.service.pdfFont.UnderscorePosition/1e3*ot,pt=it*this.fontCorrectValue*x.service.pdfFont.StrikeoutSize/1e3*ot,gt=it*this.fontCorrectValue*x.service.pdfFont.StrikeoutPosition/1e3*ot,ht=(at-st+lt)*F.lineSpacing,wt=at,ut=st,dt=!1;null!=P&&(dt=(O=P.textOptions.angle)>45&&O<135||O>225&&O<315),R&&(V-=x.X,G-=x.Y);var St=.85,ft=0;if(F.textQuality==t.Report.Components.StiTextQuality.Standard){var vt=.35-.04*(14-it),Et=(ft=137.61)*(it*this.fontCorrectValue)/1e3;dt?(G+=vt+Et,j-=2*(vt+Et)):(V+=vt+Et,Y-=2*(vt+Et))}if(F.textQuality==t.Report.Components.StiTextQuality.Typographic){var vt=.05+.009*(8-it);dt?(G+=vt,j-=2*vt):(V+=vt,Y-=2*vt)}var bt=T.text,rt;if(null==bt&&(bt=""),bt=x.service.stringReplace(bt,"\r",""),bt=x.service.stringReplace(bt,"",""),R&&(D=x.service.stringReplace(T.text,"\n","")),Y>0&&bt.length>0){var yt=V,xt=G,At=Y,Tt=j;if(null!=P&&0!=(O=P.textOptions.angle)){if(dt){var Pt=Y;Y=j,j=Pt}V=-Y/2,G=-j/2}var Lt=e.StiExportUtils.splitString(bt,!1);if(B)for(var Ct=0;Ct<Lt.length;Ct++){var Ft;if((Ft=Lt[Ct]).length<2)continue;var Bt=new E,kt=0,Rt;while(kt<Ft.length)if(b.isWhitespace(Ft,kt))Bt.append(Ft.charAt(kt)),kt++;else{var It=new E;while(kt<Ft.length&&!b.isWhitespace(Ft,kt))It.append(Ft.charAt(kt)),kt++;var Dt=x.service.bidi.convert(It,!1);Bt.append(Dt);var Nt=It.length-Dt.length;Nt>0&&Bt.append(o.repeat(String.fromCharCode(0),Nt))}for(var Ot=[],Ht=Bt.toString(),Mt=0;Mt<Ft.length;Mt++)Ot[Mt]=x.service.pdfFont.UnicodeMap[Ht.charCodeAt(Mt)];for(var Wt=n.create(Number,Ft.length),Ut=n.create(Number,Ft.length),Xt=0,zt=0,Vt=0;Vt<Ot.length;Vt++)Ot[Vt]>=32&&(zt+=x.service.pdfFont.Widths[Ot[Vt]-32]),9==Ot[Vt]&&(zt+=this.getTabsSize(P,it,zt+ft)+ft),Wt[Vt]=Math.trunc(zt),this.isWordWrapSymbol(Ht,Vt)&&Vt>0&&Xt++,Ut[Vt]=Xt;if(zt*(it*this.fontCorrectValue)/1e3>Y){var Vt=Ft.length-1,Gt=Math.trunc(1e3*Y/(it*this.fontCorrectValue));while(Wt[Vt]>Gt&&Vt>0)Vt--;var Yt=Vt;if(Ut[Vt]>0)if(Ut[Vt]!=Ut[Vt+1]){Yt=Vt++;while(b.isWhitespace(Ht,Vt)&&"\t"!=Ht.charAt(Vt))Vt++}else{while(!this.isWordWrapSymbol(Ht,Vt))Vt--;Yt=Vt-1;while(b.isWhitespace(Ht,Yt)&&Yt>0)Yt--;while(b.isWhitespace(Ht,Vt)&&"\t"!=Ht.charAt(Vt))Vt++}else Vt++;Lt[Ct]=k?Ft.substr(0,Yt+1)+String.fromCharCode(7):Ft.substr(0,Yt+1),Lt.stimulsoft.insert(Ct+1,Ft.substr(Vt,Ft.length-Vt).stimulsoft.trimStart(" "))}}N=Lt.length;for(var jt=-1,Ct=0;Ct<Lt.length;Ct++){for(var Ft=Lt[Ct],_t=x.service.bidi.convert(new E(Ft),I).toString(),qt="",Vt=0;Vt<_t.length;Vt++)qt+=String.fromCharCode(x.service.pdfFont.UnicodeMap[_t.charCodeAt(Vt)]);Lt[Ct]=qt}if(null!=C){var Kt=ht,Qt=N*Kt,Jt=C.vertAlignment;0!=O&&90!=O&&180!=O&&270!=O&&(Jt=w.Center),Jt==w.Top&&(G+=j-Qt+(Kt-wt)),Jt==w.Center&&(F.textQuality==t.Report.Components.StiTextQuality.Typographic?G+=(j-Qt)/2-ut:G+=(j-Qt)/2+1.2*(Kt-wt)),Jt==w.Bottom&&(F.textQuality==t.Report.Components.StiTextQuality.Typographic?G+=-ut:G+=1.4*(Kt-wt))}x.service.pageStream.writeLine("BT");var Zt=0,$t=0,te=n.create2(Number,Lt.length,3),ee=null;if(0!=O){var re=O*Math.PI/180;ee=new y(Math.cos(re),Math.sin(re),-Math.sin(re),Math.cos(re),yt+At/2,xt+Tt/2),x.service.pdfFont.NeedSyntItalic&&null!=nt&&nt.font.italic||x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",x.service.convertToString(ee.elements[0]),x.service.convertToString(ee.elements[1]),x.service.convertToString(ee.elements[2]),x.service.convertToString(ee.elements[3]),x.service.convertToString(ee.elements[4]),x.service.convertToString(ee.elements[5]))}x.service.pdfFont.NeedSyntBold&&null!=nt&&nt.font.bold&&(x.service.pageStream.writeLine1("{0} w 2 Tr",x.service.convertToString(this.boldFontStrokeWidthValue*it,3)),x.service.setStrokeColor(tt));for(var Ct=0;Ct<N;Ct++){for(var Ft=Lt[Ct],ie=n.create(Number,Ft.length),ne=0,zt=0,oe=0,ae=1e3*Y/(it*this.fontCorrectValue),se=x.service.pdfFont.Widths[x.service.pdfFont.UnicodeMap["…".charCodeAt(0)]],le=0,Vt=0;Vt<Ft.length;Vt++){var me=Ft.charCodeAt(Vt);if(me>=32&&(zt+=x.service.pdfFont.Widths[me-32]),9==me){var ce=this.getTabsSize(P,it,zt);zt+=ce,ie[ne++]=ce}zt+se<ae&&(oe=zt,le=Vt)}if(zt=zt*(it*this.fontCorrectValue)/1e3,-1!=jt&&(Ct==N-1&&jt<Lt.length||zt>Y)&&(Ft=Ft.substr(0,le)+String.fromCharCode(x.service.pdfFont.UnicodeMap["…".charCodeAt(0)]),zt=(oe+se)*(it*this.fontCorrectValue)/1e3),x.service.useUnicodeMode){for(var Bt=new E,Vt=0;Vt<Ft.length;Vt++){Vt%121==120&&Bt.appendLine("\r");var pe=Ft.charCodeAt(Vt);if(32==pe||9==pe||7==pe)Bt.append(Ft.charAt(Vt));else{var ge=x.service.pdfFont.GlyphList[pe];65535==ge&&(ge=0),Bt.appendFormat("{0:X4}",ge)}}Ft=Bt.toString()}else Ft=e.StiPdfExportService.convertToEscapeSequence(Ft);var he=V,we=G+ht*(N-Ct-1),ue=!1,de=!1;if(null!=L){var Se=L.horAlignment;if(k&&(Ft.length>0&&7===Ft.charCodeAt(Ft.length-1)?Ft=Ft.substr(0,Ft.length-1):Se=h.Left),null!=P&&null!=P.textOptions&&P.textOptions.rightToLeft&&(Se==h.Left?Se=h.Right:Se==h.Right&&(Se=h.Left)),Se==h.Center&&(he+=(Y-zt)/2),Se==h.Right&&(he+=Y-zt),Se==h.Width){for(var fe=0,ve=0;ve<Ft.length;ve++)32===Ft.charCodeAt(ve)&&fe++;if(fe>0&&(Ct!=Lt.length-1||H&&zt>Y)){de=!0;var Ee=(Y-zt)/fe*1e3/(it*this.fontCorrectValue);if(Ee>0||H){ue=!0,(Ee+=x.service.pdfFont.Widths[0])<.5*x.service.pdfFont.Widths[0]&&(Ee=.5*x.service.pdfFont.Widths[0]);for(var be=x.service.useUnicodeMode?"<":"(",ye=0;ye<Ft.length;ye++)32===Ft.charCodeAt(ye)?x.service.useUnicodeMode?be+=">-"+x.service.convertToString(Ee)+"<":be+=")-"+x.service.convertToString(Ee)+"(":be+=Ft[ye];Ft=be+=x.service.useUnicodeMode?">":")"}}}}if(ne>0){var xe=0,Ae="";0==de&&(Ae+=x.service.useUnicodeMode?"<":"(");for(var ye=0;ye<Ft.length;ye++)if("\t"==Ft[ye]){var Te=ie[xe++];x.service.useUnicodeMode?Ae+=">-"+x.service.convertToString(Te)+"<":Ae+=")-"+x.service.convertToString(Te)+"("}else Ae+=Ft[ye];0==de&&(Ae+=x.service.useUnicodeMode?">":")"),Ft=Ae}x.service.useUnicodeMode&&(Ft=x.service.stringReplace(Ft," ",x.service.pdfFont.GlyphList[32].toString(16).stimulsoft.padLeft(4,"0")).stimulsoft.replaceAll("a","0000"));for(var Pe=null!=x.service.pdfFont.ChildFontsMap,Le=0,Ot=n.create(Number,Ft.length),Ce=new Array,Mt=0;Mt<Ft.length;Mt++){var Fe=Ft.charCodeAt(Mt);Ot[Mt]=Fe;var Be=!1;if(13==Fe&&(Ce.push(Mt),Be=!0),Pe){var ke=x.service.pdfFont.UnicodeMapBack[Fe];92==Fe&&(ke=x.service.pdfFont.UnicodeMapBack[Ft.charCodeAt(Mt+1)]);var Re=x.service.pdfFont.ChildFontsMap[ke];ke<64&&(Mt>0?Re=Le:Ft.length>1&&(Re=x.service.pdfFont.ChildFontsMap[x.service.pdfFont.UnicodeMapBack[Ft.charCodeAt(1)]])),92!=Fe&&(Ot[Mt]=x.service.pdfFont.fonts[Re].UnicodeMap[ke]),Re==Le||Be||0==Mt||Ce.push(Mt),Le=Re}}if(Ce.push(Ft.length),te[Ct][0]=he,te[Ct][1]=we,te[Ct][2]=zt,x.service.pdfFont.NeedSyntItalic&&null!=nt&&nt.font.italic){var Ie=new y(1,0,this.italicAngleTanValue,1,he,we);null!=ee&&Ie.multiply(Ie),x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",x.service.convertToString(Ie.elements[0]),x.service.convertToString(Ie.elements[1]),x.service.convertToString(Ie.elements[2]),x.service.convertToString(Ie.elements[3]),x.service.convertToString(Ie.elements[4]),x.service.convertToString(Ie.elements[5]))}else x.service.pageStream.writeLine1("{0} {1} Td",x.service.convertToString(he-Zt),x.service.convertToString(we-$t)),Zt=he,$t=we;for(var De=0,Ne=0;Ne<Ce.length;Ne++){if(Pe&&Ft.length>0){var Oe=Ft.charCodeAt(De)<64&&Ft.length>De+1?De+1:De,Re=x.service.pdfFont.ChildFontsMap[x.service.pdfFont.UnicodeMapBack[Ft.charCodeAt(Oe)]];x.service.pageStream.writeLine1("/F{0} {1} Tf",Re,x.service.convertToString(it*this.fontCorrectValue,this.precision_digits_font))}var He=Ce[Ne],Me=He-De;Me>0&&(ue||ne>0?(x.service.pageStream.writeString("["),Ne>0&&x.service.pageStream.writeString(x.service.useUnicodeMode?"<":"("),x.service.pageStream.write(Ot,De,Me),Ne<Ce.length-1&&x.service.pageStream.writeString(x.service.useUnicodeMode?">":")"),x.service.pageStream.writeLine("] TJ")):(x.service.pageStream.writeString(x.service.useUnicodeMode?"<":"("),x.service.pageStream.write(Ot,De,Me),x.service.pageStream.writeLine1("{0} Tj",x.service.useUnicodeMode?">":")"))),De=He,He<Ot.length-1&&13==Ot[He]&&De++}}if(x.service.pdfFont.NeedSyntBold&&null!=nt&&nt.font.bold&&x.service.pageStream.writeLine("0 Tr"),x.service.pageStream.writeLine("ET"),null!=nt&&nt.font.underline){x.service.pageStream.writeLine("q"),x.service.pushColorToStack();var We=.07*it,Ue=.1*-it;if(0!=x.service.pdfFont.UnderscoreSize&&(We=mt,Ue=ct),We<.1&&(We=.1),x.service.pageStream.writeLine1("{0} w",x.service.convertToString(We)),0!=O){var re=O*Math.PI/180;x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",x.service.convertToString(Math.cos(re)),x.service.convertToString(Math.sin(re)),x.service.convertToString(-Math.sin(re)),x.service.convertToString(Math.cos(re)),x.service.convertToString(yt+At/2),x.service.convertToString(xt+Tt/2))}null!=A&&x.service.setStrokeColor(tt);for(var Mt=0;Mt<Lt.length;Mt++)0!=te[Mt][2]&&(x.service.pageStream.writeLine1("{0} {1} m",x.service.convertToString(te[Mt][0]),x.service.convertToString(te[Mt][1]+Ue)),x.service.pageStream.writeLine1("{0} {1} l S",x.service.convertToString(te[Mt][0]+te[Mt][2]),x.service.convertToString(te[Mt][1]+Ue)));x.service.pageStream.writeLine("Q"),x.service.popColorFromStack()}if(null!=nt&&nt.font.strikeout){x.service.pageStream.writeLine("q"),x.service.pushColorToStack();var Xe=.045*it,ze=.25*it;if(0!=x.service.pdfFont.StrikeoutSize&&(Xe=pt,ze=gt),Xe<.1&&(Xe=.1),x.service.pageStream.writeLine1("{0} w",x.service.convertToString(Xe)),0!=O){var re=O*Math.PI/180;x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",x.service.convertToString(Math.cos(re)),x.service.convertToString(Math.sin(re)),x.service.convertToString(-Math.sin(re)),x.service.convertToString(Math.cos(re)),x.service.convertToString(yt+At/2),x.service.convertToString(xt+Tt/2))}null!=A&&x.service.setStrokeColor(tt);for(var Mt=0;Mt<Lt.length;Mt++)0!=te[Mt][2]&&(x.service.pageStream.writeLine1("{0} {1} m",x.service.convertToString(te[Mt][0]),x.service.convertToString(te[Mt][1]+ze)),x.service.pageStream.writeLine1("{0} {1} l S",x.service.convertToString(te[Mt][0]+te[Mt][2]),x.service.convertToString(te[Mt][1]+ze)));x.service.pageStream.writeLine("Q"),x.service.popColorFromStack()}}if(R)if((rt=x.service.annotsArray[x.service.annotsCurrent]).Multiline=B,rt.X=x.X,rt.Y=x.Y,rt.Width=x.Width,rt.Height=x.Height,rt.Text=D,rt.Component=x.Component,rt.Alignment=h.Left,null!=L){var Se=L.horAlignment;null!=P&&null!=P.textOptions&&P.textOptions.rightToLeft&&(Se==h.Left?Se=h.Right:Se==h.Right&&(Se=h.Left)),rt.Alignment=Se}R||(x.service.pageStream.writeLine("Q"),x.service.popColorFromStack())}},x.isWordWrapSymbol=function(t,e){var r=t.charCodeAt(e),i=t.charAt(e);if(r>=12288&&r<=55215||b.isWhitespace(t,e)&&160!=r||"("==i||"{"==i)return!0;if(e>0){var n=t.charAt(e-1);if("!"==n||"%"==n||")"==n||"}"==n||"-"==n||"?"==n)return!0}return!1},x.getTabsSize=function(t,e,r){if(null!=t&&null!=t.textOptions){var i=r,n=750/e,o=n*t.textOptions.distanceBetweenTabs,a=n*t.textOptions.firstTabOffset+o;if(r<a)i=a;else if(t.textOptions.distanceBetweenTabs>0){var s=Math.trunc((r-a)/o);i=a+ ++s*o}return i-r}return 0},x.renderTextFont=function(t){var e=t.Component.as(p);if(null!=e){var r=t.service.pdfFont.getFontNumber(e.font),i=e.font.sizeInPoints*this.fontCorrectValue;if(t.service.pageStream.writeLine1("/F{0} {1} Tf",r,t.service.convertToString(i,this.precision_digits_font)),t.service.pdfFont.currentFont=r,t.service.haveAnnots&&t.Component.as(g).editable){var n=t.service.annotsArray[t.service.annotsCurrent];n.FontNumber=r,n.FontSize=i}}},x.hiToTwips=.72,x.precision_digits_font=3,x.fontCorrectValue=.955,x.boldFontStrokeWidthValue=.031,x.italicAngleTanValue=.325,x}();e.StiPdfRenderText=x}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"standardFontCharsNames",{get:function(){if(null==this._standardFontCharsNames){var t=["0020space","0021exclam","0022quotedbl","0023numbersign","0024dollar","0025percent","0026ampersand","0027quotesingle","0028parenleft","0029parenright","002Aasterisk","002Bplus","002Ccomma","002Dhyphen","002Eperiod","002Fslash","0030zero","0031one","0032two","0033three","0034four","0035five","0036six","0037seven","0038eight","0039nine","003Acolon","003Bsemicolon","003Cless","003Dequal","003Egreater","003Fquestion","0040at","0041A","0042B","0043C","0044D","0045E","0046F","0047G","0048H","0049I","004AJ","004BK","004CL","004DM","004EN","004FO","0050P","0051Q","0052R","0053S","0054T","0055U","0056V","0057W","0058X","0059Y","005AZ","005Bbracketleft","005Cbackslash","005Dbracketright","005Easciicircum","005Funderscore","0060grave","0061a","0062b","0063c","0064d","0065e","0066f","0067g","0068h","0069i","006Aj","006Bk","006Cl","006Dm","006En","006Fo","0070p","0071q","0072r","0073s","0074t","0075u","0076v","0077w","0078x","0079y","007Az","007Bbraceleft","007Cbar","007Dbraceright","007Easciitilde","007FcontrolDEL","00A0nbspace","00A1exclamdown","00A2cent","00A3sterling","00A4currency","00A5yen","00A6brokenbar","00A7section","00A8dieresis","00A9copyright","00AAordfeminine","00ABguillemotleft","00AClogicalnot","00ADsofthyphen","00AEregistered","00AFmacron","00B0degree","00B1plusminus","00B2twosuperior","00B3threesuperior","00B4acute","00B5mu","00B6paragraph","00B7periodcentered","00B8cedilla","00B9onesuperior","00BAordmasculine","00BBguillemotright","00BConequarter","00BDonehalf","00BEthreequarters","00BFquestiondown","00C0Agrave","00C1Aacute","00C2Acircumflex","00C3Atilde","00C4Adieresis","00C5Aring","00C6AE","00C7Ccedilla","00C8Egrave","00C9Eacute","00CAEcircumflex","00CBEdieresis","00CCIgrave","00CDIacute","00CEIcircumflex","00CFIdieresis","00D0Eth","00D1Ntilde","00D2Ograve","00D3Oacute","00D4Ocircumflex","00D5Otilde","00D6Odieresis","00D7multiply","00D8Oslash","00D9Ugrave","00DAUacute","00DBUcircumflex","00DCUdieresis","00DDYacute","00DEThorn","00DFgermandbls","00E0agrave","00E1aacute","00E2acircumflex","00E3atilde","00E4adieresis","00E5aring","00E6ae","00E7ccedilla","00E8egrave","00E9eacute","00EAecircumflex","00EBedieresis","00ECigrave","00EDiacute","00EEicircumflex","00EFidieresis","00F0eth","00F1ntilde","00F2ograve","00F3oacute","00F4ocircumflex","00F5otilde","00F6odieresis","00F7divide","00F8oslash","00F9ugrave","00FAuacute","00FBucircumflex","00FCudieresis","00FDyacute","00FEthorn","00FFydieresis","0100Amacron","0101amacron","0102Abreve","0103abreve","0104Aogonek","0105aogonek","0106Cacute","0107cacute","0108Ccircumflex","0109ccircumflex","010ACdotaccent","010Bcdotaccent","010CCcaron","010Dccaron","010EDcaron","010Fdcaron","0110Dcroat","0111dcroat","0112Emacron","0113emacron","0114Ebreve","0115ebreve","0116Edotaccent","0117edotaccent","0118Eogonek","0119eogonek","011AEcaron","011Becaron","011CGcircumflex","011Dgcircumflex","011EGbreve","011Fgbreve","0120Gdotaccent","0121gdotaccent","0122Gcommaaccent","0123gcommaaccent","0124Hcircumflex","0125hcircumflex","0126Hbar","0127hbar","0128Itilde","0129itilde","012AImacron","012Bimacron","012CIbreve","012Dibreve","012EIogonek","012Fiogonek","0130Idotaccent","0131dotlessi","0132IJ","0133ij","0134Jcircumflex","0135jcircumflex","0136Kcommaaccent","0137kcommaaccent","0138kgreenlandic","0139Lacute","013Alacute","013BLcommaaccent","013Clcommaaccent","013DLcaron","013Elcaron","013FLdot","0140ldot","0141Lslash","0142lslash","0143Nacute","0144nacute","0145Ncommaaccent","0146ncommaaccent","0147Ncaron","0148ncaron","0149napostrophe","014AEng","014Beng","014COmacron","014Domacron","014EObreve","014Fobreve","0150Ohungarumlaut","0151ohungarumlaut","0152OE","0153oe","0154Racute","0155racute","0156Rcommaaccent","0157rcommaaccent","0158Rcaron","0159rcaron","015ASacute","015Bsacute","015CScircumflex","015Dscircumflex","015EScedilla","015Fscedilla","0160Scaron","0161scaron","0162Tcommaaccent","0163tcommaaccent","0164Tcaron","0165tcaron","0166Tbar","0167tbar","0168Utilde","0169utilde","016AUmacron","016Bumacron","016CUbreve","016Dubreve","016EUring","016Furing","0170Uhungarumlaut","0171uhungarumlaut","0172Uogonek","0173uogonek","0174Wcircumflex","0175wcircumflex","0176Ycircumflex","0177ycircumflex","0178Ydieresis","0179Zacute","017Azacute","017BZdotaccent","017Czdotaccent","017DZcaron","017Ezcaron","017Flongs","0180bstroke","0181Bhook","0182Btopbar","0183btopbar","0184Tonesix","0185tonesix","0186Oopen","0187Chook","0188chook","0189Dafrican","018ADhook","018BDtopbar","018Cdtopbar","018Ddeltaturned","018EEreversed","018FSchwa","0190Eopen","0191Fhook","0192florin","0193Ghook","0194Gammaafrican","0195hv","0196Iotaafrican","0197Istroke","0198Khook","0199khook","019Albar","019Blambdastroke","019CMturned","019DNhookleft","019Enlegrightlong","019FOcenteredtilde","01A0Ohorn","01A1ohorn","01A2Oi","01A3oi","01A4Phook","01A5phook","01A6yr","01A7Tonetwo","01A8tonetwo","01A9Esh","01AAeshreversedloop","01ABtpalatalhook","01ACThook","01ADthook","01AETretroflexhook","01AFUhorn","01B0uhorn","01B1Upsilonafrican","01B2Vhook","01B3Yhook","01B4yhook","01B5Zstroke","01B6zstroke","01B7Ezh","01B8Ezhreversed","01B9ezhreversed","01BAezhtail","01BBtwostroke","01BCTonefive","01BDtonefive","01BEglottalinvertedstroke","01BFwynn","01C0clickdental","01C1clicklateral","01C2clickalveolar","01C3clickretroflex","01C4DZcaron","01C5Dzcaron","01C6dzcaron","01C7LJ","01C8Lj","01C9lj","01CANJ","01CBNj","01CCnj","01CDAcaron","01CEacaron","01CFIcaron","01D0icaron","01D1Ocaron","01D2ocaron","01D3Ucaron","01D4ucaron","01F0jcaron","01F1DZ","01F2Dz","01F3dz","01F4Gacute","01F5gacute","01FAAringacute","01FBaringacute","01FCAEacute","01FDaeacute","01FEOslashacute","01FFoslashacute","0254oopen","0255ccurl","0256dtail","0257dhook","0258ereversed","0259schwa","025Aschwahook","025Beopen","025Fjdotlessstroke","0260ghook","0261gscript","0264ramshorn","0265hturned","0266hhook","0267henghook","0268istroke","0269iotalatin","026Clbelt","026Elezh","026Fmturned","0271mhook","0272nhookleft","0275obarred","0278philatin","0279rturned","027Brhookturned","027Crlongleg","027Drhook","027Erfishhook","0282shook","0283esh","0286eshcurl","0287tturned","0289ubar","028Bvhook","028Cvturned","028Dwturned","028Eyturned","0290zretroflexhook","0291zcurl","0292ezh","0293ezhcurl","0294glottalstop","02A3dzaltone","02A4dezh","02A5dzcurl","02A6ts","02A7tesh","02A8tccurl","02D6plusmod","02D7minusmod","02D8breve","02D9dotaccent","02DAring","02DBogonek","02DCtilde","0391Alpha","0392Beta","0393Gamma","0394Deltagreek","0395Epsilon","0396Zeta","0397Eta","0398Theta","0399Iota","039AKappa","039BLambda","039CMu","039DNu","039EXi","039FOmicron","03A0Pi","03A1Rho","03A3Sigma","03A4Tau","03A5Upsilon","03A6Phi","03A7Chi","03A8Psi","03A9Omegagreek","03AAIotadieresis","03ABUpsilondieresis","03ACalphatonos","03ADepsilontonos","03AEetatonos","03AFiotatonos","03B0upsilondieresistonos","03B1alpha","03B2beta","03B3gamma","03B4delta","03B5epsilon","03B6zeta","03B7eta","03B8theta","03B9iota","03BAkappa","03BBlambda","03BCmu","03BDnu","03BExi","03BFomicron","03C0pi","03C1rho","03C2sigma1","03C3sigma","03C4tau","03C5upsilon","03C6phi","03C7chi","03C8psi","03C9omega","03CAiotadieresis","03CBupsilondieresis","03CComicrontonos","03CDupsilontonos","03CEomegatonos","03D0betasymbolgreek","03D1theta1","03D2Upsilon1","03D5phi1","03D6omega1","03DAStigmagreek","03DCDigammagreek","03DEKoppagreek","03E0Sampigreek","03E2Sheicoptic","03E3sheicoptic","03E4Feicoptic","03E5feicoptic","03E6Kheicoptic","03E7kheicoptic","03E8Horicoptic","03E9horicoptic","03EAGangiacoptic","03EBgangiacoptic","03ECShimacoptic","03EDshimacoptic","03EEDeicoptic","03EFdeicoptic","03F0kappasymbolgreek","03F1rhosymbolgreek","03F3yotgreek","0401afii10023","0402afii10051","0403afii10052","0404afii10053","0405afii10054","0406afii10055","0407afii10056","0408afii10057","0409afii10058","040Aafii10059","040Bafii10060","040Cafii10061","040Eafii10062","040Fafii10145","0410afii10017","0411afii10018","0412afii10019","0413afii10020","0414afii10021","0415afii10022","0416afii10024","0417afii10025","0418afii10026","0419afii10027","041Aafii10028","041Bafii10029","041Cafii10030","041Dafii10031","041Eafii10032","041Fafii10033","0420afii10034","0421afii10035","0422afii10036","0423afii10037","0424afii10038","0425afii10039","0426afii10040","0427afii10041","0428afii10042","0429afii10043","042Aafii10044","042Bafii10045","042Cafii10046","042Dafii10047","042Eafii10048","042Fafii10049","0430afii10065","0431afii10066","0432afii10067","0433afii10068","0434afii10069","0435afii10070","0436afii10072","0437afii10073","0438afii10074","0439afii10075","043Aafii10076","043Bafii10077","043Cafii10078","043Dafii10079","043Eafii10080","043Fafii10081","0440afii10082","0441afii10083","0442afii10084","0443afii10085","0444afii10086","0445afii10087","0446afii10088","0447afii10089","0448afii10090","0449afii10091","044Aafii10092","044Bafii10093","044Cafii10094","044Dafii10095","044Eafii10096","044Fafii10097","0451afii10071","0452afii10099","0453afii10100","0454afii10101","0455afii10102","0456afii10103","0457afii10104","0458afii10105","0459afii10106","045Aafii10107","045Bafii10108","045Cafii10109","045Eafii10110","045Fafii10193","0462afii10146","0463afii10194","0472afii10147","0473afii10195","0474afii10148","0475afii10196","0490afii10050","0491afii10098","04D9afii10846","060Cafii57388","061Bafii57403","061Fafii57407","0621afii57409","0622afii57410","0623afii57411","0624afii57412","0625afii57413","0626afii57414","0627afii57415","0628afii57416","0629afii57417","062Aafii57418","062Bafii57419","062Cafii57420","062Dafii57421","062Eafii57422","062Fafii57423","0630afii57424","0631afii57425","0632afii57426","0633afii57427","0634afii57428","0635afii57429","0636afii57430","0637afii57431","0638afii57432","0639afii57433","063Aafii57434","0640afii57440","0641afii57441","0642afii57442","0643afii57443","0644afii57444","0645afii57445","0646afii57446","0647afii57470","0648afii57448","0649afii57449","064Aafii57450","064Bafii57451","064Cafii57452","064Dafii57453","064Eafii57454","064Fafii57455","0650afii57456","0651afii57457","0652afii57458","0660afii57392","0661afii57393","0662afii57394","0663afii57395","0664afii57396","0665afii57397","0666afii57398","0667afii57399","0668afii57400","0669afii57401","066Aafii57381","066Bdecimalseparatorarabic","066Cthousandsseparatorarabic","066Dafii63167","0679afii57511","067Eafii57506","0686afii57507","0688afii57512","0691afii57513","0698afii57508","06A4afii57505","06AFafii57509","06BAafii57514","06C1hehaltonearabic","06D1yehthreedotsbelowarabic","06D2afii57519","06D5afii57534","06F0zeropersian","06F1onepersian","06F2twopersian","06F3threepersian","06F4fourpersian","06F5fivepersian","06F6sixpersian","06F7sevenpersian","06F8eightpersian","06F9ninepersian","1E00Aringbelow","1E01aringbelow","1E02Bdotaccent","1E03bdotaccent","1E04Bdotbelow","1E05bdotbelow","1E06Blinebelow","1E07blinebelow","1E08Ccedillaacute","1E09ccedillaacute","1E0ADdotaccent","1E0Bddotaccent","1E0CDdotbelow","1E0Dddotbelow","1E0EDlinebelow","1E0Fdlinebelow","1E10Dcedilla","1E11dcedilla","1E12Dcircumflexbelow","1E13dcircumflexbelow","1E14Emacrongrave","1E15emacrongrave","1E16Emacronacute","1E17emacronacute","1E18Ecircumflexbelow","1E19ecircumflexbelow","1E1AEtildebelow","1E1Betildebelow","1E1CEcedillabreve","1E1Decedillabreve","1E1EFdotaccent","1E1Ffdotaccent","1E20Gmacron","1E21gmacron","1E22Hdotaccent","1E23hdotaccent","1E24Hdotbelow","1E25hdotbelow","1E26Hdieresis","1E27hdieresis","1E28Hcedilla","1E29hcedilla","1E2AHbrevebelow","1E2Bhbrevebelow","1E2CItildebelow","1E2Ditildebelow","1E2EIdieresisacute","1E2Fidieresisacute","1E30Kacute","1E31kacute","1E32Kdotbelow","1E33kdotbelow","1E34Klinebelow","1E35klinebelow","1E36Ldotbelow","1E37ldotbelow","1E38Ldotbelowmacron","1E39ldotbelowmacron","1E3ALlinebelow","1E3Bllinebelow","1E3CLcircumflexbelow","1E3Dlcircumflexbelow","1E3EMacute","1E3Fmacute","1E40Mdotaccent","1E41mdotaccent","1E42Mdotbelow","1E43mdotbelow","1E44Ndotaccent","1E45ndotaccent","1E46Ndotbelow","1E47ndotbelow","1E48Nlinebelow","1E49nlinebelow","1E4ANcircumflexbelow","1E4Bncircumflexbelow","1E4COtildeacute","1E4Dotildeacute","1E4EOtildedieresis","1E4Fotildedieresis","1E50Omacrongrave","1E51omacrongrave","1E52Omacronacute","1E53omacronacute","1E54Pacute","1E55pacute","1E56Pdotaccent","1E57pdotaccent","1E58Rdotaccent","1E59rdotaccent","1E5ARdotbelow","1E5Brdotbelow","1E5CRdotbelowmacron","1E5Drdotbelowmacron","1E5ERlinebelow","1E5Frlinebelow","1E60Sdotaccent","1E61sdotaccent","1E62Sdotbelow","1E63sdotbelow","1E64Sacutedotaccent","1E65sacutedotaccent","1E66Scarondotaccent","1E67scarondotaccent","1E68Sdotbelowdotaccent","1E69sdotbelowdotaccent","1E6ATdotaccent","1E6Btdotaccent","1E6CTdotbelow","1E6Dtdotbelow","1E6ETlinebelow","1E6Ftlinebelow","1E70Tcircumflexbelow","1E71tcircumflexbelow","1E72Udieresisbelow","1E73udieresisbelow","1E74Utildebelow","1E75utildebelow","1E76Ucircumflexbelow","1E77ucircumflexbelow","1E78Utildeacute","1E79utildeacute","1E7AUmacrondieresis","1E7Bumacrondieresis","1E7CVtilde","1E7Dvtilde","1E7EVdotbelow","1E7Fvdotbelow","1E80Wgrave","1E81wgrave","1E82Wacute","1E83wacute","1E84Wdieresis","1E85wdieresis","1E86Wdotaccent","1E87wdotaccent","1E88Wdotbelow","1E89wdotbelow","1E8AXdotaccent","1E8Bxdotaccent","1E8CXdieresis","1E8Dxdieresis","1E8EYdotaccent","1E8Fydotaccent","1E90Zcircumflex","1E91zcircumflex","1E92Zdotbelow","1E93zdotbelow","1E94Zlinebelow","1E95zlinebelow","1E96hlinebelow","1E97tdieresis","1E98wring","1E99yring","1E9Aarighthalfring","1E9Bslongdotaccent","1EA0Adotbelow","1EA1adotbelow","1EA2Ahookabove","1EA3ahookabove","1EA4Acircumflexacute","1EA5acircumflexacute","1EA6Acircumflexgrave","1EA7acircumflexgrave","1EA8Acircumflexhookabove","1EA9acircumflexhookabove","1EAAAcircumflextilde","1EABacircumflextilde","1EACAcircumflexdotbelow","1EADacircumflexdotbelow","1EAEAbreveacute","1EAFabreveacute","1EB0Abrevegrave","1EB1abrevegrave","1EB2Abrevehookabove","1EB3abrevehookabove","1EB4Abrevetilde","1EB5abrevetilde","1EB6Abrevedotbelow","1EB7abrevedotbelow","1EB8Edotbelow","1EB9edotbelow","1EBAEhookabove","1EBBehookabove","1EBCEtilde","1EBDetilde","1EBEEcircumflexacute","1EBFecircumflexacute","1EC0Ecircumflexgrave","1EC1ecircumflexgrave","1EC2Ecircumflexhookabove","1EC3ecircumflexhookabove","1EC4Ecircumflextilde","1EC5ecircumflextilde","1EC6Ecircumflexdotbelow","1EC7ecircumflexdotbelow","1EC8Ihookabove","1EC9ihookabove","1ECAIdotbelow","1ECBidotbelow","1ECCOdotbelow","1ECDodotbelow","1ECEOhookabove","1ECFohookabove","1ED0Ocircumflexacute","1ED1ocircumflexacute","1ED2Ocircumflexgrave","1ED3ocircumflexgrave","1ED4Ocircumflexhookabove","1ED5ocircumflexhookabove","1ED6Ocircumflextilde","1ED7ocircumflextilde","1ED8Ocircumflexdotbelow","1ED9ocircumflexdotbelow","1EDAOhornacute","1EDBohornacute","1EDCOhorngrave","1EDDohorngrave","1EDEOhornhookabove","1EDFohornhookabove","1EE0Ohorntilde","1EE1ohorntilde","1EE2Ohorndotbelow","1EE3ohorndotbelow","1EE4Udotbelow","1EE5udotbelow","1EE6Uhookabove","1EE7uhookabove","1EE8Uhornacute","1EE9uhornacute","1EEAUhorngrave","1EEBuhorngrave","1EECUhornhookabove","1EEDuhornhookabove","1EEEUhorntilde","1EEFuhorntilde","1EF0Uhorndotbelow","1EF1uhorndotbelow","1EF2Ygrave","1EF3ygrave","1EF4Ydotbelow","1EF5ydotbelow","1EF6Yhookabove","1EF7yhookabove","1EF8Ytilde","1EF9ytilde","2002enspace","200Bzerowidthspace","200Cafii61664","200Dafii301","200Eafii299","200Fafii300","2010hyphentwo","2012figuredash","2013endash","2014emdash","2015afii00208","2016dblverticalbar","2017underscoredbl","2018quoteleft","2019quoteright","201Aquotesinglbase","201Bquotereversed","201Cquotedblleft","201Dquotedblright","201Equotedblbase","2020dagger","2021daggerdbl","2022bullet","2024onedotenleader","2025twodotenleader","2026ellipsis","202Cafii61573","202Dafii61574","202Eafii61575","2030perthousand","2032minute","2033second","2035primereversed","2039guilsinglleft","203Aguilsinglright","203Breferencemark","203Cexclamdbl","203Eoverline","2042asterism","2044fraction","2070zerosuperior","2074foursuperior","2075fivesuperior","2076sixsuperior","2077sevensuperior","2078eightsuperior","2079ninesuperior","207Aplussuperior","207Cequalsuperior","207Dparenleftsuperior","207Eparenrightsuperior","207Fnsuperior","2080zeroinferior","2081oneinferior","2082twoinferior","2083threeinferior","2084fourinferior","2085fiveinferior","2086sixinferior","2087seveninferior","2088eightinferior","2089nineinferior","208Dparenleftinferior","208Eparenrightinferior","20A1colonmonetary","20A2cruzeiro","20A3franc","20A4afii08941","20A7peseta","20A9won","20AAafii57636","20ABdong","20ACEuro","2103centigrade","2105afii61248","2109fahrenheit","2111Ifraktur","2113afii61289","2116afii61352","2118weierstrass","211CRfraktur","211Eprescription","2121telephone","2122trademark","2126Omega","212Bangstrom","212Eestimated","2135aleph","2153onethird","2154twothirds","215Boneeighth","215Cthreeeighths","215Dfiveeighths","215Eseveneighths","2160Oneroman","2161Tworoman","2162Threeroman","2163Fourroman","2164Fiveroman","2165Sixroman","2166Sevenroman","2167Eightroman","2168Nineroman","2169Tenroman","216AElevenroman","216BTwelveroman","2170oneroman","2171tworoman","2172threeroman","2173fourroman","2174fiveroman","2175sixroman","2176sevenroman","2177eightroman","2178nineroman","2179tenroman","217Aelevenroman","217Btwelveroman","2200universal","2202partialdiff","2203existential","2205emptyset","2206Delta","2207gradient","2208element","2209notelement","220Bsuchthat","220Cnotcontains","220Fproduct","2211summation","2212minus","2213minusplus","2215divisionslash","2217asteriskmath","2219bulletoperator","221Aradical","221Dproportional","221Einfinity","221Forthogonal","2220angle","2223divides","2225parallel","2226notparallel","2227logicaland","2228logicalor","2229intersection","222Aunion","222Bintegral","222Cdblintegral","222Econtourintegral","2234therefore","2235because","2236ratio","2237proportion","223Csimilar","223Dreversedtilde","2243asymptoticallyequal","2245congruent","2248approxequal","224Callequal","2250approaches","2251geometricallyequal","2252approxequalorimage","2253imageorapproximatelyequal","2260notequal","2261equivalence","2262notidentical","2264lessequal","2265greaterequal","2266lessoverequal","2267greateroverequal","226Amuchless","226Bmuchgreater","226Enotless","226Fnotgreater","2270notlessnorequal","2271notgreaternorequal","2272lessorequivalent","2273greaterorequivalent","2276lessorgreater","2277greaterorless","2279notgreaternorless","227Aprecedes","227Bsucceeds","2280notprecedes","2281notsucceeds","2282propersubset","2283propersuperset","2284notsubset","2285notsuperset","2286reflexsubset","2287reflexsuperset","228Asubsetnotequal","228Bsupersetnotequal","2295circleplus","2296minuscircle","2297circlemultiply","2299circleot","22A3tackleft","22A4tackdown","22A5perpendicular","22BFrighttriangle","22C5dotmath","22CEcurlyor","22CFcurlyand","22DAlessequalorgreater","22DBgreaterequalorless","22EEellipsisvertical","F6BEdotlessj","F6BFLL","F6C0ll","F6C3commaaccent","F6C4afii10063","F6C5afii10064","F6C6afii10192","F6C7afii10831","F6C8afii10832","F6C9Acute","F6CACaron","F6CBDieresis","F6CCDieresisAcute","F6CDDieresisGrave","F6CEGrave","F6CFHungarumlaut","F6D0Macron","F6D1cyrBreve","F6D2cyrFlex","F6D3dblGrave","F6D4cyrbreve","F6D5cyrflex","F6D6dblgrave","F6D7dieresisacute","F6D8dieresisgrave","F6D9copyrightserif","F6DAregisterserif","F6DBtrademarkserif","F6DConefitted","F6DDrupiah","F8FFapple","FB00ff","FB01fi","FB02fl","FB03ffi","FB04ffl","FE61asterisksmall","FE62plussmall","FE63hyphensmall","FE64lesssmall","FE65greatersmall","FE66equalsmall","FE69dollarsmall","FE6Apercentsmall","FE6Batsmall","F020space","F021exclam","F022universal","F023numbersign","F024existential","F025percent","F026ampersand","F027suchthat","F028parenleft","F029parenright","F02Aasteriskmath","F02Bplus","F02Ccomma","F02Dminus","F02Eperiod","F02Fslash","F030zero","F031one","F032two","F033three","F034four","F035five","F036six","F037seven","F038eight","F039nine","F03Acolon","F03Bsemicolon","F03Cless","F03Dequal","F03Egreater","F03Fquestion","F040congruent","F041Alpha","F042Beta","F043Chi","F044Delta","F045Epsilon","F046Phi","F047Gamma","F048Eta","F049Iota","F04Atheta1","F04BKappa","F04CLambda","F04DMu","F04ENu","F04FOmicron","F050Pi","F051Theta","F052Rho","F053Sigma","F054Tau","F055Upsilon","F056sigma1","F057Omega","F058Xi","F059Psi","F05AZeta","F05Bbracketleft","F05Ctherefore","F05Dbracketright","F05Eperpendicular","F05Funderscore","F060radicalex","F061alpha","F062beta","F063chi","F064delta","F065epsilon","F066phi","F067gamma","F068eta","F069iota","F06Aphi1","F06Bkappa","F06Clambda","F06Dmu","F06Enu","F06Fomicron","F070pi","F071theta","F072rho","F073sigma","F074tau","F075upsilon","F076omega1","F077omega","F078xi","F079psi","F07Azeta","F07Bbraceleft","F07Cbar","F07Dbraceright","F07Esimilar","F0A0Euro","F0A1Upsilon1","F0A2minute","F0A3lessequal","F0A4fraction","F0A5infinity","F0A6florin","F0A7club","F0A8diamond","F0A9heart","F0AAspade","F0ABarrowboth","F0ACarrowleft","F0ADarrowup","F0AEarrowright","F0AFarrowdown","F0B0degree","F0B1plusminus","F0B2second","F0B3greaterequal","F0B4multiply","F0B5proportional","F0B6partialdiff","F0B7bullet","F0B8divide","F0B9notequal","F0BAequivalence","F0BBapproxequal","F0BCellipsis","F0BDarrowvertex","F0BEarrowhorizex","F0BFcarriagereturn","F0C0aleph","F0C1Ifraktur","F0C2Rfraktur","F0C3weierstrass","F0C4circlemultiply","F0C5circleplus","F0C6emptyset","F0C7intersection","F0C8union","F0C9propersuperset","F0CAreflexsuperset","F0CBnotsubset","F0CCpropersubset","F0CDreflexsubset","F0CEelement","F0CFnotelement","F0D0angle","F0D1gradient","F0D2registerserif","F0D3copyrightserif","F0D4trademarkserif","F0D5product","F0D6radical","F0D7dotmath","F0D8logicalnot","F0D9logicaland","F0DAlogicalor","F0DBarrowdblboth","F0DCarrowdblleft","F0DDarrowdblup","F0DEarrowdblright","F0DFarrowdbldown","F0E0lozenge","F0E1angleleft","F0E2registersans","F0E3copyrightsans","F0E4trademarksans","F0E5summation","F0E6parenlefttp","F0E7parenleftex","F0E8parenleftbt","F0E9bracketlefttp","F0EAbracketleftex","F0EBbracketleftbt","F0ECbracelefttp","F0EDbraceleftmid","F0EEbraceleftbt","F0EFbraceex","F0F1angleright","F0F2integral","F0F3integraltp","F0F4integralex","F0F5integralbt","F0F6parenrighttp","F0F7parenrightex","F0F8parenrightbt","F0F9bracketrighttp","F0FAbracketrightex","F0FBbracketrightbt","F0FCbracerighttp","F0FDbracerightmid","F0FEbracerightbt"];this._standardFontCharsNames=[];for(var e=0;e<t.length;e++){var r=parseInt(t[e].substr(0,4),16);this._standardFontCharsNames[r]=t[e].substr(4)}}return this._standardFontCharsNames},enumerable:!1,configurable:!0}),t.sRGBprofile=[0,0,12,72,76,105,110,111,2,16,0,0,109,110,116,114,82,71,66,32,88,89,90,32,7,206,0,2,0,9,0,6,0,49,0,0,97,99,115,112,77,83,70,84,0,0,0,0,73,69,67,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,246,214,0,1,0,0,0,0,211,45,72,80,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,99,112,114,116,0,0,1,80,0,0,0,51,100,101,115,99,0,0,1,132,0,0,0,108,119,116,112,116,0,0,1,240,0,0,0,20,98,107,112,116,0,0,2,4,0,0,0,20,114,88,89,90,0,0,2,24,0,0,0,20,103,88,89,90,0,0,2,44,0,0,0,20,98,88,89,90,0,0,2,64,0,0,0,20,100,109,110,100,0,0,2,84,0,0,0,112,100,109,100,100,0,0,2,196,0,0,0,136,118,117,101,100,0,0,3,76,0,0,0,134,118,105,101,119,0,0,3,212,0,0,0,36,108,117,109,105,0,0,3,248,0,0,0,20,109,101,97,115,0,0,4,12,0,0,0,36,116,101,99,104,0,0,4,48,0,0,0,12,114,84,82,67,0,0,4,60,0,0,8,12,103,84,82,67,0,0,4,60,0,0,8,12,98,84,82,67,0,0,4,60,0,0,8,12,116,101,120,116,0,0,0,0,67,111,112,121,114,105,103,104,116,32,40,99,41,32,49,57,57,56,32,72,101,119,108,101,116,116,45,80,97,99,107,97,114,100,32,67,111,109,112,97,110,121,0,0,100,101,115,99,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,243,81,0,1,0,0,0,1,22,204,88,89,90,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,111,162,0,0,56,245,0,0,3,144,88,89,90,32,0,0,0,0,0,0,98,153,0,0,183,133,0,0,24,218,88,89,90,32,0,0,0,0,0,0,36,160,0,0,15,132,0,0,182,207,100,101,115,99,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,105,101,119,0,0,0,0,0,19,164,254,0,20,95,46,0,16,207,20,0,3,237,204,0,4,19,11,0,3,92,158,0,0,0,1,88,89,90,32,0,0,0,0,0,76,9,86,0,80,0,0,0,87,31,231,109,101,97,115,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,143,0,0,0,2,115,105,103,32,0,0,0,0,67,82,84,32,99,117,114,118,0,0,0,0,0,0,4,0,0,0,0,5,0,10,0,15,0,20,0,25,0,30,0,35,0,40,0,45,0,50,0,55,0,59,0,64,0,69,0,74,0,79,0,84,0,89,0,94,0,99,0,104,0,109,0,114,0,119,0,124,0,129,0,134,0,139,0,144,0,149,0,154,0,159,0,164,0,169,0,174,0,178,0,183,0,188,0,193,0,198,0,203,0,208,0,213,0,219,0,224,0,229,0,235,0,240,0,246,0,251,1,1,1,7,1,13,1,19,1,25,1,31,1,37,1,43,1,50,1,56,1,62,1,69,1,76,1,82,1,89,1,96,1,103,1,110,1,117,1,124,1,131,1,139,1,146,1,154,1,161,1,169,1,177,1,185,1,193,1,201,1,209,1,217,1,225,1,233,1,242,1,250,2,3,2,12,2,20,2,29,2,38,2,47,2,56,2,65,2,75,2,84,2,93,2,103,2,113,2,122,2,132,2,142,2,152,2,162,2,172,2,182,2,193,2,203,2,213,2,224,2,235,2,245,3,0,3,11,3,22,3,33,3,45,3,56,3,67,3,79,3,90,3,102,3,114,3,126,3,138,3,150,3,162,3,174,3,186,3,199,3,211,3,224,3,236,3,249,4,6,4,19,4,32,4,45,4,59,4,72,4,85,4,99,4,113,4,126,4,140,4,154,4,168,4,182,4,196,4,211,4,225,4,240,4,254,5,13,5,28,5,43,5,58,5,73,5,88,5,103,5,119,5,134,5,150,5,166,5,181,5,197,5,213,5,229,5,246,6,6,6,22,6,39,6,55,6,72,6,89,6,106,6,123,6,140,6,157,6,175,6,192,6,209,6,227,6,245,7,7,7,25,7,43,7,61,7,79,7,97,7,116,7,134,7,153,7,172,7,191,7,210,7,229,7,248,8,11,8,31,8,50,8,70,8,90,8,110,8,130,8,150,8,170,8,190,8,210,8,231,8,251,9,16,9,37,9,58,9,79,9,100,9,121,9,143,9,164,9,186,9,207,9,229,9,251,10,17,10,39,10,61,10,84,10,106,10,129,10,152,10,174,10,197,10,220,10,243,11,11,11,34,11,57,11,81,11,105,11,128,11,152,11,176,11,200,11,225,11,249,12,18,12,42,12,67,12,92,12,117,12,142,12,167,12,192,12,217,12,243,13,13,13,38,13,64,13,90,13,116,13,142,13,169,13,195,13,222,13,248,14,19,14,46,14,73,14,100,14,127,14,155,14,182,14,210,14,238,15,9,15,37,15,65,15,94,15,122,15,150,15,179,15,207,15,236,16,9,16,38,16,67,16,97,16,126,16,155,16,185,16,215,16,245,17,19,17,49,17,79,17,109,17,140,17,170,17,201,17,232,18,7,18,38,18,69,18,100,18,132,18,163,18,195,18,227,19,3,19,35,19,67,19,99,19,131,19,164,19,197,19,229,20,6,20,39,20,73,20,106,20,139,20,173,20,206,20,240,21,18,21,52,21,86,21,120,21,155,21,189,21,224,22,3,22,38,22,73,22,108,22,143,22,178,22,214,22,250,23,29,23,65,23,101,23,137,23,174,23,210,23,247,24,27,24,64,24,101,24,138,24,175,24,213,24,250,25,32,25,69,25,107,25,145,25,183,25,221,26,4,26,42,26,81,26,119,26,158,26,197,26,236,27,20,27,59,27,99,27,138,27,178,27,218,28,2,28,42,28,82,28,123,28,163,28,204,28,245,29,30,29,71,29,112,29,153,29,195,29,236,30,22,30,64,30,106,30,148,30,190,30,233,31,19,31,62,31,105,31,148,31,191,31,234,32,21,32,65,32,108,32,152,32,196,32,240,33,28,33,72,33,117,33,161,33,206,33,251,34,39,34,85,34,130,34,175,34,221,35,10,35,56,35,102,35,148,35,194,35,240,36,31,36,77,36,124,36,171,36,218,37,9,37,56,37,104,37,151,37,199,37,247,38,39,38,87,38,135,38,183,38,232,39,24,39,73,39,122,39,171,39,220,40,13,40,63,40,113,40,162,40,212,41,6,41,56,41,107,41,157,41,208,42,2,42,53,42,104,42,155,42,207,43,2,43,54,43,105,43,157,43,209,44,5,44,57,44,110,44,162,44,215,45,12,45,65,45,118,45,171,45,225,46,22,46,76,46,130,46,183,46,238,47,36,47,90,47,145,47,199,47,254,48,53,48,108,48,164,48,219,49,18,49,74,49,130,49,186,49,242,50,42,50,99,50,155,50,212,51,13,51,70,51,127,51,184,51,241,52,43,52,101,52,158,52,216,53,19,53,77,53,135,53,194,53,253,54,55,54,114,54,174,54,233,55,36,55,96,55,156,55,215,56,20,56,80,56,140,56,200,57,5,57,66,57,127,57,188,57,249,58,54,58,116,58,178,58,239,59,45,59,107,59,170,59,232,60,39,60,101,60,164,60,227,61,34,61,97,61,161,61,224,62,32,62,96,62,160,62,224,63,33,63,97,63,162,63,226,64,35,64,100,64,166,64,231,65,41,65,106,65,172,65,238,66,48,66,114,66,181,66,247,67,58,67,125,67,192,68,3,68,71,68,138,68,206,69,18,69,85,69,154,69,222,70,34,70,103,70,171,70,240,71,53,71,123,71,192,72,5,72,75,72,145,72,215,73,29,73,99,73,169,73,240,74,55,74,125,74,196,75,12,75,83,75,154,75,226,76,42,76,114,76,186,77,2,77,74,77,147,77,220,78,37,78,110,78,183,79,0,79,73,79,147,79,221,80,39,80,113,80,187,81,6,81,80,81,155,81,230,82,49,82,124,82,199,83,19,83,95,83,170,83,246,84,66,84,143,84,219,85,40,85,117,85,194,86,15,86,92,86,169,86,247,87,68,87,146,87,224,88,47,88,125,88,203,89,26,89,105,89,184,90,7,90,86,90,166,90,245,91,69,91,149,91,229,92,53,92,134,92,214,93,39,93,120,93,201,94,26,94,108,94,189,95,15,95,97,95,179,96,5,96,87,96,170,96,252,97,79,97,162,97,245,98,73,98,156,98,240,99,67,99,151,99,235,100,64,100,148,100,233,101,61,101,146,101,231,102,61,102,146,102,232,103,61,103,147,103,233,104,63,104,150,104,236,105,67,105,154,105,241,106,72,106,159,106,247,107,79,107,167,107,255,108,87,108,175,109,8,109,96,109,185,110,18,110,107,110,196,111,30,111,120,111,209,112,43,112,134,112,224,113,58,113,149,113,240,114,75,114,166,115,1,115,93,115,184,116,20,116,112,116,204,117,40,117,133,117,225,118,62,118,155,118,248,119,86,119,179,120,17,120,110,120,204,121,42,121,137,121,231,122,70,122,165,123,4,123,99,123,194,124,33,124,129,124,225,125,65,125,161,126,1,126,98,126,194,127,35,127,132,127,229,128,71,128,168,129,10,129,107,129,205,130,48,130,146,130,244,131,87,131,186,132,29,132,128,132,227,133,71,133,171,134,14,134,114,134,215,135,59,135,159,136,4,136,105,136,206,137,51,137,153,137,254,138,100,138,202,139,48,139,150,139,252,140,99,140,202,141,49,141,152,141,255,142,102,142,206,143,54,143,158,144,6,144,110,144,214,145,63,145,168,146,17,146,122,146,227,147,77,147,182,148,32,148,138,148,244,149,95,149,201,150,52,150,159,151,10,151,117,151,224,152,76,152,184,153,36,153,144,153,252,154,104,154,213,155,66,155,175,156,28,156,137,156,247,157,100,157,210,158,64,158,174,159,29,159,139,159,250,160,105,160,216,161,71,161,182,162,38,162,150,163,6,163,118,163,230,164,86,164,199,165,56,165,169,166,26,166,139,166,253,167,110,167,224,168,82,168,196,169,55,169,169,170,28,170,143,171,2,171,117,171,233,172,92,172,208,173,68,173,184,174,45,174,161,175,22,175,139,176,0,176,117,176,234,177,96,177,214,178,75,178,194,179,56,179,174,180,37,180,156,181,19,181,138,182,1,182,121,182,240,183,104,183,224,184,89,184,209,185,74,185,194,186,59,186,181,187,46,187,167,188,33,188,155,189,21,189,143,190,10,190,132,190,255,191,122,191,245,192,112,192,236,193,103,193,227,194,95,194,219,195,88,195,212,196,81,196,206,197,75,197,200,198,70,198,195,199,65,199,191,200,61,200,188,201,58,201,185,202,56,202,183,203,54,203,182,204,53,204,181,205,53,205,181,206,54,206,182,207,55,207,184,208,57,208,186,209,60,209,190,210,63,210,193,211,68,211,198,212,73,212,203,213,78,213,209,214,85,214,216,215,92,215,224,216,100,216,232,217,108,217,241,218,118,218,251,219,128,220,5,220,138,221,16,221,150,222,28,222,162,223,41,223,175,224,54,224,189,225,68,225,204,226,83,226,219,227,99,227,235,228,115,228,252,229,132,230,13,230,150,231,31,231,169,232,50,232,188,233,70,233,208,234,91,234,229,235,112,235,251,236,134,237,17,237,156,238,40,238,180,239,64,239,204,240,88,240,229,241,114,241,255,242,140,243,25,243,167,244,52,244,194,245,80,245,222,246,109,246,251,247,138,248,25,248,168,249,56,249,199,250,87,250,231,251,119,252,7,252,152,253,41,253,186,254,75,254,220,255,109,255,255],t.hatchData=["000000FF00000000","1010101010101010","8040201008040201","0102040810204080","101010FF10101010","8142241818244281","8000000008000000","0010000100100001","2200880022008800","2288228822882288","2255885522558855","AA558A55AA55A855","AA55AA55AA55AA55","BB55EE55BB55EE55","DD77DD77DD77DD77","FFDDFF77FFDDFF77","FF7FFFF7FF7FFFF7","FF7FFFFFFFF7FFFF","8844221188442211","1122448811224488","CC663399CC663399","993366CC993366CC","E070381C0E0783C1","C183070E1C3870E0","4040404040404040","00FF000000FF0000","AAAAAAAAAAAAAAAA","FF00FF00FF00FF00","CCCCCCCCCCCCCCCC","FFFF0000FFFF0000","8844221100000000","1122448800000000","F00000000F000000","8080808008080808","0240088004200110","0C8DB130031BD8C0","8403304884033048","00304A8100304A81","0102040818244281","202020FF020202FF","1422518854224588","F0F0F0F0AA55AA55","0100201020000102","AA00800080008000","0020008800020088","8448300C02010103","33FFCCFF33FFCCFF","98F8F877898F8F77","111111FF111111FF","3333CCCC3333CCCC","0F0F0F0FF0F0F0F0","0502058850205088","10387CFE7C381000","0000000000000000"],t.standardFontWidths=null,t.standardFontInfo=null,t._standardFontCharsNames=null,t}();t.StiPdfResources=e}(e=t.Export||(t.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.System.StiArray,i=t.System.StiString,n=function(){function n(t){this.ownerValue=[],this.userValue=[],this.ownerExtendedValue=[],this.userExtendedValue=[],this.permsValue=[],this.IDValue=null,this.encryptionKey=null,this.encryptionKeyLength=0,this.passwordOwner="",this.passwordUser="",this.securityFlags=0,this.keyLength=e.StiPdfEncryptionKeyLength.Bit40,this.pdfService=null,this.pdfService=t}return n.prototype.padPassword=function(t){for(var e=[],r=0;r<t.length;r++)e[r]=t.charCodeAt(r);for(var i=0;i<n.paddingString.length;i++)e[r++]=n.paddingString[i];var o=[];for(r=0;r<32;r++)o[r]=e[r];return o},n.prototype.computingCryptoValues=function(t,r,i,n,o){this.securityFlags=4294967232;var a=0;0!=(t&e.StiUserAccessPrivileges.PrintDocument)&&(a|=1<<2),0!=(t&e.StiUserAccessPrivileges.ModifyContents)&&(a|=1<<3),0!=(t&e.StiUserAccessPrivileges.CopyTextAndGraphics)&&(a|=1<<4),0!=(t&e.StiUserAccessPrivileges.AddOrModifyTextAnnotations)&&(a|=1<<5),this.securityFlags|=a,null==r&&(r=""),null==i&&(i=""),this.passwordOwner=r,this.passwordUser=i,this.keyLength=n,this.IDValue=o;var s=!1,l;(this.passwordOwner.length>0||this.passwordUser.length>0||t!=e.StiUserAccessPrivileges.All)&&(s=!0,this.computingCryptoValues2()||(s=!1,this.throwEncryptionError(0,"Encryption not work!")));return s},n.prototype.computingCryptoValues2=function(){if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128_r4)return this.computingCryptoValuesV4();if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r6)return this.computingCryptoValuesV5();var t=this.passwordOwner;i.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);var r=this.padPassword(t),o=this.computeHashMD5(r);if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)for(var a=0;a<50;a++)o=this.computeHashMD5(o);if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit40){var s=[];s[0]=o[0],s[1]=o[1],s[2]=o[2],s[3]=o[3],s[4]=o[4],o=s}var l=this.padPassword(this.passwordUser);if(l=this.rc4(l,o),this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)for(var m=1;m<=19;m++){for(var c=0;c<16;c++)o[c]^=m-1,o[c]^=m;l=this.rc4(l,o)}l.stimulsoft.copyTo(this.ownerValue,0);var p=this.passwordUser,g=this.padPassword(p),h=this.getBytesUInt32(this.securityFlags),w=[];if(w.stimulsoft.addRange(g),w.stimulsoft.addRange(l),w.stimulsoft.addRange(h),w.stimulsoft.addRange(this.IDValue),o=this.computeHashMD5(w),this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)for(var a=0;a<50;a++)o=this.computeHashMD5(o);this.encryptionKey=[],this.encryptionKeyLength=this.keyLength==e.StiPdfEncryptionKeyLength.Bit128?16:5;for(var u=0;u<this.encryptionKeyLength;u++)this.encryptionKey[u]=o[u];var d=[];if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128){(w=[]).stimulsoft.addRange(n.paddingString),w.stimulsoft.addRange(this.IDValue),o=this.computeHashMD5(w),o=this.rc4(o,this.encryptionKey);for(var S=[],m=1;m<=19;m++){for(var c=0;c<16;c++)S[c]=this.encryptionKey[c]^m;o=this.rc4(o,S)}n.paddingString.stimulsoft.copyTo(d,0),o.stimulsoft.copyTo(d,0)}else n.paddingString.stimulsoft.copyTo(d,0),d=this.rc4(d,this.encryptionKey);return d.stimulsoft.copyTo(this.userValue,0),!0},n.prototype.computingCryptoValuesV4=function(){var t=this.passwordOwner;i.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);for(var e=this.padPassword(t),r=this.computeHashMD5(e),o=0;o<50;o++)r=this.computeHashMD5(r);var a=this.padPassword(this.passwordUser);a=this.rc4(a,r);for(var s=1;s<=19;s++){for(var l=0;l<16;l++)r[l]^=s-1,r[l]^=s;a=this.rc4(a,r)}a.stimulsoft.copyTo(this.ownerValue,0);var m=this.passwordUser,c=this.padPassword(m),p=this.getBytesUInt32(this.securityFlags),g=[];g.stimulsoft.addRange(c),g.stimulsoft.addRange(a),g.stimulsoft.addRange(p),g.stimulsoft.addRange(this.IDValue),r=this.computeHashMD5(g);for(var o=0;o<50;o++)r=this.computeHashMD5(r);this.encryptionKey=[],this.encryptionKeyLength=16;for(var h=0;h<this.encryptionKeyLength;h++)this.encryptionKey[h]=r[h];var w=[];(g=[]).stimulsoft.addRange(n.paddingString),g.stimulsoft.addRange(this.IDValue),r=this.computeHashMD5(g),r=this.rc4(r,this.encryptionKey);for(var u=[],s=1;s<=19;s++){for(var l=0;l<16;l++)u[l]=this.encryptionKey[l]^s;r=this.rc4(r,u)}return n.paddingString.stimulsoft.copyTo(w,0),r.stimulsoft.copyTo(w,0),w.stimulsoft.copyTo(this.userValue,0),!0},n.prototype.computingCryptoValuesV5=function(){var e=new t.System.Crypt.SecureRandom,n=null,o=null,a=e.createNextBytes(32),s=e.createNextBytes(8),l=e.createNextBytes(8),m=e.createNextBytes(8),c=e.createNextBytes(8),p=t.System.Text.Encoding.UTF8.getBytes(this.passwordUser);if(p.length>127){var g=[];r.copy2(p,0,g,0,127),p=g}(o=this.getHashV5(p,s,null)).stimulsoft.copyTo(this.userValue,0),s.stimulsoft.copyTo(this.userValue,32),l.stimulsoft.copyTo(this.userValue,40),o=this.getHashV5(p,l,null),this.encodeKeyDataV5(o,a,!0).stimulsoft.copyTo(this.userExtendedValue,0);var h=this.passwordOwner;i.isNullOrEmpty(this.passwordOwner)&&(h=this.passwordUser);var w=t.System.Text.Encoding.UTF8.getBytes(h);if(w.length>127){var g=[];r.copy2(w,0,g,0,127),w=g}return(o=this.getHashV5(w,m,this.userValue)).stimulsoft.copyTo(this.ownerValue,0),m.stimulsoft.copyTo(this.ownerValue,32),c.stimulsoft.copyTo(this.ownerValue,40),o=this.getHashV5(w,c,this.userValue),this.encodeKeyDataV5(o,a,!0).stimulsoft.copyTo(this.ownerExtendedValue,0),n=e.createNextBytes(16),this.getBytesUInt32(this.securityFlags).stimulsoft.copyTo(n,0),n[4]=255,n[5]=255,n[6]=255,n[7]=255,n[8]=84,n[9]=97,n[10]=100,n[11]=98,this.permsValue=this.encodeKeyDataV5(a,n,!1),o=this.getHashV5(p,l,null),this.encryptionKey=this.decodeKeyDataV5(o,this.userExtendedValue,!0),97==(n=this.decodeKeyDataV5(this.encryptionKey,this.permsValue,!1))[9]&&100==n[10]&&98==n[11]||this.throwEncryptionError(102,"Verifying key calculation failed"),!0},n.prototype.encodeKeyDataV5=function(e,r,i){var n=null;if(i){var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;n=(a=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(e,o)).encrypt(r)}else{var a;n=(a=new t.ExternalLibrary.aesjs.ModeOfOperation.ecb(e)).encrypt(r)}for(var s=[],l=0;l<n.length;l++)s[l]=n[l];return s},n.prototype.decodeKeyDataV5=function(e,r,i){var n=null;if(i){var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a;n=(a=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(e,o)).decrypt(r)}else{var a;n=(a=new t.ExternalLibrary.aesjs.ModeOfOperation.ecb(e)).decrypt(r)}for(var s=[],l=0;l<n.length;l++)s[l]=n[l];return s},n.prototype.getHashV5=function(t,r,i){return this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5?n.calculate_hash_r5(t,r,i):n.calculate_hash_r6(t,r,i)},n.calculate_hash_r5=function(e,r,i){var n=[];return n.stimulsoft.addRange(e),n.stimulsoft.addRange(r),null!=i&&n.stimulsoft.addRange(i),t.System.Crypt.SHA2.SHA256(n)},n.calculate_hash_r6=function(e,i,n){var o=[],a=[],s=32,l=0,m=null,c=[],p=[],g=new t.System.Crypt.SHA2;(m=[]).stimulsoft.addRange(e),m.stimulsoft.addRange(i),null!=n&&m.stimulsoft.addRange(n),g.SHA2_256(m).stimulsoft.copyTo(a,0);for(var h=0;h<64||h<o[64*l-1]+32;h++){m.stimulsoft.clear(),m.stimulsoft.addRange(e);for(var w=0;w<s;w++)m.push(a[w]);l=e.length+s,null!=n&&(m.stimulsoft.addRange(n),l+=48);for(var u=0;u<64;u++)m.stimulsoft.copyTo(o,u*l);r.copy2(a,0,c,0,16),r.copy2(a,16,p,0,16);for(var d,S=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(c,p).encrypt(o.slice(0,64*l)),f=0;f<S.length;f++)o[f]=S[f];for(var v=0,u=0;u<16;u++)v+=o[u];switch(s=32+v%3*16){case 32:g.SHA2_256(o.slice(0,64*l)).stimulsoft.copyTo(a,0);break;case 48:g.SHA2_384(o.slice(0,64*l)).stimulsoft.copyTo(a,0);break;case 64:g.SHA2_512(o.slice(0,64*l)).stimulsoft.copyTo(a,0);break}}var E=[];return r.copy2(a,0,E,0,32),E},n.prototype.encryptData=function(r,i,n){if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit40||this.keyLength==e.StiPdfEncryptionKeyLength.Bit128){var o=i,a=n,s=[];this.encryptionKey.stimulsoft.copyTo(s,0),this.getBytesUInt32(o).stimulsoft.copyTo(s,this.encryptionKeyLength),this.getBytesUint16(a).stimulsoft.copyTo(s,this.encryptionKeyLength+3);var l=this.computeHashMD5(s);this.keyLength==e.StiPdfEncryptionKeyLength.Bit40&&(l=l.slice(0,10)),r=this.rc4(r,l)}else if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128_r4){var o=i,a=n,s=[];this.encryptionKey.stimulsoft.copyTo(s,0),this.getBytesUInt32(o).stimulsoft.copyTo(s,16),this.getBytesUint16(a).stimulsoft.copyTo(s,19),s[21]=115,s[22]=65,s[23]=108,s[24]=84;var l=this.computeHashMD5(s),m=(new t.System.Crypt.SecureRandom).createNextBytes(16),c,p;(c=[]).stimulsoft.addRange(m),c.stimulsoft.addRange(r),c=new t.ExternalLibrary.aesjs.padding.pkcs7.pad(c),r=(p=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(l,m)).encrypt(c)}else{var m=(new t.System.Crypt.SecureRandom).createNextBytes(16),c,p;(c=[]).stimulsoft.addRange(m),c.stimulsoft.addRange(r),c=new t.ExternalLibrary.aesjs.padding.pkcs7.pad(c),r=(p=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(this.encryptionKey,m)).encrypt(c)}return r},n.prototype.throwEncryptionError=function(t,e){throw new Error(i.format("EncryptionError at step {0} : {1}",t,e))},n.prototype.renderEncodeRecord=function(t){var r="",n="",o=32;this.keyLength!=e.StiPdfEncryptionKeyLength.Bit256_r5&&this.keyLength!=e.StiPdfEncryptionKeyLength.Bit256_r6||(o=48);var a=0;for(a=0;a<o;a++)r+=String.fromCharCode(this.ownerValue[a]),n+=String.fromCharCode(this.userValue[a]);if(t.writeLine("/Filter /Standard"),this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/V2/Length 16>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine("/R 3"),t.writeLine("/V 2"),t.writeLine("/Length 128");else if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128_r4)t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV2/Length 16>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine("/R 4"),t.writeLine("/V 4"),t.writeLine("/Length 128");else if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r6){t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV3/Length 32>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine1("/R {0}",this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5?5:6),t.writeLine("/V 5"),t.writeLine("/Length 256");var s="",l="";for(a=0;a<32;a++)s+=String.fromCharCode(this.ownerExtendedValue[a]),l+=String.fromCharCode(this.userExtendedValue[a]);var m="";for(a=0;a<16;a++)m+=String.fromCharCode(this.permsValue[a]);t.writeString(i.format("/OE ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(s)),!0),t.writeString(i.format("/UE ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(l)),!0),t.writeString(i.format("/Perms ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(m)),!0)}else t.writeLine("/R 2"),t.writeLine("/V 1"),t.writeLine("/Length 40");t.writeString(i.format("/O ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(r)),!0),t.writeString(i.format("/U ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(n)),!0),t.writeLine1("/P {0}",this.securityFlags)},n.prototype.getBytesUInt32=function(t){var e=[];return e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255),e},n.prototype.getBytesUint16=function(t){var e=[];return e.push(255&t),e.push(t>>8&255),e},n.prototype.rc4=function(t,e){var r=[],i=0,n=0,o,a=[],s=e.length,l=t.length;for(i=0;i<256;i++)r[i]=i;for(i=0;i<256;i++)n=(n+r[i]+e[i%s])%256,o=r[i],r[i]=r[n],r[n]=o;i=0,n=0;for(var m=0;m<l;m++)n=(n+r[i=(i+1)%256])%256,o=r[i],r[i]=r[n],r[n]=o,a.push(t[m]^r[(r[i]+r[n])%256]);return a},n.prototype.computeHashMD5=function(e){for(var r="",i=0;i<e.length;i++)r+=String.fromCharCode(e[i]);return t.Base.StiMD5Helper.MD5(r,!1)},n.paddingString=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122],n}();e.StiPdfSecurity=n}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(e){var r=t.System.StiString,i=function(){function t(){this.ref=-1,this.info=null}return Object.defineProperty(t.prototype,"isUsed",{get:function(){return!(-1==this.ref)},enumerable:!1,configurable:!0}),t.prototype.addRef=function(){this.info.addRef(this)},t.prototype.toString=function(){if(-1==this.ref)return"-";return r.format("ref = {0}",this.ref)},t}();e.StiPdfObjInfo=i;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfContentObjInfo=n;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfXObjectObjInfo=o;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfFontObjInfo=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfOutlinesObjInfo=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfPatternsObjInfo=l;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfAnnotObjInfo=m;var c=function(){function t(){}return t}();e.StiPdfCheckBoxObjInfo=c;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(i);e.StiPdfAcroFormObjInfo=p;var g=function(){function t(){this.objectsCounter=0,this.objects=null,this.objectsCounter=0,this.objects=[],this.root=this.createObject(!0),this.info=this.createObject(!0),this.colorSpace=this.createObject(!0),this.pages=this.createObject(!0),this.structTreeRoot=this.createObject(!0),this.optionalContentGroup=this.createObject(!0),this.pageList=[],this.xObjectList=[],this.fontList=[],this.linkList=[],this.embeddedFilesList=[]}return t.prototype.addRef=function(t){this.objectsCounter++,t.ref=this.objectsCounter},t.prototype.createObject=function(t){void 0===t&&(t=!1);var e=new i;return e.info=this,t&&this.addRef(e),e},t.prototype.createContentObject=function(t){void 0===t&&(t=!1);var e=new n;return e.info=this,t&&this.addRef(e),e.content=this.createObject(t),e},t.prototype.createXObject=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var r=new o;return r.info=this,t&&this.addRef(r),r.mask=this.createObject(t&&e),r},t.prototype.createFontObject=function(t,e,r,i,n){void 0===t&&(t=!1),void 0===e&&(e=!0),void 0===r&&(r=!1),void 0===i&&(i=!0),void 0===n&&(n=!1);var o=new a;return o.info=this,t&&this.addRef(o),o.descendantFont=this.createObject(t&&e),o.toUnicode=this.createObject(t&&e),o.cIDSet=this.createObject(t&&e),o.encoding=this.createObject(t&&!e&&!n),o.fontDescriptor=this.createObject(t&&!r),o.fontFile2=this.createObject(t&&i),o},t.prototype.createOutlinesObject=function(t){void 0===t&&(t=!1);var e=new s;return e.info=this,t&&this.addRef(e),e.items=[],e},t.prototype.createPatternsObject=function(t){void 0===t&&(t=!1);var e=new l;return e.info=this,e.resources=this.createObject(t),e.first=this.createObject(t),e.hatchItems=[],e.shadingItems=[],e.shadingFunctionItems=[],e},t.prototype.createAcroFormObject=function(t){void 0===t&&(t=!1);var e=new p;return e.info=this,t&&this.addRef(e),e.annots=[],e.checkBoxes=[],e.unsignedSignatures=[],e.signatures=[],e.tooltips=[],e.annotFontItems=[],e},t.prototype.createAnnotObject=function(t,e,r){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===r&&(r=0);var i=new m;i.info=this,t&&this.addRef(i),i.aP=this.createObject(t&&e),i.aA=[];for(var n=0;n<r;n++)i.aA.push(this.createObject(t));return i},t}();e.StiPdfStructure=g}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.System.Char,n=t.Report.Components.StiCheckBox,o=t.System.Globalization.CultureInfo,a=t.Base.Zip.StiZipWriter20,s=t.Report.ImageFormat,l=t.Report.Components.IStiExportImageExtended,m=t.Report.Components.StiText,c=t.System.StiArray,p=t.System.Collections.Hashtable,g=t.Report.Components.StiPageOrientation,h=t.Report.Components.StiPagesCollection,w=t.System.DateTime,u=t.System.Xml.Formatting,d=t.System.Xml.XmlTextWriter,S=t.System.Text.Encoding,f=t.System.IO.StreamWriter,v=t.System.Drawing.Color,E=t.System.StiString,b=t.System.IO.MemoryStream,y=t.Base.Localization.StiLocalization,x=function(){function t(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=v.transparent,this.VertAlign=StiVertAlignment.Bottom,this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=v.black,this.HorAlign=StiTextHorAlignment.Left,this.Angle=0,this.Wordwrap=!1,this.DataStyle=-1}return t}(),A=function(){function t(){this.isNumeric=!1,this.isCurrency=!1,this.isPercent=!1,this.isDate=!1,this.isTime=!1,this.isDefaultFormat=!1,this.DecimalDigits=2,this.DecimalComma=" ",this.GroupDigits=0,this.CurrencySymbol="$",this.CurrencyPositionBefore=!1,this.NegativeBraces=!1,this.DateTimeFormatString=null,this.CurrencyPositivePattern=null,this.CurrencyNegativePattern=null}return t}(),T=function(v){function T(){var t=null!==v&&v.apply(this,arguments)||this;return t.matrix=null,t.imageCache=null,t.cellStyleList=null,t.dataStyleList=null,t.sheetNameList=null,t.matrixList=null,t.firstPageIndexList=null,t.minRowList=null,t.maxRowList=null,t.cellStyleTableList=null,t.imageQuality=.75,t.imageResolution=96,t.xmlIndentation=1,t}return __extends(T,v),T.prototype.implements=function(){return[r.IStiOdsExportService]},Object.defineProperty(T.prototype,"defaultExtension",{get:function(){return"ods"},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Ods},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"groupCategory",{get:function(){return"Excel"},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"position",{get:function(){return r.StiExportPosition.Ods},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"exportNameInMenu",{get:function(){return y.get("Export","ExportTypeCalcFile")},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),T.prototype.getFilter=function(){return y.get("FileFilters","WriteCalcFilesrFiles")},T.prototype.exportTo=function(t,e,r){this.exportOds(t,e,r)},T.prototype.exportToAsync=function(e,r,i,n){var o=this;t.Report.Export.StiExportImageHelper.convertAllImages(r,t.System.Drawing.Imaging.ImageFormat.Jpeg).try((function(){o.exportTo(r,i,n),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null),e()}))},T.prototype.doubleToString=function(t){return Math.round2(t/100,4).toString().stimulsoft.replaceAll(",",".")+"in"},T.prototype.getColumnName=function(t){var e=t/26|0,r=t%26,i="";return e>0&&(i+=String.fromCharCode(65+e-1)),i+=String.fromCharCode(65+r)},T.prototype.getColorString=function(t){return"#"+E.format("{0:X8}",t.toArgb()).substr(2)},T.prototype.getCellStyleNumber=function(e,r,i,o){for(var a=new x,s=!0,l=!0,c=0;c<i;c++)null==this.matrix.bordersY[e+c][r]&&(s=!1),null==this.matrix.bordersY[e+c][r+o]&&(l=!1);for(var p=!0,g=!0,c=0;c<o;c++)null==this.matrix.bordersX[e][r+c]&&(p=!1),null==this.matrix.bordersX[e+i][r+c]&&(g=!1);if(p&&(a.BorderTop=this.getStringFromBorder(this.matrix.bordersX[e][r])),s&&(a.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[e][r])),g&&(a.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[e+i][r])),l&&(a.BorderRight=this.getStringFromBorder(this.matrix.bordersY[e][r+o])),null!=this.matrix.cells[e][r]){var h=this.matrix.cells[e][r],w=h.cellStyle;a.BackColor=w.color,a.VertAlign=w.vertAlignment,a.FontName=w.font.name,a.FontSize=w.font.sizeInPoints,a.Bold=w.font.bold,a.Italic=w.font.italic,a.Underline=w.font.underline,a.FontColor=w.textColor,a.HorAlign=w.horAlignment;var u=0;if(null!=w.textOptions&&(u=w.textOptions.angle,a.Wordwrap=w.textOptions.wordWrap),a.Angle=0|Math.round(u),null!=h.component){var d=h.component.stimulsoft.as(m);null!=d&&(a.DataStyle=this.getDataStyleNumber(d));var S=h.component.stimulsoft.as(n);null==S||E.isNullOrEmpty(S.excelDataValue)||(a.FontName=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,a.FontSize=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints,a.Bold=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,a.Italic=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,a.Underline=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,a.VertAlign=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment,a.HorAlign=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment)}}if(this.cellStyleList.length>0)for(var c=0;c<this.cellStyleList.length;c++){var f=this.cellStyleList[c];if(f.BorderLeft==a.BorderLeft&&f.BorderRight==a.BorderRight&&f.BorderTop==a.BorderTop&&f.BorderBottom==a.BorderBottom&&f.BackColor.equals(a.BackColor)&&f.VertAlign==a.VertAlign&&f.FontName==a.FontName&&f.FontSize==a.FontSize&&f.Bold==a.Bold&&f.Italic==a.Italic&&f.Underline==a.Underline&&f.FontColor.equals(a.FontColor)&&f.HorAlign==a.HorAlign&&f.Angle==a.Angle&&f.Wordwrap==a.Wordwrap&&f.DataStyle==a.DataStyle)return c}return this.cellStyleList.push(a),this.cellStyleList.length-1},T.prototype.getStringFromBorder=function(t){return E.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))},T.prototype.getDataStyleNumber=function(t){var e=new A,n=t.format,o=null!=t&&t.hideZeros,a=null!=n?n.indexOf("|"):-1,s;if(-1!=a&&(e.CurrencyPositivePattern=r.StiExportUtils.getPositivePattern(n.charCodeAt(a+1)-65),e.CurrencyNegativePattern=r.StiExportUtils.getNegativePattern(n.charCodeAt(a+2)-65),n=n.substr(0,a)),E.isNullOrEmpty(n))return-1;if("C"==n.charAt(0)&&(e.isCurrency=!0),"N"==n.charAt(0)&&(e.isNumeric=!0),"P"==n.charAt(0)&&(e.isPercent=!0),"D"==n.charAt(0)&&(e.isDate=!0,n.length>1&&(e.DateTimeFormatString=n.substr(1))),"T"==n.charAt(0)&&(e.isTime=!0,n.length>1&&(e.DateTimeFormatString=n.substr(1))),1==n.length)e.isDefaultFormat=!0;else if(e.isCurrency||e.isNumeric||e.isPercent){var l=1;if(i.isDigit(n,l)){var m="";while(l<n.length&&i.isDigit(n,l))m+=n.charAt(l),l++;e.DecimalDigits=parseInt(m)}l<n.length&&"G"==n.charAt(l)&&(l++,e.GroupDigits=3),l<n.length&&"("==n.charAt(l)&&(l++,e.NegativeBraces=!0),l<n.length&&("."==n.charAt(l)||","==n.charAt(l))&&(e.DecimalComma=n.charAt(l),l++),l<n.length&&("+"==n.charAt(l)||"-"==n.charAt(l))&&("+"==n.charAt(l)&&(e.CurrencyPositionBefore=!0),++l<n.length&&(e.CurrencySymbol=n.substr(l)))}if(t.hideZeros&&!E.isNullOrEmpty(n)&&(e.isDefaultFormat=!1),this.dataStyleList.length>0)for(var c=0;c<this.dataStyleList.length;c++){var p=this.dataStyleList.stimulsoft.getByIndex(c);if(p.isNumeric==e.isNumeric&&p.isCurrency==e.isCurrency&&p.isPercent==e.isPercent&&p.isDate==e.isDate&&p.isTime==e.isTime&&p.isDefaultFormat==e.isDefaultFormat&&p.DecimalDigits==e.DecimalDigits&&p.DecimalComma==e.DecimalComma&&p.GroupDigits==e.GroupDigits&&p.CurrencySymbol==e.CurrencySymbol&&p.CurrencyPositionBefore==e.CurrencyPositionBefore&&p.DateTimeFormatString==e.DateTimeFormatString&&p.CurrencyPositivePattern==e.CurrencyPositivePattern&&p.CurrencyNegativePattern==e.CurrencyNegativePattern)return c}return this.dataStyleList.push(e),this.dataStyleList.stimulsoft.countItems-1},T.prototype.writeMimetype=function(){var t=new b,e=new f(t,S.ASCII);return e.write("application/vnd.oasis.opendocument.spreadsheet"),e.flush(),t},T.prototype.writeMeta=function(){var t=new b,e=new d(S.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?u.None:u.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");var i=w.now.toString("yyyy-MM-ddTHH:mm:ss"),n=r.StiExportUtils.getReportVersion();return e.writeElementString("meta:generator",n),e.writeElementString("meta:creation-date",i),e.writeElementString("dc:date",i),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M0S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:cell-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},T.prototype.writeManifest=function(){var t=new b,e=new d(S.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?u.None:u.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.spreadsheet"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(var r=0;r<this.imageCache.imagePackedStore.stimulsoft.countItems;r++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",E.format("Pictures/{0:D5}.jpg",r+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},T.prototype.writeImage=function(t){var e=new b,r=this.imageCache.imagePackedStore[t];return e.write(r,0,r.length),e},T.prototype.writeSettings=function(){var t=new b,e=new d(S.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?u.None:u.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("View1"),e.writeEndElement(),e.writeStartElement("config:config-item-map-named"),e.writeAttributeString("config:name","Tables"),e.writeStartElement("config:config-item-map-entry"),e.writeAttributeString("config:name","Sheet1"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveSplitRange"),e.writeAttributeString("config:type","short"),e.writeString("2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionLeft"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionRight"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionBottom"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveTable"),e.writeAttributeString("config:type","string"),e.writeString("Sheet1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalScrollbarWidth"),e.writeAttributeString("config:type","int"),e.writeString("270"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PageViewZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("60"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreakPreview"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","long"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("3"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AutoCalculate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},T.prototype.writeStyles=function(t){var e=new b,r=new d(S.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?u.None:u.Indented,r.writeStartDocument(),r.writeStartElement("office:document-styles"),r.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),r.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),r.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),r.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),r.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),r.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),r.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),r.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),r.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),r.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),r.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),r.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),r.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),r.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),r.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),r.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),r.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),r.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),r.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),r.writeAttributeString("office:version","1.1"),r.writeStartElement("office:font-face-decls"),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Arial"),r.writeAttributeString("svg:font-family","Arial"),r.writeEndElement(),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Tahoma"),r.writeAttributeString("svg:font-family","Tahoma"),r.writeAttributeString("style:font-family-generic","system"),r.writeAttributeString("style:font-pitch","variable"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("office:styles"),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","table-cell"),r.writeStartElement("style:table-cell-properties"),r.writeAttributeString("style:decimal-places","2"),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("style:tab-stop-distance","1.25cm"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("fo:language","ru"),r.writeAttributeString("fo:country","RU"),r.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),r.writeAttributeString("style:language-asian","zxx"),r.writeAttributeString("style:country-asian","none"),r.writeAttributeString("style:font-name-complex","Tahoma"),r.writeAttributeString("style:language-complex","zxx"),r.writeAttributeString("style:country-complex","none"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("number:number-style"),r.writeAttributeString("style:name","N0"),r.writeStartElement("number:number"),r.writeAttributeString("number:min-integer-digits","1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Default"),r.writeAttributeString("style:family","table-cell"),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Result"),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Default"),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("style:text-underline-style","solid"),r.writeAttributeString("style:text-underline-width","auto"),r.writeAttributeString("style:text-underline-color","font-color"),r.writeAttributeString("fo:font-weight","bold"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Heading"),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Default"),r.writeStartElement("style:table-cell-properties"),r.writeAttributeString("style:text-align-source","fix"),r.writeAttributeString("style:repeat-content","false"),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:text-align","center"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:font-size","16pt"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("fo:font-weight","bold"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Heading1"),r.writeAttributeString("style:family","table-cell"),r.writeAttributeString("style:parent-style-name","Heading"),r.writeStartElement("style:table-cell-properties"),r.writeAttributeString("style:rotation-angle","90"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("office:automatic-styles");var i=t.getByIndex(0),n=i.unit.convertToHInches(i.pageHeight*i.segmentPerHeight),o=i.unit.convertToHInches(i.pageWidth*i.segmentPerWidth),a=i.unit.convertToHInches(i.margins.left),s=i.unit.convertToHInches(i.margins.right),l=i.unit.convertToHInches(i.margins.top),m=i.unit.convertToHInches(i.margins.bottom)-4;return m<0&&(m=0),r.writeStartElement("style:page-layout"),r.writeAttributeString("style:name","pm1"),r.writeStartElement("style:page-layout-properties"),r.writeAttributeString("fo:page-width",this.doubleToString(o)),r.writeAttributeString("fo:page-height",this.doubleToString(n)),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("style:print-orientation",i.orientation==g.Portrait?"portrait":"landscape"),r.writeAttributeString("fo:margin-top",this.doubleToString(l)),r.writeAttributeString("fo:margin-bottom",this.doubleToString(m)),r.writeAttributeString("fo:margin-left",this.doubleToString(a)),r.writeAttributeString("fo:margin-right",this.doubleToString(s)),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeEndElement(),r.writeStartElement("style:header-style"),r.writeStartElement("style:header-footer-properties"),r.writeAttributeString("fo:min-height","0.101cm"),r.writeAttributeString("fo:margin-left","0cm"),r.writeAttributeString("fo:margin-right","0cm"),r.writeAttributeString("fo:margin-bottom","0cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:footer-style"),r.writeStartElement("style:header-footer-properties"),r.writeAttributeString("fo:min-height","0.101cm"),r.writeAttributeString("fo:margin-left","0cm"),r.writeAttributeString("fo:margin-right","0cm"),r.writeAttributeString("fo:margin-top","0cm"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("office:master-styles"),r.writeStartElement("style:master-page"),r.writeAttributeString("style:name","Default"),r.writeAttributeString("style:page-layout-name","pm1"),r.writeStartElement("style:header"),r.writeAttributeString("style:display","false"),r.writeStartElement("text:p"),r.writeStartElement("text:sheet-name"),r.writeString("Sheet1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:header-left"),r.writeAttributeString("style:display","false"),r.writeEndElement(),r.writeStartElement("style:footer"),r.writeAttributeString("style:display","false"),r.writeStartElement("text:p"),r.writeString("Page "),r.writeStartElement("text:page-number"),r.writeString("1"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:footer-left"),r.writeAttributeString("style:display","false"),r.writeEndElement(),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},T.prototype.writeContent=function(e,i){var n,o,a,s,l=new b,m=new d(S.UTF8,l);m.indentation=this.xmlIndentation<0?0:this.xmlIndentation,m.formatting=this.xmlIndentation<0?u.None:u.Indented,m.writeStartDocument(),m.writeStartElement("office:document-content"),m.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),m.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),m.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),m.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),m.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),m.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),m.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),m.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),m.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),m.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),m.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),m.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),m.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),m.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),m.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),m.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),m.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),m.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),m.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),m.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),m.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),m.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),m.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),m.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),m.writeAttributeString("office:version","1.1");var g=0;while(g<i.count){var w=new h(e,i);w.addV2Internal(i.getByIndex(g));var f=g,v=i.getByIndex(g).excelSheetValue;while(g<i.count-1&&i.getByIndex(g+1).excelSheetValue==v)g++,w.addV2Internal(i.getByIndex(g));w.cacheMode=e.renderedPages.cacheMode;var y=w.getByIndex(0).excelSheetValue;E.isNullOrEmpty(y)&&(y=E.format("Page {0}",this.sheetNameList.stimulsoft.countItems+1));var x="",A=1;if(this.matrix=new r.StiMatrix(w,t["StiOptions"].Export.OpenDocumentCalc.divideBigCells,this),this.isStopped)return null;var T=0;do{var P;if(this.firstPageIndexList.push(f),this.matrixList.push(this.matrix),(P=this.matrix.coordY.countItems-1)-T>t["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight?P=T+t["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight:this.matrix=null,this.minRowList.push(T),this.maxRowList.push(P),T=P,(null!=this.matrix||x.length>0)&&(x=E.format(" part{0}",A++)),this.sheetNameList.push(y+x),this.isStopped)return null}while(null!=this.matrix);g++}for(var L=new p,C=new p,F=new p,B=new p,k=0;k<this.matrixList.stimulsoft.countItems;k++){this.matrix=this.matrixList.stimulsoft.getByIndex(k);for(var T=this.minRowList.stimulsoft.getByIndex(k),P=this.maxRowList.stimulsoft.getByIndex(k),R=c.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),I=c.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),D=0;D<this.matrix.coordX.countItems-1;D++){var N=this.matrix.coordX.getByIndex(D+1)-this.matrix.coordX.getByIndex(D);if(!F.containsKey(N)){var O=F.count;F.set(N,O),B.set(O,N)}}for(var H=T+1;H<P+1;H++){var M=this.matrix.coordY.getByIndex(H)-this.matrix.coordY.getByIndex(H-1);if(!L.containsKey(M)){var O=L.count;L.set(M,O),C.set(O,M)}for(var D=1;D<this.matrix.coordX.countItems;D++){var W=this.matrix.cells[H-1][D-1];if(!R[H][D])if(null!=W){for(var U=0;U<=W.height;U++)for(var X=0;X<=W.width;X++)R[H+U][D+X]=!0;I[H-1][D-1]=this.getCellStyleNumber(H-1,D-1,W.height+1,W.width+1)}else I[H-1][D-1]=this.getCellStyleNumber(H-1,D-1,1,1)}}this.cellStyleTableList.push(I)}m.writeStartElement("office:scripts"),m.writeEndElement();var z=new p;try{for(var V=__values(this.cellStyleList),G=V.next();!G.done;G=V.next()){var Y=G.value;z.set(Y.FontName,Y.FontName)}}catch(t){n={error:t}}finally{try{G&&!G.done&&(o=V.return)&&o.call(V)}finally{if(n)throw n.error}}m.writeStartElement("office:font-face-decls");try{for(var j=__values(z.keys),_=j.next();!_.done;_=j.next()){var q=_.value,K=z.get(q);m.writeStartElement("style:font-face"),m.writeAttributeString("style:name",K),m.writeAttributeString("svg:font-family",K),m.writeEndElement()}}catch(t){a={error:t}}finally{try{_&&!_.done&&(s=j.return)&&s.call(j)}finally{if(a)throw a.error}}m.writeEndElement(),m.writeStartElement("office:automatic-styles");for(var D=0;D<F.count;D++){m.writeStartElement("style:style"),m.writeAttributeString("style:name",E.format("co{0}",D+1)),m.writeAttributeString("style:family","table-column"),m.writeStartElement("style:table-column-properties"),m.writeAttributeString("fo:break-before","auto");var N=B.get(D);m.writeAttributeString("style:column-width",this.doubleToString(N)),m.writeEndElement(),m.writeEndElement()}for(var H=0;H<L.count;H++){m.writeStartElement("style:style"),m.writeAttributeString("style:name",E.format("ro{0}",H+1)),m.writeAttributeString("style:family","table-row"),m.writeStartElement("style:table-row-properties");var M=C.get(H);m.writeAttributeString("style:row-height",this.doubleToString(M)),m.writeAttributeString("fo:break-before","auto"),m.writeAttributeString("style:use-optimal-row-height","false"),m.writeEndElement(),m.writeEndElement()}m.writeStartElement("style:style"),m.writeAttributeString("style:name","ta1"),m.writeAttributeString("style:family","table"),m.writeAttributeString("style:master-page-name","Default"),m.writeStartElement("style:table-properties"),m.writeAttributeString("table:display","true"),m.writeAttributeString("style:writing-mode","lr-tb"),m.writeEndElement(),m.writeEndElement(),m.writeStartElement("style:style"),m.writeAttributeString("style:name","gr1"),m.writeAttributeString("style:family","graphic"),m.writeStartElement("style:graphic-properties"),m.writeAttributeString("draw:stroke","none"),m.writeAttributeString("draw:fill","none"),m.writeAttributeString("draw:textarea-horizontal-align","center"),m.writeAttributeString("draw:textarea-vertical-align","middle"),m.writeAttributeString("draw:color-mode","standard"),m.writeAttributeString("draw:luminance","0%"),m.writeAttributeString("draw:contrast","0%"),m.writeAttributeString("draw:gamma","100%"),m.writeAttributeString("draw:red","0%"),m.writeAttributeString("draw:green","0%"),m.writeAttributeString("draw:blue","0%"),m.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),m.writeAttributeString("draw:image-opacity","100%"),m.writeAttributeString("style:mirror","none"),m.writeEndElement(),m.writeEndElement(),m.writeStartElement("style:style"),m.writeAttributeString("style:name","P1"),m.writeAttributeString("style:family","paragraph"),m.writeStartElement("style:paragraph-properties"),m.writeAttributeString("fo:text-align","center"),m.writeEndElement(),m.writeEndElement();for(var Q=0;Q<this.dataStyleList.stimulsoft.countItems;Q++){var J;(J=this.dataStyleList.stimulsoft.getByIndex(Q)).isNumeric&&(m.writeStartElement("number:number-style"),J.NegativeBraces?(m.writeAttributeString("style:name",E.format("N{0}P0",Q+1)),m.writeAttributeString("style:volatile","true")):m.writeAttributeString("style:name",E.format("N{0}",Q+1))," "!=J.DecimalComma&&(m.writeAttributeString("number:language",","==J.DecimalComma?"ru":"en"),m.writeAttributeString("number:country",","==J.DecimalComma?"RU":"US")),m.writeStartElement("number:number"),m.writeAttributeString("number:decimal-places",J.DecimalDigits.toString()),m.writeAttributeString("number:min-integer-digits","1"),m.writeAttributeString("number:grouping",3==J.GroupDigits?"true":"false"),m.writeEndElement(),m.writeEndElement(),J.NegativeBraces&&(m.writeStartElement("number:number-style"),m.writeAttributeString("style:name",E.format("N{0}",Q+1))," "!=J.DecimalComma&&(m.writeAttributeString("number:language",","==J.DecimalComma?"ru":"en"),m.writeAttributeString("number:country",","==J.DecimalComma?"RU":"US")),m.writeElementString("number:text","("),m.writeStartElement("number:number"),m.writeAttributeString("number:decimal-places",J.DecimalDigits.toString()),m.writeAttributeString("number:min-integer-digits","1"),m.writeAttributeString("number:grouping",3==J.GroupDigits?"true":"false"),m.writeEndElement(),m.writeElementString("number:text",")"),m.writeStartElement("style:map"),m.writeAttributeString("style:condition","value()>=0"),m.writeAttributeString("style:apply-style-name",E.format("N{0}P0",Q+1)),m.writeEndElement(),m.writeEndElement())),J.isPercent&&(m.writeStartElement("number:percentage-style"),m.writeAttributeString("style:name",E.format("N{0}",Q+1))," "!=J.DecimalComma&&(m.writeAttributeString("number:language",","==J.DecimalComma?"ru":"en"),m.writeAttributeString("number:country",","==J.DecimalComma?"RU":"US")),m.writeStartElement("number:number"),m.writeAttributeString("number:decimal-places",J.DecimalDigits.toString()),m.writeAttributeString("number:min-integer-digits","1"),3==J.GroupDigits&&m.writeAttributeString("number:grouping","true"),m.writeEndElement(),m.writeElementString("number:text","%"),m.writeEndElement()),J.isCurrency&&(m.writeStartElement("number:currency-style"),m.writeAttributeString("style:name",E.format("N{0}",Q+1))," "!=J.DecimalComma&&(m.writeAttributeString("number:language",","==J.DecimalComma?"ru":"en"),m.writeAttributeString("number:country",","==J.DecimalComma?"RU":"US")),J.CurrencyPositionBefore&&m.writeElementString("number:currency-symbol",J.CurrencySymbol),m.writeStartElement("number:number"),m.writeAttributeString("number:decimal-places",J.DecimalDigits.toString()),m.writeAttributeString("number:min-integer-digits","1"),m.writeAttributeString("number:grouping",3==J.GroupDigits?"true":"false"),m.writeEndElement(),J.CurrencyPositionBefore||m.writeElementString("number:currency-symbol",J.CurrencySymbol),m.writeEndElement()),J.isDate&&(m.writeStartElement("number:date-style"),m.writeAttributeString("style:name",E.format("N{0}",Q+1)),this.writeDateTimeFormatString(m,J.DateTimeFormatString,"d"),m.writeEndElement()),J.isTime&&(m.writeStartElement("number:time-style"),m.writeAttributeString("style:name",E.format("N{0}",Q+1)),E.isNullOrEmpty(J.DateTimeFormatString)||-1==J.DateTimeFormatString.indexOf("h")||(m.writeAttributeString("number:language","en"),m.writeAttributeString("number:country","US")),this.writeDateTimeFormatString(m,J.DateTimeFormatString,"t"),m.writeEndElement())}for(var Q=0;Q<this.cellStyleList.stimulsoft.countItems;Q++){var J=this.cellStyleList.stimulsoft.getByIndex(Q);m.writeStartElement("style:style"),m.writeAttributeString("style:name",E.format("ce{0}",Q+1)),m.writeAttributeString("style:family","table-cell"),m.writeAttributeString("style:parent-style-name","Default"),-1!=J.DataStyle&&m.writeAttributeString("style:data-style-name",E.format("N{0}",J.DataStyle+1)),m.writeStartElement("style:table-cell-properties"),J.BackColor.a>0?m.writeAttributeString("fo:background-color",this.getColorString(J.BackColor)):m.writeAttributeString("fo:background-color","transparent"),J.VertAlign==StiVertAlignment.Center&&m.writeAttributeString("style:vertical-align","middle"),J.VertAlign==StiVertAlignment.Top&&m.writeAttributeString("style:vertical-align","top"),m.writeAttributeString("style:text-align-source","fix"),m.writeAttributeString("style:repeat-content","false"),J.Wordwrap&&m.writeAttributeString("fo:wrap-option","wrap"),m.writeAttributeString("fo:padding","0in"),m.writeAttributeString("fo:border-left",J.BorderLeft),m.writeAttributeString("fo:border-right",J.BorderRight),m.writeAttributeString("fo:border-top",J.BorderTop),m.writeAttributeString("fo:border-bottom",J.BorderBottom),0!=J.Angle&&(m.writeAttributeString("style:rotation-angle",J.Angle.toString()),m.writeAttributeString("style:rotation-align","none")),m.writeEndElement(),m.writeStartElement("style:paragraph-properties"),J.HorAlign==StiTextHorAlignment.Left&&m.writeAttributeString("fo:text-align","start"),J.HorAlign==StiTextHorAlignment.Center&&m.writeAttributeString("fo:text-align","center"),J.HorAlign==StiTextHorAlignment.Right&&m.writeAttributeString("fo:text-align","end"),J.HorAlign==StiTextHorAlignment.Width&&m.writeAttributeString("fo:text-align","justify"),m.writeAttributeString("fo:margin-left","0cm"),m.writeEndElement(),m.writeStartElement("style:text-properties"),m.writeAttributeString("fo:color",this.getColorString(J.FontColor)),m.writeAttributeString("style:font-name",J.FontName);var Z=E.format("{0}pt",J.FontSize).stimulsoft.replaceAll(",",".");m.writeAttributeString("fo:font-size",Z),m.writeAttributeString("fo:font-size-asian",Z),m.writeAttributeString("fo:font-size-complex",Z),J.Italic&&(m.writeAttributeString("fo:font-style","italic"),m.writeAttributeString("fo:font-style-asian","italic"),m.writeAttributeString("fo:font-style-complex","italic")),J.Underline&&(m.writeAttributeString("style:text-underline-style","solid"),m.writeAttributeString("style:text-underline-width","auto"),m.writeAttributeString("style:text-underline-color","font-color")),J.Bold&&(m.writeAttributeString("fo:font-weight","bold"),m.writeAttributeString("fo:font-weight-asian","bold"),m.writeAttributeString("fo:font-weight-complex","bold")),m.writeEndElement(),m.writeEndElement()}m.writeFullEndElement(),m.writeStartElement("office:body"),m.writeStartElement("office:spreadsheet"),m.writeStartElement("table:calculation-settings"),m.writeAttributeString("table:use-regular-expressions","false"),m.writeEndElement(),this.currentPassNumber=t["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?3:2;for(var k=0;k<this.matrixList.stimulsoft.countItems;k++)this.writeTableFromMatrix(m,k,L,F);return m.writeEndElement(),m.writeEndElement(),m.writeFullEndElement(),m.writeEndDocument(),m.flush(),l},T.prototype.writeDateTimeFormatString=function(t,e,r){if(E.isNullOrEmpty(e)&&(e=r),1==e.length){var i=this.currentCulture.dateTimeFormat;switch(e){case"d":e=i.shortDatePattern;break;case"D":e=i.longDatePattern;break;case"f":e=i.shortDatePattern+" "+i.shortTimePattern;break;case"F":e=i.fullDateTimePattern;break;case"g":e=i.shortDatePattern+" "+i.shortTimePattern;break;case"G":e=i.shortDatePattern+" "+i.longTimePattern;break;case"m":case"M":e=o.currentCulture.name.stimulsoft.contains("en")||o.currentCulture.name.stimulsoft.contains("us")?"MMMM d":"d MMMM";break;case"r":case"R":e="ddd, dd MMM yyyy HH\\:mm\\:ss \\G\\M\\T";break;case"s":e="yyyy\\-MM\\-dd\\THH\\:mm\\:ss";break;case"t":e=i.shortTimePattern;break;case"T":e=i.longTimePattern;break;case"u":e="yyyy\\-MM\\-dd HH\\:mm\\:ss\\Z";break;case"U":e=i.fullDateTimePattern;break;case"y":case"Y":e=i.yearMonthPattern;break}e=e.stimulsoft.replaceAll('"',"").stimulsoft.replaceAll("'","")}var n=0;while(n<e.length){var a=e.charAt(n),s=1;while(n+1<e.length&&e.charAt(n+1)==a)n++,s++;switch(n++,a){case"d":1==s&&(t.writeStartElement("number:day"),t.writeEndElement()),2==s&&(t.writeStartElement("number:day"),t.writeAttributeString("number:style","long"),t.writeEndElement()),3==s&&(t.writeStartElement("number:day-of-week"),t.writeEndElement()),4==s&&(t.writeStartElement("number:day-of-week"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"M":1==s&&(t.writeStartElement("number:month"),t.writeEndElement()),2==s&&(t.writeStartElement("number:month"),t.writeAttributeString("number:style","long"),t.writeEndElement()),3==s&&(t.writeStartElement("number:month"),t.writeAttributeString("number:textual","true"),t.writeEndElement()),4==s&&(t.writeStartElement("number:month"),t.writeAttributeString("number:style","long"),t.writeAttributeString("number:textual","true"),t.writeEndElement());break;case"y":1!=s&&2!=s||(t.writeStartElement("number:year"),t.writeEndElement()),3!=s&&4!=s||(t.writeStartElement("number:year"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"s":1==s&&(t.writeStartElement("number:seconds"),t.writeEndElement()),2==s&&(t.writeStartElement("number:seconds"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"m":1==s&&(t.writeStartElement("number:minutes"),t.writeEndElement()),2==s&&(t.writeStartElement("number:minutes"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"h":case"H":1==s&&(t.writeStartElement("number:hours"),t.writeEndElement()),2==s&&(t.writeStartElement("number:hours"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;default:t.writeElementString("number:text",a);break}}},T.prototype.writeTableFromMatrix=function(t,i,o,a){var s=this.matrixList[i],p=this.minRowList[i],g=this.maxRowList[i],h=this.cellStyleTableList[i],u=this.sheetNameList[i],d=c.create2(Boolean,s.coordY.countItems,s.coordX.countItems);t.writeStartElement("table:table"),t.writeAttributeString("table:name",u),t.writeAttributeString("table:style-name","ta1"),t.writeAttributeString("table:print","false");for(var S=0;S<s.coordX.countItems-1;S++){var f=s.coordX.getByIndex(S+1)-s.coordX.getByIndex(S),v=a.get(f);t.writeStartElement("table:table-column"),t.writeAttributeString("table:style-name",E.format("co{0}",v+1)),t.writeAttributeString("table:default-cell-style-name","Default"),t.writeEndElement()}for(var b=Math.max(s.coordY.countItems/200,1),y=0,x=p+1;x<g+1;x++){var A=x/b|0;A>y&&(y=A,this.invokeExporting2(x,s.coordY.countItems,this.currentPassNumber,this.maximumPassNumber));var T=s.coordY.getByIndex(x)-s.coordY.getByIndex(x-1),P=o.get(T);t.writeStartElement("table:table-row"),t.writeAttributeString("table:style-name",E.format("ro{0}",P+1));for(var S=1;S<s.coordX.countItems;S++){var L=s.cells[x-1][S-1];if(d[x][S])t.writeStartElement("table:covered-table-cell"),t.writeEndElement();else if(null!=L){for(var C=0;C<=L.height;C++)for(var F=0;F<=L.width;F++)d[x+C][S+F]=!0;var B=h[x-1][S-1],k=this.cellStyleList[B].DataStyle;t.writeStartElement("table:table-cell"),t.writeAttributeString("table:style-name",E.format("ce{0}",B+1)),(L.width>0||L.height>0)&&(t.writeAttributeString("table:number-columns-spanned",(L.width+1).toString()),t.writeAttributeString("table:number-rows-spanned",(L.height+1).toString()));var R=L.component.stimulsoft.as(m),I=L.text,D=L.component.stimulsoft.as(n);if(null==D||E.isNullOrEmpty(D.excelDataValue)||(I=D.excelDataValue),!L.component.isExportAsImage(e.StiExportFormat.Ods)&&(!E.isNullOrEmpty(I)||null!=R&&null!=R.excelDataValue)){var N=!1,O=0,H=w.now,M=null;if(-1!=k&&null!=R&&null!=R.excelDataValue&&"-"!=R.excelDataValue){var W,U=(W=R.excelDataValue).replace(/[^\d.,-]/g,"").stimulsoft.replaceAll(",",".");M=this.dataStyleList[k],N=!0;try{if(M.isDate||M.isTime){var X=w.tryParseExact(W,[null]);X.successfully?H=X.result:N=!1}else O=parseFloat(U),isNaN(O)&&(N=!1,O=0)}catch(t){N=!1}N||null!=I||(I=W)}if(N)if(M.isDate)t.writeAttributeString("office:value-type","date"),t.writeAttributeString("office:date-value",H.toString("yyyy-MM-dd"));else if(M.isTime)t.writeAttributeString("office:value-type","time"),t.writeAttributeString("office:time-value",H.toString("PTHH\\Hmm\\Mss\\S"));else{var W=O.toString().stimulsoft.replaceAll(",",".");M.isNumeric&&t.writeAttributeString("office:value-type","float"),M.isPercent&&t.writeAttributeString("office:value-type","percentage"),M.isCurrency&&t.writeAttributeString("office:value-type","currency"),t.writeAttributeString("office:value",W)}else t.writeAttributeString("office:value-type","string");for(var z=r.StiExportUtils.splitString(I,!0),V=0;V<z.length;V++){var G=z[V];t.writeStartElement("text:p"),t.writeString(G),t.writeEndElement()}}if(L.component.isExportAsImage(e.StiExportFormat.Ods)){t.writeAttributeString("office:value-type","string");var Y=L.component.stimulsoft.as(l);if(null!=Y){var j=null,_={ref:this.imageResolution};if(null!=(j=Y.getImage(_,e.StiExportFormat.Ods))){var q=s.getRealImageData(L,j);null!=q&&(j=q);var K=this.imageCache.addImageInt(j),Q=s.coordX.getByIndex(S+L.width)-s.coordX.getByIndex(S-1),J=s.coordY.getByIndex(x+L.height)-s.coordY.getByIndex(x-1),Z=E.format("'{0}'.{1}{2}",u,this.getColumnName(L.left+L.width+1),L.top+L.height+1+1);t.writeStartElement("draw:frame"),t.writeAttributeString("table:end-cell-address",Z),t.writeAttributeString("table:end-x","0in"),t.writeAttributeString("table:end-y","0in"),t.writeAttributeString("draw:z-index","0"),t.writeAttributeString("draw:name",E.format("Picture{0}",K+1)),t.writeAttributeString("draw:style-name","gr1"),t.writeAttributeString("draw:text-style-name","P1"),t.writeAttributeString("text:anchor-type","paragraph"),t.writeAttributeString("svg:x",this.doubleToString(0)),t.writeAttributeString("svg:y",this.doubleToString(0)),t.writeAttributeString("svg:width",this.doubleToString(Q)),t.writeAttributeString("svg:height",this.doubleToString(J)),t.writeStartElement("draw:image"),t.writeAttributeString("xlink:href",E.format("Pictures/{0:D5}.jpg",K+1)),t.writeAttributeString("xlink:type","simple"),t.writeAttributeString("xlink:show","embed"),t.writeAttributeString("xlink:actuate","onLoad"),t.writeStartElement("text:p"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement()}}}t.writeEndElement()}else{var B=h[x-1][S-1];t.writeStartElement("table:table-cell"),t.writeAttributeString("table:style-name",E.format("ce{0}",B+1)),t.writeEndElement()}}t.writeEndElement()}t.writeEndElement()},T.prototype.exportOds=function(i,n,l){var m,c;if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to ODT format"),null==l)throw new Error("The 'settings' argument cannot be equal in null.");var p=l.pageRange;this.imageResolution=l.imageResolution,this.imageQuality=l.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=o.currentCulture;try{o.currentCulture=o.cultures["en-US"],this.imageCache=new e.StiImageCache(t["StiOptions"].Export.OpenDocumentCalc.allowImageComparer,!0,s.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.dataStyleList=[],this.sheetNameList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.cellStyleTableList=[],this.currentPassNumber=0,this.maximumPassNumber=t["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?4:3;var g=p.getSelectedPages(i.renderedPages);if(t["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages&&(g=r.StiSegmentPagesDivider.divide(g,this),this.currentPassNumber=1),this.isStopped)return;var h=new a;if(h.begin(n,!0),h.addFile("content.xml",this.writeContent(i,g)),h.addFile("mimetype",this.writeMimetype()),h.addFile("meta.xml",this.writeMeta()),h.addFile("META-INF/manifest.xml",this.writeManifest()),h.addFile("settings.xml",this.writeSettings()),h.addFile("styles.xml",this.writeStyles(g)),this.imageCache.imagePackedStore.stimulsoft.countItems>0)for(var w=0;w<this.imageCache.imagePackedStore.stimulsoft.countItems;w++)h.addFile(E.format("Pictures/{0:D5}.jpg",w+1),this.writeImage(w));h.end()}finally{o.currentCulture=this.currentCulture,this.sheetNameList.stimulsoft.clear(),this.sheetNameList=null,this.firstPageIndexList.stimulsoft.clear(),this.firstPageIndexList=null,this.minRowList.stimulsoft.clear(),this.minRowList=null,this.maxRowList.stimulsoft.clear(),this.maxRowList=null;try{for(var u=__values(this.matrixList),d=u.next();!d.done;d=u.next()){var S=d.value;null!=S&&S.clear()}}catch(t){m={error:t}}finally{try{d&&!d.done&&(c=u.return)&&c.call(u)}finally{if(m)throw m.error}}this.matrixList.stimulsoft.clear(),this.matrixList=null,this.cellStyleTableList.stimulsoft.clear(),this.cellStyleTableList=null,this.dataStyleList.stimulsoft.clear(),this.dataStyleList=null,this.cellStyleList.stimulsoft.clear(),this.cellStyleList=null,this.imageCache.clear(),this.imageCache=null,i.renderedPages.cacheMode&&r.StiMatrix.GCCollect()}},T}(r.StiExportService);r.StiOdsExportService=T}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.System.StiArray,n=t.Base.Zip.StiZipWriter20,o=t.Report.ImageFormat,a=t.Report.Components.IStiExportImageExtended,s=t.Report.Components.StiText,l=t.System.Collections.Hashtable,m=t.Report.Components.StiPageOrientation,c=t.System.DateTime,p=t.System.Xml.Formatting,g=t.System.Xml.XmlTextWriter,h=t.System.Text.Encoding,w=t.System.IO.StreamWriter,u=t.System.Drawing.Color,d=t.System.StiString,S=t.System.IO.MemoryStream,f=t.Base.Localization.StiLocalization,v=function(){function t(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=u.transparent,this.VertAlign=StiVertAlignment.Bottom}return t}(),E=function(){function t(){this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=u.black,this.HorAlign=StiTextHorAlignment.Left,this.Angle=0}return t}(),b=function(u){function b(){var e=null!==u&&u.apply(this,arguments)||this;return e._matrix=null,e._removeEmptySpaceAtBottom=t["StiOptions"].Export.OpenDocumentWriter.removeEmptySpaceAtBottom,e.imageCache=null,e.cellStyleList=null,e.paragraphStyleList=null,e.xmlIndentation=1,e.imageQuality=.75,e.imageResolution=96,e.usePageHeadersAndFooters=!1,e}return __extends(b,u),b.prototype.implements=function(){return[r.IStiOdtExportService]},Object.defineProperty(b.prototype,"defaultExtension",{get:function(){return"odt"},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Odt},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"position",{get:function(){return r.StiExportPosition.Odt},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"exportNameInMenu",{get:function(){return f.get("Export","ExportTypeWriterFile")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),b.prototype.getFilter=function(){return f.get("FileFilters","WriterFiles")},b.prototype.exportTo=function(t,e,r){this.exportOdt(t,e,r)},b.prototype.exportToAsync=function(e,r,i,n){var o=this;t.Report.Export.StiExportImageHelper.convertAllImages(r,t.System.Drawing.Imaging.ImageFormat.Jpeg).try((function(){o.exportTo(r,i,n),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null),e()}))},Object.defineProperty(b.prototype,"matrix",{get:function(){return this._matrix},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"removeEmptySpaceAtBottom",{get:function(){return this._removeEmptySpaceAtBottom},enumerable:!1,configurable:!0}),b.prototype.doubleToString=function(t){return Math.round2(t/100,4).toString().stimulsoft.replaceAll(",",".")+"in"},b.prototype.getColumnName=function(t){var e=t/26|0,r=t%26,i="";return e>0&&(i+=String.fromCharCode(65+e-1)),i+=String.fromCharCode(65+r)},b.prototype.getColorString=function(t){return"#"+d.format("{0:X8}",t.toArgb()).substr(2)},b.prototype.getCellStyleNumber=function(t,e,r,i){for(var n=new v,o=!0,a=!0,s=0;s<r;s++)null==this.matrix.bordersY[t+s][e]&&(o=!1),null==this.matrix.bordersY[t+s][e+i]&&(a=!1);for(var l=!0,m=!0,s=0;s<i;s++)null==this.matrix.bordersX[t][e+s]&&(l=!1),null==this.matrix.bordersX[t+r][e+s]&&(m=!1);if(l&&(n.BorderTop=this.getStringFromBorder(this.matrix.bordersX[t][e])),o&&(n.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[t][e])),m&&(n.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[t+r][e])),a&&(n.BorderRight=this.getStringFromBorder(this.matrix.bordersY[t][e+i])),null!=this.matrix.cells[t][e]){var c=this.matrix.cells[t][e];if(n.BackColor=c.cellStyle.color,n.VertAlign=c.cellStyle.vertAlignment,null!=c.cellStyle.textOptions){var p=c.cellStyle.textOptions.angle;(p>45&&p<135||p>225&&p<315)&&(c.cellStyle.horAlignment==StiTextHorAlignment.Left&&(n.VertAlign=StiVertAlignment.Bottom),c.cellStyle.horAlignment==StiTextHorAlignment.Center&&(n.VertAlign=StiVertAlignment.Center),c.cellStyle.horAlignment==StiTextHorAlignment.Right&&(n.VertAlign=StiVertAlignment.Top),c.cellStyle.horAlignment==StiTextHorAlignment.Width&&(n.VertAlign=StiVertAlignment.Bottom))}}if(this.cellStyleList.length>0)for(var s=0;s<this.cellStyleList.length;s++){var g=this.cellStyleList[s];if(g.BorderLeft==n.BorderLeft&&g.BorderRight==n.BorderRight&&g.BorderTop==n.BorderTop&&g.BorderBottom==n.BorderBottom&&g.BackColor.equals(n.BackColor)&&g.VertAlign==n.VertAlign)return s}var h;return this.cellStyleList.push(n),this.cellStyleList.length-1},b.prototype.getStringFromBorder=function(t){return d.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))},b.prototype.getParagraphStyleNumber=function(t,e){var r=this.matrix.cells[t][e].cellStyle,i=new E;i.FontName=r.font.name,i.FontSize=r.font.sizeInPoints,i.Bold=r.font.bold,i.Italic=r.font.italic,i.Underline=r.font.underline,i.FontColor=r.textColor,i.HorAlign=r.horAlignment;var n=0,o;if(null!=r.textOptions&&(n=r.textOptions.angle),n>45&&n<135&&(i.Angle=90),n>225&&n<315&&(i.Angle=270),0!=i.Angle&&(r.vertAlignment==StiVertAlignment.Top&&(i.HorAlign=StiTextHorAlignment.Left),r.vertAlignment==StiVertAlignment.Center&&(i.HorAlign=StiTextHorAlignment.Center),r.vertAlignment==StiVertAlignment.Bottom&&(i.HorAlign=StiTextHorAlignment.Right)),this.paragraphStyleList.length>0)for(var a=0;a<this.paragraphStyleList.length;a++){var s=this.paragraphStyleList[a];if(s.FontName==i.FontName&&s.FontSize==i.FontSize&&s.Bold==i.Bold&&s.Italic==i.Italic&&s.Underline==i.Underline&&s.FontColor.equals(i.FontColor)&&s.HorAlign==i.HorAlign&&s.Angle==i.Angle)return a}return this.paragraphStyleList.push(i),this.paragraphStyleList.length-1},b.prototype.writeMimetype=function(){var t=new S,e=new w(t,h.ASCII);return e.write("application/vnd.oasis.opendocument.text"),e.flush(),t},b.prototype.writeMeta=function(){var t=new S,e=new g(h.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");var r=d.format("{0}",c.now.toString("yyyy-MM-ddTHH:mm:ss"));return e.writeElementString("meta:generator","Stimulsoft Reports"),e.writeElementString("meta:creation-date",r),e.writeElementString("dc:date",r),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M01S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:image-count","0"),e.writeAttributeString("meta:object-count","0"),e.writeAttributeString("meta:page-count","1"),e.writeAttributeString("meta:paragraph-count","1"),e.writeAttributeString("meta:word-count","1"),e.writeAttributeString("meta:character-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},b.prototype.writeManifest=function(){var t=new S,e=new g(h.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.text"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(var r=0;r<this.imageCache.imagePackedStore.stimulsoft.countItems;r++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",d.format("Pictures/{0:D5}.jpg",r+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},b.prototype.writeImage=function(t){var e=new S,r=this.imageCache.imagePackedStore[t];return e.write(r,0,r.length),e},b.prototype.writeSettings=function(){var t=new S,e=new g(h.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?p.None:p.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowRedlineChanges"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","InBrowseMode"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("view2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewLeft"),e.writeAttributeString("config:type","int"),e.writeString("3002"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewTop"),e.writeAttributeString("config:type","int"),e.writeString("10435"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleRight"),e.writeAttributeString("config:type","int"),e.writeString("33099"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleBottom"),e.writeAttributeString("config:type","int"),e.writeString("22172"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomFactor"),e.writeAttributeString("config:type","short"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSelectedFrame"),
e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintReversed"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","OutlineLevelYieldsNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintEmptyPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreFirstLineIndentInNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintSingleJobs"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPaperFromSetup"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddFrameOffsets"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintLeftPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RedlineProtectionKey"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintTables"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ChartAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintControls"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreTabsAndBlanksForLineCalculation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintAnnotationMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaSpacingToTableCells"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddExternalLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","FieldAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveGlobalDocumentLinks"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AlignTabStopPosition"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ClipAsCharacterAnchoredWriterFlyFrames"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseDataSource"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotCaptureDrawObjsOnPage"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","TableRowKeep"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintFaxName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ConsiderTextWrapOnObjPos"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldPrinterMetrics"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintRightPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsLabelDocument"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerLineSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacingAtStart"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerTextWrapping"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotResetParaAttrsForNumFont"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintProspect"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintGraphics"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommandType"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotJustifyLinesWithManualBreak"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerObjectPositioning"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterIndependentLayout"),e.writeAttributeString("config:type","string"),e.writeString("high-resolution"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPageBackground"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommand"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintDrawings"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintBlackFonts"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UnxForceZeroExtLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t},b.prototype.writeStyles=function(t){var e=new S,r=new g(h.UTF8,e);r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?p.None:p.Indented,r.writeStartDocument(),r.writeStartElement("office:document-styles"),r.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),r.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),r.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),r.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),r.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),r.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),r.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),r.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),r.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),r.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),r.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),r.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),r.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),r.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),r.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),r.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),r.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),r.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),r.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),r.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),r.writeAttributeString("office:version","1.1"),r.writeStartElement("office:font-face-decls"),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Arial"),r.writeAttributeString("svg:font-family","Arial"),r.writeEndElement(),r.writeStartElement("style:font-face"),r.writeAttributeString("style:name","Tahoma"),r.writeAttributeString("svg:font-family","Tahoma"),r.writeAttributeString("style:font-family-generic","system"),r.writeAttributeString("style:font-pitch","variable"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("office:styles"),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","graphic"),r.writeStartElement("style:graphic-properties"),r.writeAttributeString("draw:shadow-offset-x","0.3cm"),r.writeAttributeString("draw:shadow-offset-y","0.3cm"),r.writeAttributeString("draw:start-line-spacing-horizontal","0.283cm"),r.writeAttributeString("draw:start-line-spacing-vertical","0.283cm"),r.writeAttributeString("draw:end-line-spacing-horizontal","0.283cm"),r.writeAttributeString("draw:end-line-spacing-vertical","0.283cm"),r.writeAttributeString("style:flow-with-text","false"),r.writeEndElement(),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("style:text-autospace","ideograph-alpha"),r.writeAttributeString("style:line-break","strict"),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeAttributeString("style:font-independent-line-spacing","false"),r.writeStartElement("style:tab-stops"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:use-window-font-color","true"),r.writeAttributeString("fo:font-size","10pt"),r.writeAttributeString("style:letter-kerning","true"),r.writeAttributeString("style:font-size-asian","12pt"),r.writeAttributeString("style:language-asian","zxx"),r.writeAttributeString("style:country-asian","none"),r.writeAttributeString("style:font-size-complex","12pt"),r.writeAttributeString("style:language-complex","zxx"),r.writeAttributeString("style:country-complex","none"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","paragraph"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:hyphenation-ladder-count","no-limit"),r.writeAttributeString("style:text-autospace","ideograph-alpha"),r.writeAttributeString("style:punctuation-wrap","hanging"),r.writeAttributeString("style:line-break","strict"),r.writeAttributeString("style:tab-stop-distance","1.251cm"),r.writeAttributeString("style:writing-mode","page"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:use-window-font-color","true"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("fo:font-size","10pt"),r.writeAttributeString("style:letter-kerning","true"),r.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),r.writeAttributeString("style:font-size-asian","12pt"),r.writeAttributeString("style:language-asian","zxx"),r.writeAttributeString("style:country-asian","none"),r.writeAttributeString("style:font-name-complex","Tahoma"),r.writeAttributeString("style:font-size-complex","12pt"),r.writeAttributeString("style:language-complex","zxx"),r.writeAttributeString("style:country-complex","none"),r.writeAttributeString("fo:hyphenate","false"),r.writeAttributeString("fo:hyphenation-remain-char-count","2"),r.writeAttributeString("fo:hyphenation-push-char-count","2"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","table"),r.writeStartElement("style:table-properties"),r.writeAttributeString("table:border-model","collapsing"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:default-style"),r.writeAttributeString("style:family","table-row"),r.writeStartElement("style:table-row-properties"),r.writeAttributeString("fo:keep-together","auto"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Standard"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:class","text"),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Title"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:next-style-name","Text_20_body"),r.writeAttributeString("style:class","text"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:margin-top","0.423cm"),r.writeAttributeString("fo:margin-bottom","0.212cm"),r.writeAttributeString("fo:keep-with-next","always"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial1"),r.writeAttributeString("fo:font-size","14pt"),r.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),r.writeAttributeString("style:font-size-asian","14pt"),r.writeAttributeString("style:font-name-complex","Tahoma"),r.writeAttributeString("style:font-size-complex","14pt"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Text_20_body"),r.writeAttributeString("style:display-name","Text body"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","text"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:margin-top","0cm"),r.writeAttributeString("fo:margin-bottom","0.212cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Subtitle"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Title"),r.writeAttributeString("style:next-style-name","Text_20_body"),r.writeAttributeString("style:class","chapter"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:text-align","center"),r.writeAttributeString("style:justify-single-word","false"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("fo:font-size","14pt"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("style:font-size-asian","14pt"),r.writeAttributeString("style:font-style-asian","italic"),r.writeAttributeString("style:font-size-complex","14pt"),r.writeAttributeString("style:font-style-complex","italic"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","List"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Text_20_body"),r.writeAttributeString("style:class","list"),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("style:font-name-complex","Tahoma1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Caption"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","extra"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("fo:margin-top","0.212cm"),r.writeAttributeString("fo:margin-bottom","0.212cm"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:line-number","0"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("fo:font-size","10pt"),r.writeAttributeString("fo:font-style","italic"),r.writeAttributeString("style:font-size-asian","12pt"),r.writeAttributeString("style:font-style-asian","italic"),r.writeAttributeString("style:font-name-complex","Tahoma1"),r.writeAttributeString("style:font-size-complex","12pt"),r.writeAttributeString("style:font-style-complex","italic"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Index"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","index"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:line-number","0"),r.writeEndElement(),r.writeStartElement("style:text-properties"),r.writeAttributeString("style:font-name","Arial"),r.writeAttributeString("style:font-name-complex","Tahoma1"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Table_20_Contents"),r.writeAttributeString("style:display-name","Table Contents"),r.writeAttributeString("style:family","paragraph"),r.writeAttributeString("style:parent-style-name","Standard"),r.writeAttributeString("style:class","extra"),r.writeStartElement("style:paragraph-properties"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:line-number","0"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:style"),r.writeAttributeString("style:name","Graphics"),r.writeAttributeString("style:family","graphic"),r.writeStartElement("style:graphic-properties"),r.writeAttributeString("text:anchor-type","paragraph"),r.writeAttributeString("svg:x","0cm"),r.writeAttributeString("svg:y","0cm"),r.writeAttributeString("style:wrap","dynamic"),r.writeAttributeString("style:number-wrapped-paragraphs","no-limit"),r.writeAttributeString("style:wrap-contour","false"),r.writeAttributeString("style:vertical-pos","top"),r.writeAttributeString("style:vertical-rel","paragraph"),r.writeAttributeString("style:horizontal-pos","center"),r.writeAttributeString("style:horizontal-rel","paragraph"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-style"),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","1"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","2"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","3"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","4"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","5"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","6"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","7"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","8"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","9"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("text:outline-level-style"),r.writeAttributeString("text:level","10"),r.writeAttributeString("style:num-format",""),r.writeStartElement("style:list-level-properties"),r.writeAttributeString("text:min-label-distance","0.381cm"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("text:notes-configuration"),r.writeAttributeString("text:note-class","footnote"),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("text:start-value","0"),r.writeAttributeString("text:footnotes-position","page"),r.writeAttributeString("text:start-numbering-at","document"),r.writeEndElement(),r.writeStartElement("text:notes-configuration"),r.writeAttributeString("text:note-class","endnote"),r.writeAttributeString("style:num-format","i"),r.writeAttributeString("text:start-value","0"),r.writeEndElement(),r.writeStartElement("text:linenumbering-configuration"),r.writeAttributeString("text:number-lines","false"),r.writeAttributeString("text:offset","0.499cm"),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("text:number-position","left"),r.writeAttributeString("text:increment","5"),r.writeEndElement(),r.writeEndElement();var i=t.getByIndex(0),n=i.unit.convertToHInches(i.pageHeight*i.segmentPerHeight),o=i.unit.convertToHInches(i.pageWidth*i.segmentPerWidth),a=i.unit.convertToHInches(i.margins.left),s=i.unit.convertToHInches(i.margins.right),l=i.unit.convertToHInches(i.margins.top),c=i.unit.convertToHInches(i.margins.bottom)-4;return c<0&&(c=0),r.writeStartElement("office:automatic-styles"),r.writeStartElement("style:page-layout"),r.writeAttributeString("style:name","pm1"),r.writeStartElement("style:page-layout-properties"),r.writeAttributeString("fo:page-width",this.doubleToString(o)),r.writeAttributeString("fo:page-height",this.doubleToString(n)),r.writeAttributeString("style:num-format","1"),r.writeAttributeString("style:print-orientation",i.orientation==m.Portrait?"portrait":"landscape"),r.writeAttributeString("fo:margin-top",this.doubleToString(l)),r.writeAttributeString("fo:margin-bottom",this.doubleToString(c)),r.writeAttributeString("fo:margin-left",this.doubleToString(a)),r.writeAttributeString("fo:margin-right",this.doubleToString(s)),r.writeAttributeString("style:writing-mode","lr-tb"),r.writeAttributeString("style:footnote-max-height","0cm"),r.writeStartElement("style:footnote-sep"),r.writeAttributeString("style:width","0.018cm"),r.writeAttributeString("style:distance-before-sep","0.101cm"),r.writeAttributeString("style:distance-after-sep","0.101cm"),r.writeAttributeString("style:adjustment","left"),r.writeAttributeString("style:rel-width","25%"),r.writeAttributeString("style:color","#000000"),r.writeEndElement(),r.writeEndElement(),r.writeStartElement("style:header-style"),r.writeEndElement(),r.writeStartElement("style:footer-style"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeStartElement("office:master-styles"),r.writeStartElement("style:master-page"),r.writeAttributeString("style:name","Standard"),r.writeAttributeString("style:page-layout-name","pm1"),r.writeEndElement(),r.writeEndElement(),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),e},b.prototype.writeContent=function(){var r,n,o,m,c=new S,w=new g(h.UTF8,c);w.indentation=this.xmlIndentation<0?0:this.xmlIndentation,w.formatting=this.xmlIndentation<0?p.None:p.Indented,w.writeStartDocument(),w.writeStartElement("office:document-content"),w.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),w.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),w.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),w.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),w.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),w.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),w.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),w.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),w.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),w.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),w.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),w.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),w.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),w.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),w.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),w.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),w.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),w.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),w.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),w.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),w.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),w.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),w.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),w.writeAttributeString("office:version","1.1");for(var u=i.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),f=i.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),v=new l,b=new l,y=[],x=1;x<this.matrix.coordY.countItems;x++){var A=this.matrix.coordY.getByIndex(x)-this.matrix.coordY.getByIndex(x-1);if(!v.containsKey(A)){var T=v.count;v.set(A,T),b.set(T,A)}y[x-1]=0|v.get(A);for(var P=1;P<this.matrix.coordX.countItems;P++){var L=this.matrix.cells[x-1][P-1];if(!u[x][P])if(null!=L){for(var C=0;C<=L.height;C++)for(var F=0;F<=L.width;F++)u[x+C][P+F]=!0;f[x-1][P-1]=this.getCellStyleNumber(x-1,P-1,L.height+1,L.width+1);var B=this.getParagraphStyleNumber(x-1,P-1)}else f[x-1][P-1]=this.getCellStyleNumber(x-1,P-1,1,1)}}w.writeStartElement("office:scripts"),w.writeEndElement();var k=new l;try{for(var R=__values(this.paragraphStyleList),I=R.next();!I.done;I=R.next()){var D=I.value;k.set(D.FontName,D.FontName)}}catch(t){r={error:t}}finally{try{I&&!I.done&&(n=R.return)&&n.call(R)}finally{if(r)throw r.error}}w.writeStartElement("office:font-face-decls");try{for(var N=__values(k.keys),O=N.next();!O.done;O=N.next()){var H=O.value,M=k.get(H);w.writeStartElement("style:font-face"),w.writeAttributeString("style:name",M),w.writeAttributeString("svg:font-family",M),w.writeEndElement()}}catch(t){o={error:t}}finally{try{O&&!O.done&&(m=N.return)&&m.call(N)}finally{if(o)throw o.error}}w.writeEndElement(),w.writeStartElement("office:automatic-styles"),w.writeStartElement("style:style"),w.writeAttributeString("style:name","Table1"),w.writeAttributeString("style:family","table"),w.writeStartElement("style:table-properties");var W=this.matrix.coordX.getByIndex(this.matrix.coordX.countItems-1)-this.matrix.coordX.getByIndex(0);w.writeAttributeString("style:width",this.doubleToString(W)),w.writeAttributeString("table:align","left"),w.writeEndElement(),w.writeEndElement();for(var P=0;P<this.matrix.coordX.countItems-1;P++){w.writeStartElement("style:style"),w.writeAttributeString("style:name",d.format("Table1.{0}",this.getColumnName(P))),w.writeAttributeString("style:family","table-column"),w.writeStartElement("style:table-column-properties");var U=this.matrix.coordX.getByIndex(P+1)-this.matrix.coordX.getByIndex(P);w.writeAttributeString("style:column-width",this.doubleToString(U)),w.writeEndElement(),w.writeEndElement()}for(var x=0;x<v.count;x++){w.writeStartElement("style:style"),w.writeAttributeString("style:name",d.format("Table1.{0}",x+1)),w.writeAttributeString("style:family","table-row"),w.writeStartElement("style:table-row-properties");var A=b.get(x);w.writeAttributeString("style:row-height",this.doubleToString(A)),w.writeEndElement(),w.writeEndElement()}for(var X=0;X<this.cellStyleList.stimulsoft.countItems;X++){var z=this.cellStyleList[X];w.writeStartElement("style:style"),w.writeAttributeString("style:name",d.format("cell{0}",X+1)),w.writeAttributeString("style:family","table-cell"),w.writeStartElement("style:table-cell-properties"),z.VertAlign==StiVertAlignment.Center&&w.writeAttributeString("style:vertical-align","middle"),z.VertAlign==StiVertAlignment.Bottom&&w.writeAttributeString("style:vertical-align","bottom"),z.BackColor.a>0?w.writeAttributeString("fo:background-color",this.getColorString(z.BackColor)):w.writeAttributeString("fo:background-color","transparent"),w.writeAttributeString("fo:padding","0in"),w.writeAttributeString("fo:border-left",z.BorderLeft),w.writeAttributeString("fo:border-right",z.BorderRight),w.writeAttributeString("fo:border-top",z.BorderTop),w.writeAttributeString("fo:border-bottom",z.BorderBottom),w.writeEndElement(),w.writeEndElement()}for(var X=0;X<this.paragraphStyleList.stimulsoft.countItems;X++){var z=this.paragraphStyleList[X];w.writeStartElement("style:style"),w.writeAttributeString("style:name",d.format("par{0}",X+1)),w.writeAttributeString("style:family","paragraph"),w.writeAttributeString("style:parent-style-name","Table_20_Contents"),z.HorAlign!=StiTextHorAlignment.Left&&(w.writeStartElement("style:paragraph-properties"),z.HorAlign==StiTextHorAlignment.Center&&w.writeAttributeString("fo:text-align","center"),z.HorAlign==StiTextHorAlignment.Right&&w.writeAttributeString("fo:text-align","right"),z.HorAlign==StiTextHorAlignment.Width&&w.writeAttributeString("fo:text-align","justify"),w.writeEndElement()),w.writeStartElement("style:text-properties"),w.writeAttributeString("fo:color",this.getColorString(z.FontColor)),w.writeAttributeString("style:font-name",z.FontName);var V=d.format("{0}pt",z.FontSize).stimulsoft.replaceAll(",",".");w.writeAttributeString("fo:font-size",V),w.writeAttributeString("fo:font-size-asian",V),w.writeAttributeString("fo:font-size-complex",V),z.Italic&&(w.writeAttributeString("fo:font-style","italic"),w.writeAttributeString("fo:font-style-asian","italic"),w.writeAttributeString("fo:font-style-complex","italic")),z.Underline&&(w.writeAttributeString("style:text-underline-style","solid"),w.writeAttributeString("style:text-underline-width","auto"),w.writeAttributeString("style:text-underline-color","font-color")),z.Bold&&(w.writeAttributeString("fo:font-weight","bold"),w.writeAttributeString("fo:font-weight-asian","bold"),w.writeAttributeString("fo:font-weight-complex","bold")),0!=z.Angle&&w.writeAttributeString("style:text-rotation-angle",d.format("{0}",z.Angle)),w.writeEndElement(),w.writeEndElement()}w.writeStartElement("style:style"),w.writeAttributeString("style:name","parEnd"),w.writeAttributeString("style:family","paragraph"),w.writeAttributeString("style:parent-style-name","Table_20_Contents"),w.writeStartElement("style:text-properties");var G=d.format("{0}pt",1).stimulsoft.replaceAll(",",".");w.writeAttributeString("fo:font-size",G),w.writeAttributeString("fo:font-size-asian",G),w.writeAttributeString("fo:font-size-complex",G),w.writeEndElement(),w.writeEndElement(),w.writeStartElement("style:style"),w.writeAttributeString("style:name","fr1"),w.writeAttributeString("style:family","graphic"),w.writeAttributeString("style:parent-style-name","Graphics"),w.writeStartElement("style:graphic-properties"),w.writeAttributeString("style:vertical-pos","middle"),w.writeAttributeString("style:vertical-rel","paragraph"),w.writeAttributeString("style:horizontal-pos","center"),w.writeAttributeString("style:horizontal-rel","paragraph"),w.writeAttributeString("fo:background-color","transparent"),w.writeAttributeString("style:background-transparency","100%"),w.writeAttributeString("style:shadow","none"),w.writeAttributeString("style:mirror","none"),w.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),w.writeAttributeString("draw:luminance","0%"),w.writeAttributeString("draw:contrast","0%"),w.writeAttributeString("draw:red","0%"),w.writeAttributeString("draw:green","0%"),w.writeAttributeString("draw:blue","0%"),w.writeAttributeString("draw:gamma","100%"),w.writeAttributeString("draw:color-inversion","false"),w.writeAttributeString("draw:image-opacity","100%"),w.writeAttributeString("draw:color-mode","standard"),w.writeEndElement(),w.writeEndElement(),w.writeEndElement(),w.writeStartElement("office:body"),w.writeStartElement("office:text"),w.writeStartElement("office:forms"),w.writeAttributeString("form:automatic-focus","false"),w.writeAttributeString("form:apply-design-mode","false"),w.writeEndElement(),w.writeStartElement("text:sequence-decls"),w.writeStartElement("text:sequence-decl"),w.writeAttributeString("text:display-outline-level","0"),w.writeAttributeString("text:name","Illustration"),w.writeEndElement(),w.writeStartElement("text:sequence-decl"),w.writeAttributeString("text:display-outline-level","0"),w.writeAttributeString("text:name","Table"),w.writeEndElement(),w.writeStartElement("text:sequence-decl"),w.writeAttributeString("text:display-outline-level","0"),w.writeAttributeString("text:name","Text"),w.writeEndElement(),w.writeStartElement("text:sequence-decl"),w.writeAttributeString("text:display-outline-level","0"),w.writeAttributeString("text:name","Drawing"),w.writeEndElement(),w.writeEndElement(),u=i.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),w.writeStartElement("table:table"),w.writeAttributeString("table:name","Table1"),w.writeAttributeString("table:style-name","Table1");for(var P=0;P<this.matrix.coordX.countItems-1;P++)w.writeStartElement("table:table-column"),w.writeAttributeString("table:style-name",d.format("Table1.{0}",this.getColumnName(P))),w.writeEndElement();for(var Y=Math.max(this.matrix.coordY.countItems/200,1),j=0,x=1;x<this.matrix.coordY.countItems;x++){var _=x/Y|0;_>j&&(j=_,this.invokeExporting2(x,this.matrix.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),w.writeStartElement("table:table-row"),w.writeAttributeString("table:style-name",d.format("Table1.{0}",y[x-1]+1));for(var P=1;P<this.matrix.coordX.countItems;P++){var L=this.matrix.cells[x-1][P-1];if(u[x][P])w.writeStartElement("table:covered-table-cell"),w.writeEndElement();else if(null!=L){for(var C=0;C<=L.height;C++)for(var F=0;F<=L.width;F++)u[x+C][P+F]=!0;var q=f[x-1][P-1],K=this.getParagraphStyleNumber(x-1,P-1);if(w.writeStartElement("table:table-cell"),w.writeAttributeString("table:style-name",d.format("cell{0}",q+1)),L.width>0&&w.writeAttributeString("table:number-columns-spanned",d.format("{0}",L.width+1)),L.height>0&&w.writeAttributeString("table:number-rows-spanned",d.format("{0}",L.height+1)),w.writeAttributeString("office:value-type","string"),L.component.stimulsoft.is(s)&&!L.component.isExportAsImage(e.StiExportFormat.Odt)&&null!=L.text){var Q=L.text;0!=this.paragraphStyleList[K].stimulsoft.as(E).Angle&&(Q=Q.stimulsoft.replaceAll("\n"," "));for(var J=t.Report.Export.StiExportUtils.splitString(Q,!0),Z=0;Z<J.stimulsoft.countItems;Z++){var $=J[Z];w.writeStartElement("text:p"),w.writeAttributeString("text:style-name",d.format("par{0}",K+1)),w.writeString($),w.writeEndElement()}}if(L.component.isExportAsImage(e.StiExportFormat.Odt)){var tt=L.component.stimulsoft.as(a);if(null!=tt){var et=this.imageResolution,rt={ref:et},it=tt.getImage(rt);if(et=rt.ref,null!=it){var nt=this.imageCache.addImageIntRaw(it,it.imageFormat),ot=this.matrix.coordX.getByIndex(P+L.width)-this.matrix.coordX.getByIndex(P-1),at=this.matrix.coordY.getByIndex(x+L.height)-this.matrix.coordY.getByIndex(x-1);w.writeStartElement("text:p"),w.writeAttributeString("text:style-name","Table_20_Contents"),w.writeStartElement("draw:frame"),w.writeAttributeString("draw:style-name","fr1"),w.writeAttributeString("draw:name",d.format("Picture{0}",nt+1)),w.writeAttributeString("text:anchor-type","paragraph"),w.writeAttributeString("svg:width",this.doubleToString(ot)),w.writeAttributeString("svg:height",this.doubleToString(at)),w.writeAttributeString("draw:z-index","0"),w.writeStartElement("draw:image"),w.writeAttributeString("xlink:href",d.format("Pictures/{0:D5}.jpg",nt+1)),w.writeAttributeString("xlink:type","simple"),w.writeAttributeString("xlink:show","embed"),w.writeAttributeString("xlink:actuate","onLoad"),w.writeEndElement(),w.writeEndElement(),w.writeEndElement()}}}w.writeEndElement()}else{var q=f[x-1][P-1];w.writeStartElement("table:table-cell"),w.writeAttributeString("table:style-name",d.format("cell{0}",q+1)),w.writeEndElement()}}w.writeEndElement()}return w.writeEndElement(),w.writeStartElement("text:p"),w.writeAttributeString("text:style-name","parEnd"),w.writeEndElement(),w.writeEndElement(),w.writeEndElement(),w.writeFullEndElement(),w.writeEndDocument(),w.flush(),c},b.prototype.exportOdt=function(i,a,s){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to ODT format"),null==s)throw new Error("The 'settings' argument cannot be equal in null.");var l=s.pageRange;this.usePageHeadersAndFooters=s.usePageHeadersAndFooters,this._removeEmptySpaceAtBottom=s.removeEmptySpaceAtBottom,this.imageResolution=s.imageResolution,this.imageQuality=s.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100;try{this.imageCache=new e.StiImageCache(t["StiOptions"].Export.OpenDocumentWriter.allowImageComparer,!0,o.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.paragraphStyleList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(t["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0);var m=l.getSelectedPages(i.renderedPages);if(t["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages&&(m=r.StiSegmentPagesDivider.divide(m,this),this.currentPassNumber++),this.isStopped)return;var c=new n;if(c.begin(a,!0),this._matrix=new r.StiMatrix(m,!0,this),this.currentPassNumber=2+(t["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0),c.addFile("content.xml",this.writeContent()),c.addFile("mimetype",this.writeMimetype()),c.addFile("meta.xml",this.writeMeta()),c.addFile("META-INF/manifest.xml",this.writeManifest()),c.addFile("settings.xml",this.writeSettings()),c.addFile("styles.xml",this.writeStyles(m)),this.imageCache.imagePackedStore.stimulsoft.countItems>0)for(var p=0;p<this.imageCache.imagePackedStore.stimulsoft.countItems;p++)c.addFile(d.format("Pictures/{0:D5}.jpg",p+1),this.writeImage(p));c.end()}finally{null!=this.matrix&&(this.matrix.clear(),this._matrix=null),this.cellStyleList.stimulsoft.clear(),this.cellStyleList=null,this.paragraphStyleList.stimulsoft.clear(),this.paragraphStyleList=null,this.imageCache.clear(),this.imageCache=null,i.renderedPages.cacheMode&&r.StiMatrix.GCCollect()}},b}(r.StiExportService);r.StiOdtExportService=b}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.Base.Localization.StiLocalization,n=function(){function t(){}return t}(),o=function(){function t(){}return t}(),a=function(t){function n(){var r=null!==t&&t.apply(this,arguments)||this;return r.colorList=null,r.fontList=null,r.styleList=null,r.unicodeMapArray=null,r.codePageToFont=null,r.charsetCount=0,r.fontToCodePages=null,r.baseFontNumber=0,r.usePageHeadersAndFooters=!1,r.imageResolution=.96,r.imageQuality=.75,r.imageFormat=e.StiExportFormat.Rtf,r.useStyles=!1,r.bookmarkList=null,r.usedBookmarks=null,r}return __extends(n,t),Object.defineProperty(n.prototype,"defaultExtension",{get:function(){return"rtf"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Rtf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return r.StiExportPosition.Rtf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exportNameInMenu",{get:function(){return i.get("Export","ExportTypeRtfFile")},enumerable:!1,configurable:!0}),n.prototype.getFilter=function(){return i.get("FileFilters","RtfFiles")},n.prototype.exportTo=function(t,e,r){},Object.defineProperty(n.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.getColorNumberInt=function(t,e){if(t.length>0)for(var r=0;r<t.length;r++)if(t[r].stimulsoft.equals(e))return r;var i;return t.push(e),t.length-1},n.prototype.getColorNumber=function(t,e){return this.getColorNumberInt(t,e).toString()},n.prototype.getFontNumber2=function(t,e){if(t.length>0)for(var r=0;r<t.length;r++){var i;if(t[r].name==e.name)return r*(0==this.charsetCount?1:this.charsetCount)}var n;return t.push(e),(t.length-1)*(0==this.charsetCount?1:this.charsetCount)},n.prototype.getFontNumber3=function(t,e,r){if(t.length>0)for(var i=0;i<t.length;i++){var n;if(t[i].name==e.name)return i*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(r)}var o;return t.push(e),(t.length-1)*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(r)},n.prototype.getCharsetIndex=function(t){var e=0;if(0==this.charsetCount)return this.codePageToFont[e]=1,0;return this.codePageToFont[e]},n}(r.StiExportService);r.StiRtfExportService=a}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var r;!function(r){var i=t.Report.Export.StiTxtBorderType,n=t.Report.Components.IStiTextHorAlignment,o=t.Report.Components.IStiVertAlignment,a=t.Base.Drawing.StiTextRenderer,s=t.Base.Drawing.StiHtmlState,l=t.Report.Components.StiText,m=t.Report.Components.StiCheckBox,c=t.System.StiString,p=t.System.IO.StreamWriter,g=t.System.StiArray,h=t.Report.Components.IStiTextOptions,w=t.System.Char,u=t.System.Text.StringBuilder,d=t.System.IO.MemoryStream,S=t.Base.Drawing.StiTextHorAlignment,f=t.Base.Localization.StiLocalization,v=function(v){function b(){var t=null!==v&&v.apply(this,arguments)||this;return t.borderCodes=[6,9,12,10,5,3,13,11,14,7,15,1,2,4,8],t.firstEscapeCodeIndex=63742,t.ltrMark=" 0E",t.useFullVerticalBorder=!0,t.useFullHorizontalBorder=!0,t}return __extends(b,v),b.prototype.implements=function(){return[r.IStiTxtExportService]},Object.defineProperty(b.prototype,"defaultExtension",{get:function(){return"txt"},enumerable:!1,configurable:!0}),b.prototype.exportTo=function(t,e,r){this.exportTxt(t,e,r)},b.prototype.exportToAsync=function(t,e,r,i){this.exportTo(e,r,i),t()},Object.defineProperty(b.prototype,"exportFormat",{get:function(){return e.StiExportFormat.Text},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"groupCategory",{get:function(){return"Word"},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"position",{get:function(){return r.StiExportPosition.Txt},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"exportNameInMenu",{get:function(){return f.get("Export","ExportTypeTxtFile")},enumerable:!1,configurable:!0}),b.prototype.getFilter=function(){return f.get("FileFilters","TxtFiles")},Object.defineProperty(b.prototype,"multipleFiles",{get:function(){return!1},enumerable:!1,configurable:!0}),b.prototype.getBorderChar=function(t,e){if(this.useFullVerticalBorder)switch(e){case i.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼ ─  ".charCodeAt(t);case i.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬ ═  ".charCodeAt(t);default:return"-|+++++++++ -  ".charCodeAt(t)}else switch(e){case i.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼    ".charCodeAt(t);case i.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬    ".charCodeAt(t);default:return"-|+++++++++    ".charCodeAt(t)}},b.prototype.lineFill=function(t,e,r,i){for(var n=this.borderCodes[e-1],o=0;o<i;o++)-1==this.borderCodes.indexOf(t[r+o])?32==t[r+o]&&(t[r+o]=n):t[r+o]|=n},b.prototype.lineFillChar=function(t,e,r,i){for(var n=0;n<i;n++)t[r+n]=e},b.prototype.checkWordWrap=function(t,e,i,n){var o=e.ref;if(this.useEscapeCodes)for(var a=0;a<o.length;a++){var s=o[a],l=new u(s);if(r.StiBidirectionalConvert.stringContainArabicOrHebrew(s)){var m=s.length;while(w.isWhitespace(s,m-1))m--;l.insert(m,"<#ltrMark>")}var c=0;while(c<l.length){if("<"==l.charAt(c)&&c<l.length+1&&"#"==l.charAt(c+1)){var p=c,d=new u;while("<"==l.charAt(p)&&p<l.length+1&&"#"==l.charAt(p+1)){while(p<l.length&&">"!=l.charAt(p))d.append(l.charAt(p)),p++;if(d.append(">"),++p>l.length-1)break}p>l.length-1?d.append(String.fromCharCode(65535)):(d.append(l.charAt(p)),p++);var S=this.getEscapeNumber(this.escapeCodesList,d.toString());l.remove(c,p-c),l.insert(c,String.fromCharCode(this.firstEscapeCodeIndex-S))}c++}l.length!=o[a].length&&(o[a]=l.toString())}else for(var a=0;a<o.length;a++)if(r.StiBidirectionalConvert.stringContainArabicOrHebrew(o[a])){var s,c=(s=o[a]).length-1;while(w.isWhitespace(s,c))c--;var d=s.charAt(c)+this.ltrMark,S=this.getEscapeNumber(this.escapeCodesList,d);c==s.length-1?o[a]=s.substring(0,c)+String.fromCharCode(this.firstEscapeCodeIndex-S):o[a]=s.substring(0,c)+String.fromCharCode(this.firstEscapeCodeIndex-S)+s.substring(c+1)}var f=i;this.useFullVerticalBorder?this.needVerticalBorders[t.left+t.width]&&f--:!this.useFullTextBoxWidth&&f>1&&f--;var v=!1,E=t.component.stimulsoft.as(h);if(null!=E&&(v=E.textOptions.wordWrap),v){for(var b=o.stimulsoft.clone(),y=0;y<b.length;y++){var x=b[y];if(x.length>f-1&&f>1){var A=g.create(Number,x.length),T=0,P=0;while(" "==x.charAt(P))A[P]=T,P++;for(var L=P;L<x.length;L++)" "==x.charAt(L)&&T++,A[L]=T;var a,C=a=f-1-1;if(A[a]>0)if(A[a]!=A[a+1]){C=a++;while(" "==x.charAt(a))a++}else{while(" "!=x.charAt(a))a--;C=a++;while(" "==x.charAt(C))C--}else a++;b[y]=x.substring(0,C+1),b.stimulsoft.insert(y+1,x.substr(a,x.length-a))}}b.length>o.length&&(o=b)}if(n)for(var a=0;a<o.length;a++)o[a].length>f&&(o[a]=o[a].substring(0,f));e.ref=o},b.prototype.checkGrow=function(t,e,r){while(t.length<=r)t.push([]),e.push(!1)},b.prototype.addCharsToLine=function(t,e,r,i){for(var n=0;n<r;n++)t[e].push(i)},b.prototype.getStyleNumber=function(t,e){if(t.length>0)for(var r=0;r<t.length;r++){var i=t[r];if(i.Bold==e.Bold&&i.Italic==e.Italic&&i.Underline==e.Underline&&i.Codes==e.Codes)return r}var n;return t.push(e),t.length-1},b.prototype.getEscapeNumber=function(t,e){if(t.length>0)for(var r=0;r<t.length;r++)if(t[r]==e)return r+1;var i;return t.push(e),t.length},b.prototype.getEscapeNames=function(t,e){var r=this.styleList[t],i=this.styleList[e],n=new u;return!r.Bold&&i.Bold&&n.append("<#b>"),r.Bold&&!i.Bold&&n.append("<#/b>"),!r.Italic&&i.Italic&&n.append("<#i>"),r.Italic&&!i.Italic&&n.append("<#/i>"),!r.Underline&&i.Underline&&n.append("<#u>"),r.Underline&&!i.Underline&&n.append("<#/u>"),n},b.prototype.exportTxt=function(i,h,w){var f,v,b,y;if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Text format"),this.report=i,null==w)throw new Error("The 'settings' argument cannot be equal in null.");var x=w.pageRange,A=w.encoding,T=w.drawBorder,P=w.borderType,L=w.killSpaceLines,C=w.killSpaceGraphLines,F=w.putFeedPageCode,B=w.cutLongLines,k=w.zoomX,R=w.zoomY;this.useEscapeCodes=w.useEscapeCodes;var I=w.escapeCodesCollectionName;this.useFullTextBoxWidth=t["StiOptions"].Export.Text.useFullTextBoxWidth,this.useFullVerticalBorder=t["StiOptions"].Export.Text.useFullVerticalBorder,this.useFullHorizontalBorder=t["StiOptions"].Export.Text.useFullHorizontalBorder;var D=9.7,N=18;0==L&&(C=!1),0==T&&(C=!1),this.useFullVerticalBorder&&(this.useFullTextBoxWidth=!1);var O=new d,H=null!=A?new p(O,A):new p(O),M=x.getSelectedPages(i.renderedPages),W=0;this.styleList=[];var U=new E;this.getStyleNumber(this.styleList,U),this.escapeCodesList=[],this.currentPassNumber=0,this.maximumPassNumber=3;var X=new r.StiMatrix(M,!1,this);if(this.isStopped)return;this.needVerticalBorders=g.create(Boolean,X.coordX.countItems);for(var z=1;z<X.coordX.countItems;z++){for(var V=!1,G=1;G<X.coordY.countItems;G++)if(null!=X.bordersY[G-1][z]){V=!0;break}this.needVerticalBorders[z-1]=V}this.needHorizontalBorders=g.create(Boolean,X.coordY.countItems);for(var G=1;G<X.coordY.countItems;G++){for(var Y=!1,z=1;z<X.coordX.countItems;z++)if(null!=X.bordersX[G][z-1]){Y=!0;break}this.needHorizontalBorders[G-1]=Y}for(var j=g.create(Number,X.coordX.countItems),z=1;z<X.coordX.countItems;z++){var _=X.coordX.getByIndex(z),q=X.coordX.getByIndex(z-1);j[z-1]=Math.round((_-q)/(D/k)),this.useFullVerticalBorder&&this.needVerticalBorders[z-1]&&j[z-1]++}for(var K=g.create2(Boolean,X.coordY.countItems,X.coordX.countItems),Q=g.create2(Number,X.coordY.countItems,X.coordX.countItems),J=g.create2(Number,X.coordY.countItems,X.coordX.countItems),G=1;G<X.coordY.countItems;G++)for(var z=1;z<X.coordX.countItems;z++)if(!K[G-1][z-1]){var Z=X.cells[G-1][z-1];if(Q[G-1][z-1]=j[z-1],null!=Z){if(Z.width>0)for(var $=0;$<Z.width;$++)Q[G-1][z-1]+=j[z-1+1+$];if(null!=Z.component){if(null!=Z.component){var tt=Z.component.tagValue;if(!c.isNullOrWhiteSpace(tt)){tt=tt.trim();var et=parseInt(tt);!isNaN(et)&&et>0&&(Q[G-1][z-1]=et,this.useFullVerticalBorder&&this.needVerticalBorders[z-1+Z.width]&&Q[G-1][z-1]++)}}var rt=Z.text,it;if(null!=(it=Z.component.stimulsoft.as(m))&&null!=it.checkedValue){var nt=!1,ot=!1;it.checkedValue.stimulsoft.is(Boolean)&&(it.checkedValue?nt=!0:ot=!0),it.checkedValue.stimulsoft.is(String)&&("True"==it.checkedValue?nt=!0:ot=!0),nt&&(rt=t["StiOptions"].Export.Text.checkBoxTextForTrue),ot&&(rt=t["StiOptions"].Export.Text.checkBoxTextForFalse)}if(!Z.component.isExportAsImage(e.StiExportFormat.Text)&&!c.isNullOrEmpty(rt)){if(Z.component.stimulsoft.is(l)&&Z.component.stimulsoft.as(l).checkAllowHtmlTags()){var at=new s(""),st=a.parseHtmlToStates(rt,at),lt=new u;try{for(var mt=(f=void 0,__values(st)),ct=mt.next();!ct.done;ct=mt.next()){var pt=ct.value;lt.append(a.prepareStateText(pt.text))}}catch(t){f={error:t}}finally{try{ct&&!ct.done&&(v=mt.return)&&v.call(mt)}finally{if(f)throw f.error}}rt=lt.toString()}var gt,ht={ref:gt=r.StiExportUtils.splitString(rt.stimulsoft.replaceAll("\r",""),!1)};this.checkWordWrap(Z,ht,Q[G-1][z-1],B);var wt=(gt=ht.ref).length;J[G-1][z-1]=wt}}for(var ut=0;ut<=Z.height;ut++){for(var dt=0;dt<=Z.width;dt++)K[G-1+ut][z-1+dt]=!0;Q[G-1+ut][z-1]=Q[G-1][z-1]}}}var St=g.create(Number,X.coordY.countItems);W=1;for(var G=1;G<X.coordY.countItems;G++){var _=X.coordY.getByIndex(G),q=X.coordY.getByIndex(G-1),ft=Math.round((_-q)/(N/R));ft<1&&(ft=1);for(var z=1;z<X.coordX.countItems;z++){var Z;null!=(Z=X.cells[G-1][z-1])&&Z.height<1&&J[G-1][z-1]>ft&&(ft=J[G-1][z-1])}this.useFullHorizontalBorder&&this.needHorizontalBorders[G-1]&&ft++,St[G-1]=ft,W+=ft}W++;for(var vt=[],Et=[],bt=[],yt=0;yt<W;yt++)vt.push([]),Et.push([]),bt.push(!1);K=g.create2(Boolean,X.coordY.countItems,X.coordX.countItems);var xt=T?1:0,At=new l;At.vertAlignment=StiVertAlignment.Center,At.horAlignment=S.Center,this.currentPassNumber=2;for(var G=1;G<X.coordY.countItems;G++){this.invokeExporting2(G,X.coordY.countItems,this.currentPassNumber,this.maximumPassNumber);for(var yt=0;yt<X.horizontalPageBreaks.length;yt++)X.horizontalPageBreaks[yt]==G-1&&(bt[xt-(T&&G>1&&this.needHorizontalBorders[G-1-1]?1:0)]=!0);for(var Tt=T?1:0,z=1;z<X.coordX.countItems;z++){var Z=X.cells[G-1][z-1],Pt=Q[G-1][z-1],Lt=St[G-1];if(!K[G-1][z-1]){var Ct=0,Ft=0,Bt=0;if(null!=Z){Ct=Z.width,Ft=Z.height;for(var dt=0;dt<=Z.width;dt++)for(var ut=0;ut<=Z.height;ut++)K[G-1+ut][z-1+dt]=!0;if(Z.height>0)for(var $=0;$<Z.height;$++)Lt+=St[G-1+1+$];if(this.useFullHorizontalBorder&&this.needHorizontalBorders[G-1+Ft]&&Lt--,null!=Z.component){var kt=Z.component.stimulsoft.as(l);if(null!=kt){var Rt=new E;Rt.Bold=kt.font.bold,Rt.Italic=kt.font.italic,Rt.Underline=kt.font.underline,Rt.Codes=null,Bt=this.getStyleNumber(this.styleList,Rt)}var rt=Z.text,it;if(null!=(it=Z.component.stimulsoft.as(m))&&null!=it.checkedValue){var nt=!1,ot=!1;it.checkedValue.stimulsoft.is(Boolean)&&(it.checkedValue?nt=!0:ot=!0),it.checkedValue.stimulsoft.is(String)&&("True"==it.checkedValue?nt=!0:ot=!0),nt&&(rt=t["StiOptions"].Export.Text.checkBoxTextForTrue),ot&&(rt=t["StiOptions"].Export.Text.checkBoxTextForFalse)}if(!Z.component.isExportAsImage(e.StiExportFormat.Text)&&!c.isNullOrEmpty(rt)){if(Z.component.stimulsoft.is(l)&&Z.component.stimulsoft.as(l).checkAllowHtmlTags()){var at=new s(""),st=a.parseHtmlToStates(rt,at),lt=new u;try{for(var It=(b=void 0,__values(st)),Dt=It.next();!Dt.done;Dt=It.next()){var pt=Dt.value;lt.append(a.prepareStateText(pt.text))}}catch(t){b={error:t}}finally{try{Dt&&!Dt.done&&(y=It.return)&&y.call(It)}finally{if(b)throw b.error}}rt=lt.toString()}var gt,ht={ref:gt=r.StiExportUtils.splitString(rt.stimulsoft.replaceAll("\r",""),!1)};this.checkWordWrap(Z,ht,Q[G-1][z-1],B),gt=ht.ref;var Nt=0,Ot=Z.component.stimulsoft.as(o);null!=it&&(Ot=At),null!=Ot&&gt.length<Lt&&((Ot.vertAlignment&StiVertAlignment.Center)>0&&(Nt=Math.trunc((Lt-gt.length)/2)),(Ot.vertAlignment&StiVertAlignment.Bottom)>0&&(Nt=Lt-gt.length));for(var yt=0;yt<gt.length;yt++){var Ht=0,Mt=Pt;this.useFullVerticalBorder?this.needVerticalBorders[Z.left+Z.width]&&Mt--:!this.useFullTextBoxWidth&&Mt>1&&Mt--;var Wt=Z.component.stimulsoft.as(n);null!=it&&(Wt=At),null!=Wt&&(Wt.horAlignment==S.Center&&(Ht=Math.trunc((Mt-gt[yt].length)/2)),Wt.horAlignment==S.Right&&(Ht=Mt-gt[yt].length));var Ut=Tt+Ht,Xt=xt+Nt+yt;Ut<0&&(Ut=0);var zt=Ut+gt[yt].length;this.checkGrow(vt,bt,Xt),vt[Xt].length<zt&&this.addCharsToLine(vt,Xt,zt-vt[Xt].length,32);for(var Vt=0;Vt<gt[yt].length;Vt++){var Gt;(Gt=gt[yt].charCodeAt(Vt))<32&&(Gt+=65280),vt[Xt][Ut+Vt]=Gt}}}}}else this.useFullHorizontalBorder&&this.needHorizontalBorders[G-1]&&Lt--;this.useFullHorizontalBorder||Lt--;for(var Yt=0;Yt<Lt;Yt++){Et[xt+Yt].length<Tt+Pt&&this.addCharsToLine(Et,xt+Yt,Tt+Pt-Et[xt+Yt].length,0);var Mt=Pt;this.useFullVerticalBorder?null!=Z&&this.needVerticalBorders[Z.left+Z.width]&&Mt--:!this.useFullTextBoxWidth&&Mt>1&&Mt--,this.lineFillChar(Et[xt+Yt],Bt,Tt,Mt)}if(T){for(var zt=Tt+Pt-1,$=-1;$<=Lt;$++)this.checkGrow(vt,bt,xt+$),vt[xt+$].length<zt+1&&this.addCharsToLine(vt,xt+$,zt+1-vt[xt+$].length,32);for(var jt=!0,_t=!0,$=0;$<Ft+1;$++)null==X.bordersY[G-1+$][z-1]&&(jt=!1),null==X.bordersY[G-1+$][z-1+Ct+1]&&(_t=!1);for(var qt=!0,Kt=!0,$=0;$<Ct+1;$++)null==X.bordersX[G-1][z-1+$]&&(qt=!1),null==X.bordersX[G-1+Ft+1][z-1+$]&&(Kt=!1);if(qt&&(this.lineFill(vt[xt-1],14,Tt-1,1),this.lineFill(vt[xt-1],1,Tt,Pt-1),this.lineFill(vt[xt-1],13,Tt+Pt-1,1)),jt){this.lineFill(vt[xt-1],15,Tt-1,1);for(var $=0;$<Lt;$++)this.lineFill(vt[xt+$],2,Tt-1,1);this.lineFill(vt[xt+Lt],12,Tt-1,1)}if(_t){this.lineFill(vt[xt-1],15,Tt+Pt-1,1);for(var $=0;$<Lt;$++)this.lineFill(vt[xt+$],2,Tt+Pt-1,1);this.lineFill(vt[xt+Lt],12,Tt+Pt-1,1)}Kt&&(this.lineFill(vt[xt+Lt],14,Tt-1,1),this.lineFill(vt[xt+Lt],1,Tt,Pt-1),this.lineFill(vt[xt+Lt],13,Tt+Pt-1,1))}}Tt+=Pt}xt+=St[G-1]}if(T){for(var Qt=!0,yt=0;yt<vt.length;yt++)if(vt[yt].length>0&&32!=vt[yt][0]){Qt=!1;break}if(Qt)for(var yt=0;yt<vt.length;yt++)vt[yt].length>0&&vt[yt].stimulsoft.removeRange(0,1),Et[yt].length>0&&Et[yt].stimulsoft.removeRange(0,1)}if(!(t.Base.izjrG.dVOOk.TvUDM()||t.Base.izjrG.dVOOk.AWlWm()||(t.Base.izjrG.dVOOk.ekkVf()||t.Base.izjrG.dVOOk.yoidW()||t.Base.izjrG.dVOOk.ohwaJ())&&t.System.NodeJs.isStandaloneVersion)){var Jt=(X.coordX.getByIndex(X.coordX.countItems-1)-X.coordX.getByIndex(0))/(D/k),Zt=Math.max(1,Math.trunc(Jt/2-10));H.writeLine(c.fill(" ",Zt)+"---=== TRIAL ===---\r\n")}var $t=vt.length-1;while($t>0&&0==vt[$t].length)$t--;for(var te=0,yt=0;yt<vt.length;yt++){if(vt[yt].length>0){for(var $=0;$<this.borderCodes.length;$++)for(var ee=this.borderCodes[$],re=this.getBorderChar($,P),Vt=0;Vt<vt[yt].length;Vt++)vt[yt][Vt]==ee&&(vt[yt][Vt]=re);if(t["StiOptions"].Export.Text.trimTrailingSpaces,C){for(var re=this.getBorderChar(1,P),ie=!0,$=0;$<vt[yt].length;$++){var ne=vt[yt][$];ne!=re&&32!=ne&&(ie=!1)}ie&&(vt[yt]=[])}F&&bt[yt]&&(this.useEscapeCodes&&H.write(this.getEscapeNames(te,0).toString()),te=0,H.write("\f")),this.useEscapeCodes}var oe=vt[yt];if(!L&&yt<=$t||oe.length>0){var ae=oe.length;if(t["StiOptions"].Export.Text.trimTrailingSpaces)while(ae>0&&32==oe[ae-1])ae--;for(var se="",le=0;le<ae;le++){var Gt;(Gt=oe[le])>=65280&&(Gt-=65280),se+=String.fromCharCode(Gt)}t["StiOptions"].Export.Text.removeLastNewLineMarker&&yt==$t?H.write(se):H.writeLine(se)}}var me=new u;this.useEscapeCodes&&me.append(this.getEscapeNames(te,0)),F&&me.append("\f"),me.length>0&&H.write(me.toString()),H.flush(),this.useEscapeCodes,O.writeTo(h),O.close(),this.needVerticalBorders=null,this.needHorizontalBorders=null,this.styleList=null,this.escapeCodesList=null},b}(r.StiExportService);r.StiTxtExportService=v;var E=function(){function t(){}return t}()}(r=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={}));;
var Stimulsoft;
(function (Stimulsoft) {
    var Reflection;
    (function (Reflection) {
        var StiTypesHelper = (function () {
            function StiTypesHelper() {
            }
            StiTypesHelper.run = function (type, namespace) {
                if (type === undefined) {
                    StiTypesHelper.run(Stimulsoft, "Stimulsoft");
                    return;
                }
                namespace = namespace.stimulsoft.replaceAll("Stimulsoft.System", "System");
                for (var name_1 in type) {
                    if (typeof type[name_1] == "function") {
                        type[name_1].ssTypeName = name_1;
                        type[name_1].ssNamespace = namespace;
                    }
                    else if (typeof type[name_1] == "object") {
                        StiTypesHelper.run(type[name_1], namespace + "." + name_1);
                    }
                }
            };
            return StiTypesHelper;
        }());
        Reflection.StiTypesHelper = StiTypesHelper;
    })(Reflection = Stimulsoft.Reflection || (Stimulsoft.Reflection = {}));
})(Stimulsoft || (Stimulsoft = {}));
Stimulsoft.Reflection.StiTypesHelper.run();
if (typeof module === "object") {
    module.exports = Stimulsoft;
}
;